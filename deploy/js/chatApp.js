var mainConfig={DOM:{MAIN_STYLE_CHAT_BLOCK_CLASS:"root_chat_for_touchsoft",AUTHORIZATION_MENU_CLASS:"root_chat_for_touchsoft_input-name-block",USER_NAME_INPUT_CLASS:"root_chat_for_touchsoft_input-name",SEND_USER_NAME_BUTTON:"root_chat_for_touchsoft_input-name-button",SEND_MESSAGE_MIN_SIZE_BUTTON:"root_chat_for_touchsoft_minimize-style__send-button",SEND_MESSAGE_FULL_SIZE_BUTTON:"root_chat_for_touchsoft__bottom_send-button",CSS_MAX_SIZE_INPUT_MESSAGE_BLOCK_CLASS:"root_chat_for_touchsoft__textarea",CSS_MIN_SIZE_INPUT_MESSAGE_BLOCK_CLASS:"root_chat_for_touchsoft_minimize-style__message-input",TITLE_BLOCK_CLASS:"root_chat_for_touchsoft-title",CHANGE_STYLE_BUTTON_MAX_SIZE:"root_chat_for_touchsoft__top_minimize-button",MINIMIZE_STYLE_CHAT_BLOCK_CLASS:"root_chat_for_touchsoft_minimize-style",SET_MIN_STYLE_BUTTON:"root_chat_for_touchsoft_minimize-style__max-button",SET_MAX_STYLE_BUTTON:"root_chat_for_touchsoft__top_minimize-button",CHAT_QUESTION_CSS:"root_chat_for_touchsoft_information-enter-name"},DATA_BASE_URL:"https://onlineconsultantwebapp.firebaseio.com",CSS_CURRENT_INPUT_CLASS:"root_chat_for_touchsoft__textarea",currentUserSettings:{userId:null,userName:null,isMinimize:!1,readLastMessage:!1,sendNewMessage:!1,lastOnline:(new Date).getTime()},chatSettings:{allowDrag:!1,position:"right",chatTitle:"TouchSoft Chat",allowMinimize:!0,outerCssClass:"touchsoft-chat_main-block",typeOfRequest:"fetch",requireName:!0},INVISIBLE_CLASS:"invisible",CHAT_POSITION_RIGHT:"root_chat_for_touchsoft_right-position",CHAT_POSITION_LEFT:"root_chat_for_touchsoft_left-position",LOCAL_STORAGE_NAME:"userID_touchsoft_chat",DEFAULT_USER_NAME:"guest",DEFAULT_CSS_CLASS_FOR_CHAT:"touchsoft-chat_main-block",DEFAULT_CHAT_TITLE:"TouchSoft Chat",HTML_FILE_PATH:"https://rawgit.com/UnacceptableCondition/online_consultant_web_app/master/app/html/chatApplication/chat.html",CSS_FILE_PATH:"https://rawgit.com/UnacceptableCondition/online_consultant_web_app/master/app/css/chat.css",messages:{CSS_USER_NOT_READ_MESSAGES:"root-touchsoft-dashboard_message-not-read",CSS_CHAT_MESSAGES_CONTAINER:"root_chat_for_touchsoft__top_messages",CSS_MESSAGE_CONTAINER:"root-touchsoft-dashboard_chat-message-elements",CSS_CHAT_MESSAGE_SENDER_NAME:"root-touchsoft-dashboard_chat-message-sender",CSS_CHAT_MESSAGE_DATE:"root-touchsoft-dashboard_chat-message-date",CSS_CHAT_MESSAGE:"root-touchsoft-dashboard_chat-message"},DISPLAY_MESSAGE_DATE:!0,DISPLAY_SENDER_NAME:!0,DISPLAY_MESSAGE:!0,UPDATE_USER_DATA_TIME:5e3,COMMAND_PATH_PREFIX:"https://onlineconsultantwebapp.firebaseio.com/usersSettings/"};function parseSrcForParameters(e){var s={};return e.substr(e.indexOf("?")+1).split("&").forEach(function(e){var t=e.split("=");t[1]=t[1].replace(/'/g,""),s[t[0]]=t[1]}),s}function setOuterChatSettingToConfig(t,s){Object.keys(t).map(function(e){return s.chatSettings[e]=t[e],!0})}setOuterChatSettingToConfig(parseSrcForParameters(document.currentScript.getAttribute("src")),mainConfig);var dataBaseUrl=mainConfig.DATA_BASE_URL,getElement=function(e,t,s){var n=s?"#":".";return t?document.querySelectorAll(n+e):document.querySelector(n+e)},dataConnectorConfig={typeOfRequest:mainConfig.chatSettings.typeOfRequest},dataConnector=function(e){var t;function s(){}return s.prototype.setupDataBaseAPI=function(e){return"fetch"===e?{request:t.requestFetch,getNewConnectorAPI:t.setupDataBaseAPI}:"XHR"===e?{request:t.requestXMR,getNewConnectorAPI:t.setupDataBaseAPI}:{request:t.requestXMR,createLongPollConnection:t.longPoll,getNewConnectorAPI:t.setupDataBaseAPI}},s.prototype.requestFetch=function(e,t,s,n){return fetch(e,{headers:{Accept:n,"Content-Type":n},method:s,body:t}).then(function(e){return"application/json"===n?e.json():e.text()})},s.prototype.requestXMR=function(n,a,r,o){return new Promise(function(e,t){var s=new XMLHttpRequest;s.open(r,n,!0),s.setRequestHeader("Content-Type",o),s.onload=function(){e("application/json"===o?JSON.parse(s.response):s.response)},s.onerror=function(){t(s.statusText)},a?s.send(a):s.send()})},s.prototype.longPoll=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!0),t.setRequestHeader("Accept","text/event-stream"),t},(t=new s).setupDataBaseAPI(e.typeOfRequest)}(dataConnectorConfig),dataSource=function(o,t){var s,a="userList",n="usersMessages",r="usersSettings",i={isMinimize:!1,readLastMessage:!0};function u(){}function c(e,t){var s=this.createRequestPath(dataBaseUrl,t,null,e);return o.createLongPollConnection(s)}function p(e,t){var s=this.createRequestPath(dataBaseUrl,t,null,e);return o.request.bind(null,s,null,"GET","application/json")}return u.prototype.createRequestPath=function(e,t,s,n){var a=e;return null!==n&&(a+="/"+n),null!==t&&(a+="/"+t),null!==s&&(a+="/"+s),a+=".json"},u.prototype.getHTML=function(e){return o.request(e,null,"GET","application/x-www-form-urlencoded; charset=UTF-8")},u.prototype.setData=function(e,t,s,n,a){var r;return r="PUT"===t?this.createRequestPath(dataBaseUrl,n,s,e):this.createRequestPath(dataBaseUrl,n,null,e),o.request(r,JSON.stringify(a),t,"application/json")},u.prototype.addNewUserToDataSource=function(t,e){var s=new Date,n=this;i.userName=e,Object.keys(i).map(function(e){return n.setData(r,"PUT",e,t,i[e]),!0}),this.setData(a,"PUT",null,t,{lastOnline:s.getTime(),sendNewMessage:!1})},u.prototype.getDataSourceAPI=function(e){return e&&(t.chatSettings.typeOfRequest=e),u.prototype.getData="longPoll"===t.chatSettings.typeOfRequest?c:p,{usersAPI:{getUserList:s.getData.bind(s,a),getUserSettings:s.getData.bind(s,r),getUserMessages:s.getData.bind(s,n),getSettingField:s.getData.bind(s,r),sendMessage:s.setData.bind(s,n,"POST"),setSettingField:s.setData.bind(s,r,"PUT"),addNewUserToDataSource:s.addNewUserToDataSource.bind(s),updateLastOnline:s.setData.bind(s,a,"PUT","lastOnline"),updateSendNewMessageFlag:s.setData.bind(s,a,"PUT","sendNewMessage"),updateMessageIsReadField:s.setData.bind(s,n,"PUT")},commonAPI:{getHTML:s.getHTML.bind(s),getDataSourceAPI:s.getDataSourceAPI.bind(s)}}},(s=new u).getDataSourceAPI()}(dataConnector,mainConfig),eventEmitter=function(){function e(){this.events={}}return e.prototype.addSubscribe=function(e,t){var s=this;return this.events[e]||(this.events[e]=[]),this.events[e].push(t),function(){s.events[e]=s.events[e].filter(function(e){return e!==t})}},e.prototype.emit=function(e,t){var s=this.events[e];s&&s.forEach(function(e){e.call(null,t)})},new e}(),longPollResponseParser=function(){var s={message:/message/,userList:/lastOnline.{1,}sendNewMessage/,lastOnline:/"path":"\/\w{1,}\/lastOnline/,sendNewMessage:/"path":"\/\w{1,}\/sendNewMessage/,setting:/readLastMessage/,read:/read/,getIp:/getIp/,askQuestion:/askQuestion/},a=/event: put/,t=/data: null/,r=/","data":/,o=/"path":"\/-/,n=/"data":{"lastOnline":\d+,"sendNewMessage":/,i=/data: {"path":"\/","data":{"getIp":/,u=/data: {"path":"\/","data":{"askQuestion":/,c=/data: {"path":"\/askQuestion","data":/,p=!0;function e(){}return e.prototype.getTypeOfChanges=function(t){return Object.keys(s).filter(function(e){return!!s[e].test(t)&&e})[0]},e.prototype.prepareDataBeforeJsonParse=function(e){return e[e.length-1].split(r)[1].trim().slice(0,-1)},e.prototype.parseUsersMessages=function(e,t){var s,n={},a={};return"read"===t?(n.id=e[e.length-1].split('data: {"path":"/').pop().split('/read","').shift(),n.value=e[e.length-1].split('/read","data":').pop().trim().slice(0,-1),n):o.test(e[e.length-1])?(s=e[e.length-1].split('data: {"path":"/').pop().split(r).shift(),n=JSON.parse(this.prepareDataBeforeJsonParse(e)),a[s]=n,a):this.getFirstData(e)},e.prototype.hasNewData=function(e){return!t.test(e[e.length-1])&&1<e.length},e.prototype.parseUserList=function(e,t){var s={};return p?(p=!1,this.getFirstData(e)):n.test(e[e.length-1])?(s[this.getUserId(e[e.length-1],null)]=this.getFirstData(e),s):(s=JSON.parse(e[e.length-1].split(r)[1].trim().slice(0,-1)),[this.getUserId(e[e.length-1],t),s])},e.prototype.getFirstData=function(e){try{return JSON.parse(this.prepareDataBeforeJsonParse(e))}catch(e){return null}},e.prototype.getUserId=function(e,t){return t?e.split(t).shift().split('data: {"path":"/').pop().slice(0,-1):e.split('data: {"path":"/').pop().split(",")[0].trim().slice(0,-1)},e.prototype.parseCommandAnswer=function(e){var t,s=/getIp/.test(e[e.length-1]),n=/askQuestion/.test(e[e.length-1]);return s&&n?(t=e[e.length-1].split(/data: {"path":"\/","data":/).pop().split("},"),[JSON.parse(t[0]+"}}"),JSON.parse("{"+t[1].trim().slice(0,-1))]):s?this.parseUserIpData(e):n?this.parseQuestionsData(e):void 0},e.prototype.parseUserIpData=function(e){return i.test(e)?JSON.parse(e[e.length-1].split(i).pop().trim().slice(0,-2)):JSON.parse(e[e.length-1].split(a).pop().split('data: {"path":"/getIp","data":').pop().trim().slice(0,-1))},e.prototype.parseQuestionsData=function(e){return u.test(e[e.length-1])?JSON.parse(e[e.length-1].split(u).pop().trim().slice(0,-2)):c.test(e[e.length-1])?JSON.parse(e[e.length-1].split(c).pop().trim().slice(0,-1)):JSON.parse('{"askQuestion":{"'+e[e.length-1].split('data: {"path":"/askQuestion/').pop().replace('","data"','"')+"}")},e.prototype.parse=function(e){var t=e.split(a),s=this.getTypeOfChanges(t[t.length-1]),n={type:s};return!!this.hasNewData(t)&&("message"===s||"read"===s?(n.object=this.parseUsersMessages(t,s),n):"sendNewMessage"===s||"lastOnline"===s||"userList"===s?(n.object=this.parseUserList(t,s),n):("getIp"===s||"askQuestion"===s)&&(n.object=this.parseCommandAnswer(t,s),n))},new e}(),instructionPerformer=function(u,a,t){var i={getIp:function(){return a.request("https://geoip-db.com/json/",null,"GET","multipart/form-data").then(function(e){return p(e,"commandsResponse/getIp")})},askQuestion:function(e,t,s,n,a){var r,o;r=s?s.bind(n,t,e):function(e,t){var s=getElement(u.DOM.USER_NAME_INPUT_CLASS).value;p(JSON.stringify(s),"commandsResponse/"+e+"/"+t[1])}.bind(n,t,e);o=function(){r(),g(),a&&l(t)},i=e,getElement(u.DOM.CHAT_QUESTION_CSS).innerHTML=i[1],c&&getElement(u.DOM.SEND_USER_NAME_BUTTON).removeEventListener("click",c);var i;c=function(e){e()}.bind(null,o),getElement(u.DOM.SEND_USER_NAME_BUTTON).addEventListener("click",c),g()}},c=null,s=[];function p(e,t){var s=u.currentUserSettings.userId;return a.request("https://onlineconsultantwebapp.firebaseio.com/usersSettings/"+s+"/"+t+".json",e,"PUT","application/json")}function g(){getElement(u.DOM.AUTHORIZATION_MENU_CLASS).classList.toggle(u.INVISIBLE_CLASS)}function l(e){var t;(t=e,a.request(u.COMMAND_PATH_PREFIX+u.currentUserSettings.userId+"/commands/"+t+"/isExecute.json",!0,"PUT","application/json")).then(function(){r()})}function r(){var t,s,n;setTimeout(function(){a.request(u.COMMAND_PATH_PREFIX+u.currentUserSettings.userId+"/commands.json",null,"GET","application/json").then(function(e){0<(t=function(t){if(!t)return[];return Object.keys(t).filter(function(e){return!t[e].isExecute})}(e)).length?(n=t.pop(),s=function(e){var t,s=[];for(t=0;t<e.parametersNumber;t++)s.push(e["parameter"+t]);return s}(e[n]),instructionPerformer.execute(n,s,e[n].typeOfCommand,null,null,!0)):r()})},u.UPDATE_USER_DATA_TIME)}return{execute:function(e,t,s,n,a,r){var o=i[e].call(null,t,e,n,a,r);"async"===s&&o.then(function(){l(e)})},setup:r,setupLongPollConnection:function(){var e=a.createLongPollConnection(u.COMMAND_PATH_PREFIX+u.currentUserSettings.userId+"/commands.json");e.onreadystatechange=function(){var e;3===this.readyState&&200===this.status&&(e=t.parse(this.responseText).object)&&(e instanceof Array?e.forEach(function(t){Object.keys(t).map(function(e){t[e].isExecute||s.push(t[e])})}):s.push(e),console.log(s))},e.send()}}}(mainConfig,dataConnector,longPollResponseParser),messageListManager=function(u){function e(){}return e.prototype.setup=function(){this.messageList=[],this.cDOM={messagesBlock:getElement(u.messages.CSS_CHAT_MESSAGES_CONTAINER)}},e.prototype.createMessageElement=function(e,t,s,n){var a=this.createMessageContainerDiv(n,s),r=this.createDivForMessageBlock(t,u.DISPLAY_MESSAGE_DATE,[u.messages.CSS_CHAT_MESSAGE_DATE]),o=this.createDivForMessageBlock(s,u.DISPLAY_SENDER_NAME,[u.messages.CSS_CHAT_MESSAGE_SENDER_NAME]),i=this.createDivForMessageBlock(e,u.DISPLAY_MESSAGE,[u.messages.CSS_CHAT_MESSAGE]);return a.appendChild(r),a.appendChild(o),a.appendChild(i),a},e.prototype.getMessageObjectsForMarkAsRead=function(){var e,t=[],s=u.ADMIN_NAME||u.currentUserSettings.userName,n=u.currentUserSettings.userId;for(e=this.messageList.length-1;0<=e;e--)if(this.messageList[e].sender!==s){if(this.messageList[e].read)break;t.push({userId:n,fieldName:this.messageList[e].id+"/read",fieldValue:!0}),this.messageList[e].read=!0}return t},e.prototype.createMessageContainerDiv=function(e,t){var s=document.createElement("div");return s.classList.add(u.messages.CSS_MESSAGE_CONTAINER),e||u.currentUserSettings.userName===t||s.classList.add(u.messages.CSS_USER_NOT_READ_MESSAGES),s},e.prototype.createDivForMessageBlock=function(e,t,s){var n=document.createElement("div");return s.forEach(function(e){n.classList.add(e)}),n.innerHTML=e,n},e.prototype.createMessageList=function(e){var t=[];return e&&e.forEach(function(e){t.push(e)}),t},e.prototype.updateMessageList=function(e){0<this.getMessageObjectsForMarkAsRead().length&&(u.currentUserSettings.readLastMessage=!1),this.messageList=e,this.displayMessages()},e.prototype.addMessageToMessageList=function(e){this.messageList.push(e)},e.prototype.displayMessages=function(){var t,s=this;this.clearChat(),this.messageList.forEach(function(e){t=s.createMessageElement(e.message,e.date,e.sender,e.read),s.cDOM.messagesBlock.appendChild(t)})},e.prototype.clearChat=function(){for(;this.cDOM.messagesBlock.firstChild;)this.cDOM.messagesBlock.removeChild(this.cDOM.messagesBlock.firstChild)},new e}(mainConfig),userDataManager=function(i,s,n){function e(){var t=this;"longPoll"===i.chatSettings.typeOfRequest?(e.prototype.getUserData=function(t){var s=this;return new Promise(function(e){s.getUserCorrespondence(t),e()})}.bind(this),e.prototype.getUserCorrespondence=function(e){var t;i.currentMessageConnection&&i.currentMessageConnection.abort(),i.currentMessageConnection=dataSource.usersAPI.getUserMessages(e),i.currentMessageConnection.onreadystatechange=function(){3===this.readyState&&200===this.status&&(t=n.parse(this.responseText))&&s.emit(t.type,t.object)},i.currentMessageConnection.send()}.bind(this),e.prototype.updateMessageList=function(t){t&&Object.keys(t).map(function(e){return t[e].id=e,messageListManager.addMessageToMessageList(t[e]),!0}),messageListManager.displayMessages()}.bind(this),s.addSubscribe("message",function(e){t.updateMessageList(e)}),s.addSubscribe("read",function(t){t&&messageListManager.messageList.forEach(function(e){e.id===t.id&&(e.read=t.value,messageListManager.displayMessages())})})):(e.prototype.getUserData=function(t){var s=this;return new Promise(function(e){return s.getUserCorrespondence(t).then(function(){e()})})}.bind(this),e.prototype.getUserCorrespondence=function(e){var t=this;return dataSource.usersAPI.getUserMessages(e)().then(function(e){t.updateMessageList(e)})}.bind(this),e.prototype.updateMessageList=function(t){var e,s=[];t&&Object.keys(t).map(function(e){return t[e].id=e,s.push(t[e]),!0}),messageListManager.displayMessages(),e=messageListManager.createMessageList(s),messageListManager.updateMessageList(e)}.bind(this))}return e.prototype.setup=function(){messageListManager.setup()},e.prototype.clearMessageList=function(){messageListManager.messageList=[]},e.prototype.createNewUserProfileToDataBase=function(e,t){dataSource.usersAPI.addNewUserToDataSource(e,t)},e.prototype.saveSettingField=function(e){dataSource.usersAPI.setSettingField(e,i.currentUserSettings.userId,i.currentUserSettings[e])},e.prototype.updateUserOnline=function(e){var t=new Date;dataSource.usersAPI.updateLastOnline(e,t.getTime())},e.prototype.sendMessage=function(){var e,t,s,n=this.getMessageFromInputElement(),a=(e=new Date,t=1===e.getMinutes().toString().length?"0"+e.getMinutes():e.getMinutes(),e.getHours().toString().concat(":",t)),r=i.currentUserSettings.userName||i.ADMIN_NAME,o={sender:r,message:n,read:!1,date:a,id:s};"longPoll"!==i.chatSettings.typeOfRequest&&(messageListManager.addMessageToMessageList(o),messageListManager.displayMessages()),this.saveMessageToDataSource(o)},e.prototype.getMessageFromInputElement=function(){var e=getElement(i.CSS_CURRENT_INPUT_CLASS),t=e.value;return e.value="",t},e.prototype.setMessageAsRead=function(){var e=messageListManager.getMessageObjectsForMarkAsRead();0<e.length&&(e.forEach(function(e){dataSource.usersAPI.updateMessageIsReadField(e.fieldName,e.userId,e.fieldValue)}),i.currentUserSettings.readLastMessage=!0),messageListManager.displayMessages()},e.prototype.saveMessageToDataSource=function(e){e.sender===i.currentUserSettings.userName&&dataSource.usersAPI.updateSendNewMessageFlag(i.currentUserSettings.userId,!0),dataSource.usersAPI.sendMessage(null,i.currentUserSettings.userId,e)},e.prototype.saveUserSettingsToDataSource=function(e){e.forEach(function(e){dataSource.usersAPI.setSettingField(e.fieldName,e.userId,e.fieldValue)})},new e}(mainConfig,eventEmitter,longPollResponseParser),viewFactory=function(n){function e(){}return e.prototype.createView=function(s,n,a){var r=this;return new Promise(function(e,t){s?(n&&r.includeViewCssToPage(r.createCSSLink(n,"stylesheet","text/css","touch-soft-chat-css")),e(r.includeViewHTMLToPage(s,a))):t(new Error("htmlPath is null. Please add htmlPath"))})},e.prototype.includeViewHTMLToPage=function(e,t){var s=t?getElement(t):document.body;return n.commonAPI.getHTML(e).then(function(e){s.innerHTML=e})},e.prototype.includeViewCssToPage=function(e){document.head.appendChild(e)},e.prototype.createCSSLink=function(e,t,s,n){var a=document.createElement("link");return n&&a.setAttribute("id",n),t&&a.setAttribute("rel",t),s&&a.setAttribute("type",s),a.setAttribute("href",e),a},new e}(dataSource),chatCustomizer=function(t){function e(){}return e.prototype.setupOuterChatSettings=function(){this.allowMinimize(),this.setPositionOfMainBlock(),this.setTitle(),this.setMainCssClass(),this.allowDragNDrop()},e.prototype.allowDragNDrop=function(){var e=getElement(t.DOM.TITLE_BLOCK_CLASS),c=getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS);"false"!==t.chatSettings.allowDrag&&e.addEventListener("mousedown",function(e){var t,s,n,a,r,o,i;function u(e){c.style.left=e.pageX-s+"px",c.style.top=e.pageY-n+"px"}t={top:(i=c.getBoundingClientRect()).top+window.pageYOffset,left:i.left+window.pageXOffset},s=e.pageX-t.left,n=e.pageY-t.top,a=function(e){u(e)},r=function(){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r)},o=function(){return!1},u(e),c.style.zIndex=1e3,document.addEventListener("mousemove",a),document.addEventListener("mouseup",r),c.addEventListener("dragstart",o)})},e.prototype.setPositionOfMainBlock=function(){"right"===t.chatSettings.position?getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.add(t.CHAT_POSITION_RIGHT):getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.add(t.CHAT_POSITION_LEFT)},e.prototype.setTitle=function(){t.chatSettings.chatTitle.length<1&&(t.chatSettings.chatTitle=t.DEFAULT_CHAT_TITLE),getElement(t.DOM.TITLE_BLOCK_CLASS).innerHTML=t.chatSettings.chatTitle},e.prototype.allowMinimize=function(){"false"===t.chatSettings.allowMinimize&&getElement(t.DOM.CHANGE_STYLE_BUTTON_MAX_SIZE).classList.add(t.INVISIBLE_CLASS)},e.prototype.setMainCssClass=function(){t.chatSettings.outerCssClass.length<1&&(t.chatSettings.outerCssClass=t.DEFAULT_CSS_CLASS_FOR_CHAT),getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).parentNode.classList.add(t.chatSettings.outerCssClass)},new e}(mainConfig),chatController=function(t,s,n){var a=["authorization","enter your name, please",""];function e(){this.createNewUser=n.createNewUserProfileToDataBase}return e.prototype.startApp=function(){var e=this;return this.setupChatView().then(function(){e.authorization(t.chatSettings.requireName),e.setupChatBasicListeners()}).then(function(){n.getUserData(t.currentUserSettings.userId).then(function(){e.setupChatStyle(),e.setupChatSendListeners(),chatCustomizer.setupOuterChatSettings(),s.setupLongPollConnection()})})},e.prototype.authorization=function(e){n.setup(),this.getConditionFromLocalStorage()?(this.setupChatCondition(),this.setupIntervalFunctions()):(t.currentUserSettings.userId=t.DEFAULT_USER_NAME+(new Date).getTime(),"false"===e?(t.currentUserSettings.userName=t.DEFAULT_USER_NAME,this.saveConditionToLocalStorage(),n.createNewUserProfileToDataBase(t.currentUserSettings.userId,t.currentUserSettings.userName),this.setupIntervalFunctions()):s.execute("askQuestion",a,"pending",this.getUserNameFromInput,this))},e.prototype.toggleAuthorizationMenuVisible=function(){getElement(t.DOM.AUTHORIZATION_MENU_CLASS).classList.toggle(t.INVISIBLE_CLASS)},e.prototype.getUserNameFromInput=function(){t.currentUserSettings.userName=getElement(t.DOM.USER_NAME_INPUT_CLASS).value,t.chatSettings.isMinimize=!1,this.createNewUser(t.currentUserSettings.userId,t.currentUserSettings.userName),this.setupIntervalFunctions(),this.saveConditionToLocalStorage()},e.prototype.setupChatSendListeners=function(){getElement(t.DOM.SEND_MESSAGE_FULL_SIZE_BUTTON).addEventListener("click",n.sendMessage.bind(n,t.currentUserSettings.userName)),getElement(t.DOM.SEND_MESSAGE_MIN_SIZE_BUTTON).addEventListener("click",n.sendMessage.bind(n,t.currentUserSettings.userName)),document.addEventListener("mousemove",n.setMessageAsRead.bind(n))},e.prototype.setupChatBasicListeners=function(){getElement(t.DOM.SET_MAX_STYLE_BUTTON).addEventListener("click",this.minMaxStyleToggle.bind(this)),getElement(t.DOM.SET_MIN_STYLE_BUTTON).addEventListener("click",this.minMaxStyleToggle.bind(this))},e.prototype.setupChatView=function(){return viewFactory.createView(t.HTML_FILE_PATH,t.CSS_FILE_PATH,null)},e.prototype.setupChatStyle=function(){t.currentUserSettings.isMinimize?getElement(t.DOM.MINIMIZE_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS):getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS),this.changeInputAndSendButtonClass()},e.prototype.minMaxStyleToggle=function(){getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS),getElement(t.DOM.MINIMIZE_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS),t.currentUserSettings.isMinimize=!1===t.currentUserSettings.isMinimize,this.changeInputAndSendButtonClass(),this.saveConditionToLocalStorage()},e.prototype.activityNotify=function(){n.updateUserOnline(t.currentUserSettings.userId)},e.prototype.changeInputAndSendButtonClass=function(){t.currentUserSettings.isMinimize?t.CSS_CURRENT_INPUT_CLASS=t.DOM.CSS_MIN_SIZE_INPUT_MESSAGE_BLOCK_CLASS:t.CSS_CURRENT_INPUT_CLASS=t.DOM.CSS_MAX_SIZE_INPUT_MESSAGE_BLOCK_CLASS},e.prototype.setupChatCondition=function(){var e=this.getConditionFromLocalStorage();t.currentUserSettings.userId=this.getConditionFromLocalStorage().userId,t.currentUserSettings.userName=this.getConditionFromLocalStorage().userName,t.currentUserSettings.isMinimize=e.isMinimize},e.prototype.saveConditionToLocalStorage=function(){var e=JSON.stringify({userId:t.currentUserSettings.userId,isMinimize:t.currentUserSettings.isMinimize,userName:t.currentUserSettings.userName});localStorage.setItem(t.LOCAL_STORAGE_NAME,e)},e.prototype.getConditionFromLocalStorage=function(){var e=localStorage.getItem(t.LOCAL_STORAGE_NAME);return!!e&&JSON.parse(e)},e.prototype.setupIntervalFunctions=function(){var e=this;setInterval(function(){"longPoll"!==t.chatSettings.typeOfRequest&&n.getUserData(t.currentUserSettings.userId),e.activityNotify()},t.UPDATE_USER_DATA_TIME)},new e}(mainConfig,instructionPerformer,userDataManager);chatController.startApp();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoYXRBcHAuanMiXSwibmFtZXMiOlsibWFpbkNvbmZpZyIsIkRPTSIsIk1BSU5fU1RZTEVfQ0hBVF9CTE9DS19DTEFTUyIsIkFVVEhPUklaQVRJT05fTUVOVV9DTEFTUyIsIlVTRVJfTkFNRV9JTlBVVF9DTEFTUyIsIlNFTkRfVVNFUl9OQU1FX0JVVFRPTiIsIlNFTkRfTUVTU0FHRV9NSU5fU0laRV9CVVRUT04iLCJTRU5EX01FU1NBR0VfRlVMTF9TSVpFX0JVVFRPTiIsIkNTU19NQVhfU0laRV9JTlBVVF9NRVNTQUdFX0JMT0NLX0NMQVNTIiwiQ1NTX01JTl9TSVpFX0lOUFVUX01FU1NBR0VfQkxPQ0tfQ0xBU1MiLCJUSVRMRV9CTE9DS19DTEFTUyIsIkNIQU5HRV9TVFlMRV9CVVRUT05fTUFYX1NJWkUiLCJNSU5JTUlaRV9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTIiwiU0VUX01JTl9TVFlMRV9CVVRUT04iLCJTRVRfTUFYX1NUWUxFX0JVVFRPTiIsIkNIQVRfUVVFU1RJT05fQ1NTIiwiREFUQV9CQVNFX1VSTCIsIkNTU19DVVJSRU5UX0lOUFVUX0NMQVNTIiwiY3VycmVudFVzZXJTZXR0aW5ncyIsInVzZXJJZCIsInVzZXJOYW1lIiwiaXNNaW5pbWl6ZSIsInJlYWRMYXN0TWVzc2FnZSIsInNlbmROZXdNZXNzYWdlIiwibGFzdE9ubGluZSIsIkRhdGUiLCJnZXRUaW1lIiwiY2hhdFNldHRpbmdzIiwiYWxsb3dEcmFnIiwicG9zaXRpb24iLCJjaGF0VGl0bGUiLCJhbGxvd01pbmltaXplIiwib3V0ZXJDc3NDbGFzcyIsInR5cGVPZlJlcXVlc3QiLCJyZXF1aXJlTmFtZSIsIklOVklTSUJMRV9DTEFTUyIsIkNIQVRfUE9TSVRJT05fUklHSFQiLCJDSEFUX1BPU0lUSU9OX0xFRlQiLCJMT0NBTF9TVE9SQUdFX05BTUUiLCJERUZBVUxUX1VTRVJfTkFNRSIsIkRFRkFVTFRfQ1NTX0NMQVNTX0ZPUl9DSEFUIiwiREVGQVVMVF9DSEFUX1RJVExFIiwiSFRNTF9GSUxFX1BBVEgiLCJDU1NfRklMRV9QQVRIIiwibWVzc2FnZXMiLCJDU1NfVVNFUl9OT1RfUkVBRF9NRVNTQUdFUyIsIkNTU19DSEFUX01FU1NBR0VTX0NPTlRBSU5FUiIsIkNTU19NRVNTQUdFX0NPTlRBSU5FUiIsIkNTU19DSEFUX01FU1NBR0VfU0VOREVSX05BTUUiLCJDU1NfQ0hBVF9NRVNTQUdFX0RBVEUiLCJDU1NfQ0hBVF9NRVNTQUdFIiwiRElTUExBWV9NRVNTQUdFX0RBVEUiLCJESVNQTEFZX1NFTkRFUl9OQU1FIiwiRElTUExBWV9NRVNTQUdFIiwiVVBEQVRFX1VTRVJfREFUQV9USU1FIiwiQ09NTUFORF9QQVRIX1BSRUZJWCIsInBhcnNlU3JjRm9yUGFyYW1ldGVycyIsInNyYyIsInVzZXJDb25maWdPYmplY3QiLCJzdWJzdHIiLCJpbmRleE9mIiwic3BsaXQiLCJmb3JFYWNoIiwiZWxlbWVudCIsInBhcmFtT2JqIiwicmVwbGFjZSIsInNldE91dGVyQ2hhdFNldHRpbmdUb0NvbmZpZyIsIm91dGVyQ29uZmlnT2JqZWN0IiwiY29uZmlnIiwiT2JqZWN0Iiwia2V5cyIsIm1hcCIsImtleSIsImRvY3VtZW50IiwiY3VycmVudFNjcmlwdCIsImdldEF0dHJpYnV0ZSIsImRhdGFCYXNlVXJsIiwiZ2V0RWxlbWVudCIsInNlbGVjdG9yIiwiaXNBbGwiLCJpdElzSWQiLCJzZWxlY3RvclN0YXJ0IiwicXVlcnlTZWxlY3RvckFsbCIsInF1ZXJ5U2VsZWN0b3IiLCJkYXRhQ29ubmVjdG9yQ29uZmlnIiwiZGF0YUNvbm5lY3RvciIsImRhdGFDb25uZWN0b3JDb25maWdPYmoiLCJkYXRhQmFzZUNvbm5lY3RvciIsIkRhdGFCYXNlQ29ubmVjdG9yIiwicHJvdG90eXBlIiwic2V0dXBEYXRhQmFzZUFQSSIsInJlcXVlc3QiLCJyZXF1ZXN0RmV0Y2giLCJnZXROZXdDb25uZWN0b3JBUEkiLCJyZXF1ZXN0WE1SIiwiY3JlYXRlTG9uZ1BvbGxDb25uZWN0aW9uIiwibG9uZ1BvbGwiLCJyZXF1ZXN0UGF0aCIsInJlcXVlc3RCb2R5IiwicmVxdWVzdFR5cGUiLCJjb250ZW50VHlwZSIsImZldGNoIiwiaGVhZGVycyIsIkFjY2VwdCIsIkNvbnRlbnQtVHlwZSIsIm1ldGhvZCIsImJvZHkiLCJ0aGVuIiwicmVzcG9uc2UiLCJqc29uIiwidGV4dCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2V0UmVxdWVzdEhlYWRlciIsIm9ubG9hZCIsIkpTT04iLCJwYXJzZSIsIm9uZXJyb3IiLCJzdGF0dXNUZXh0Iiwic2VuZCIsInRhcmdldFVybCIsInhodHRwIiwiZGF0YVNvdXJjZSIsImRhdGFTb3VyY2VJbnN0YW5jZSIsIlVTRVJfTElTVCIsIlVTRVJfTUVTU0FHRVMiLCJVU0VSU19TRVRUSU5HUyIsIm5ld1VzZXJEYXRhIiwiRGF0YVNvdXJjZSIsImxvbmdQb2xsQ29ubmVjdCIsImRhdGFUeXBlIiwidGhpcyIsImNyZWF0ZVJlcXVlc3RQYXRoIiwiYmFzaWNDb25uZWN0IiwiYmluZCIsImRhdGFCYXNlVVJMIiwicmVxdWVzdFBvc3RmaXgiLCJyZXF1ZXN0UHJlZml4IiwicGF0aCIsImdldEhUTUwiLCJzZXREYXRhIiwiZmllbGROYW1lIiwidmFsdWUiLCJzdHJpbmdpZnkiLCJhZGROZXdVc2VyVG9EYXRhU291cmNlIiwiZGF0ZSIsInRoYXQiLCJzZXR0aW5nTmFtZSIsImdldERhdGFTb3VyY2VBUEkiLCJnZXREYXRhIiwidXNlcnNBUEkiLCJnZXRVc2VyTGlzdCIsImdldFVzZXJTZXR0aW5ncyIsImdldFVzZXJNZXNzYWdlcyIsImdldFNldHRpbmdGaWVsZCIsInNlbmRNZXNzYWdlIiwic2V0U2V0dGluZ0ZpZWxkIiwidXBkYXRlTGFzdE9ubGluZSIsInVwZGF0ZVNlbmROZXdNZXNzYWdlRmxhZyIsInVwZGF0ZU1lc3NhZ2VJc1JlYWRGaWVsZCIsImNvbW1vbkFQSSIsImV2ZW50RW1pdHRlciIsIkV2ZW50RW1pdHRlciIsImV2ZW50cyIsImFkZFN1YnNjcmliZSIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwicHVzaCIsImZpbHRlciIsImVsZW1lbnRDYWxsYmFjayIsImVtaXQiLCJkYXRhIiwiZXZlbnQiLCJjYWxsIiwibG9uZ1BvbGxSZXNwb25zZVBhcnNlciIsInR5cGVzT2ZDaGFuZ2UiLCJtZXNzYWdlIiwidXNlckxpc3QiLCJzZXR0aW5nIiwicmVhZCIsImdldElwIiwiYXNrUXVlc3Rpb24iLCJldmVudFJlZ3VsYXIiLCJoYXNOdWxsRGF0YSIsImdldERhdGFSZWd1bGFyIiwiaXRJc05ld01lc3NhZ2VSZWd1bGFyIiwiaXRJc05ld1VzZXJMaXN0UmVndWxhciIsIml0SXNGaXJzdElwRGF0YVJlZ3VsYXIiLCJpdElzRmlyc3RRdWVzdGlvbnNEYXRhIiwiaXRJc05ld1F1ZXN0aW9uc0NvbW1hbmQiLCJpdElzRmlyc3RVc2VyTGlzdENvbm5lY3Rpb24iLCJMb25nUG9sbFJlc3BvbnNlUGFyc2VyIiwiZ2V0VHlwZU9mQ2hhbmdlcyIsImFuc3dlckRhdGEiLCJ0eXBlTmFtZSIsInRlc3QiLCJwcmVwYXJlRGF0YUJlZm9yZUpzb25QYXJzZSIsImxlbmd0aCIsInRyaW0iLCJzbGljZSIsInBhcnNlVXNlcnNNZXNzYWdlcyIsImNoYW5nZVR5cGUiLCJtZXNzYWdlSWQiLCJyZXN1bHRPYmplY3QiLCJpZCIsInBvcCIsInNoaWZ0IiwiZ2V0Rmlyc3REYXRhIiwiaGFzTmV3RGF0YSIsInBhcnNlVXNlckxpc3QiLCJnZXRVc2VySWQiLCJleGNlcHRpb24iLCJwYXJzZUNvbW1hbmRBbnN3ZXIiLCJpdElzSVBJbmZvcm1hdGlvbiIsIml0SXNRdWVzdGlvbnNJbmZvcm1hdGlvbiIsInBhcnNlVXNlcklwRGF0YSIsInBhcnNlUXVlc3Rpb25zRGF0YSIsInJlc3VsdCIsInJlc3VsdE9mUGFyc2UiLCJ0eXBlIiwib2JqZWN0IiwiaW5zdHJ1Y3Rpb25QZXJmb3JtZXIiLCJwYXJzZXIiLCJpbnN0cnVjdGlvbnMiLCJzYXZlUmVzdWx0IiwiaW5zdHJ1Y3Rpb25OYW1lIiwiY29udGV4dCIsImlzTmVlZE5vdGlmeSIsImJpbmRDYWxsYmFjayIsImZ1bGxDYWxsYmFjayIsImlucHV0VmFsdWUiLCJ0b2dnbGVRdWVzdGlvbk1lbnVWaXNpYmxlIiwiaW5zdHJ1Y3Rpb25zQ2FsbGJhY2siLCJpbm5lckhUTUwiLCJxdWVzdGlvbkxpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJpbnN0cnVjdGlvbnNRdWV1ZSIsImRhdGFOYW1lIiwidXNlciIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInBhdGhPZk5vdGlmeSIsImNoZWNrQXZhaWxhYmlsaXR5TmV3SW5zdHJ1Y3Rpb25zIiwia2V5T2ZDb21tYW5kcyIsInBhcmFtZXRlcnMiLCJzZXRUaW1lb3V0IiwiY29tbWFuZHMiLCJjb21tYW5kT2JqZWN0IiwiaXNFeGVjdXRlIiwiaGFzSW5zdHJ1Y3Rpb25LZXkiLCJjb21tYW5kRGF0YSIsImkiLCJwYXJhbWV0ZXJzTnVtYmVyIiwiZ2V0UGFyYW1ldGVycyIsImV4ZWN1dGUiLCJ0eXBlT2ZDb21tYW5kIiwicGVyZm9ybWVyT2JqZWN0Iiwic2V0dXAiLCJzZXR1cExvbmdQb2xsQ29ubmVjdGlvbiIsImNvbm5lY3Rpb24iLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwicmVzcG9uc2VUZXh0IiwiQXJyYXkiLCJjb25zb2xlIiwibG9nIiwibWVzc2FnZUxpc3RNYW5hZ2VyIiwiTWVzc2FnZUxpc3RNYW5hZ2VyIiwibWVzc2FnZUxpc3QiLCJjRE9NIiwibWVzc2FnZXNCbG9jayIsImNyZWF0ZU1lc3NhZ2VFbGVtZW50IiwibWVzc2FnZURhdGUiLCJzZW5kZXIiLCJpc1JlYWQiLCJtZXNzYWdlQ29udGFpbmVyRGl2IiwiY3JlYXRlTWVzc2FnZUNvbnRhaW5lckRpdiIsIm1lc3NhZ2VEYXRlRGl2IiwiY3JlYXRlRGl2Rm9yTWVzc2FnZUJsb2NrIiwibWVzc2FnZVNlbmRlckRpdiIsIm1lc3NhZ2VEaXYiLCJhcHBlbmRDaGlsZCIsImdldE1lc3NhZ2VPYmplY3RzRm9yTWFya0FzUmVhZCIsIm1lc3NhZ2VzSXNSZWFkIiwiQURNSU5fTkFNRSIsImZpZWxkVmFsdWUiLCJjcmVhdGVFbGVtZW50IiwiYWRkIiwiaXNEaXNwbGF5Iiwic3R5bGVDbGFzc2VzIiwiZGl2Iiwic3R5bGUiLCJjcmVhdGVNZXNzYWdlTGlzdCIsIm1lc3NhZ2VPYmplY3RzIiwibmV3TWVzc2FnZUxpc3QiLCJ1cGRhdGVNZXNzYWdlTGlzdCIsImRpc3BsYXlNZXNzYWdlcyIsImFkZE1lc3NhZ2VUb01lc3NhZ2VMaXN0IiwibWVzc2FnZU9iaiIsImNsZWFyQ2hhdCIsIm1lc3NhZ2VPYmplY3QiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJ1c2VyRGF0YU1hbmFnZXIiLCJVc2VyRGF0YU1hbmFnZXIiLCJnZXRVc2VyRGF0YSIsImdldFVzZXJDb3JyZXNwb25kZW5jZSIsImN1cnJlbnRNZXNzYWdlQ29ubmVjdGlvbiIsImFib3J0IiwibWVzc2FnZXNPYmplY3QiLCJjbGVhck1lc3NhZ2VMaXN0IiwiY3JlYXRlTmV3VXNlclByb2ZpbGVUb0RhdGFCYXNlIiwic2F2ZVNldHRpbmdGaWVsZCIsInVwZGF0ZVVzZXJPbmxpbmUiLCJtaW51dGVzIiwiZ2V0TWVzc2FnZUZyb21JbnB1dEVsZW1lbnQiLCJnZXRNaW51dGVzIiwidG9TdHJpbmciLCJnZXRIb3VycyIsImNvbmNhdCIsInNhdmVNZXNzYWdlVG9EYXRhU291cmNlIiwic2V0TWVzc2FnZUFzUmVhZCIsInNhdmVVc2VyU2V0dGluZ3NUb0RhdGFTb3VyY2UiLCJzZXR0aW5ncyIsIm5ld0ZpZWxkU2V0dGluZyIsInZpZXdGYWN0b3J5IiwiVmlld0ZhY3RvcnkiLCJjcmVhdGVWaWV3IiwiaHRtbFBhdGgiLCJjc3NQYXRoIiwiY29udGFpbmVyQ2xhc3MiLCJpbmNsdWRlVmlld0Nzc1RvUGFnZSIsImNyZWF0ZUNTU0xpbmsiLCJpbmNsdWRlVmlld0hUTUxUb1BhZ2UiLCJFcnJvciIsImNvbnRhaW5lckRpdiIsImh0bWwiLCJsaW5rIiwiaGVhZCIsImZpbGVQYXRoIiwicmVsIiwic2V0QXR0cmlidXRlIiwiY2hhdEN1c3RvbWl6ZXIiLCJDaGF0Q3VzdG9taXplciIsInNldHVwT3V0ZXJDaGF0U2V0dGluZ3MiLCJzZXRQb3NpdGlvbk9mTWFpbkJsb2NrIiwic2V0VGl0bGUiLCJzZXRNYWluQ3NzQ2xhc3MiLCJhbGxvd0RyYWdORHJvcCIsImNsaWNrQmxvY2siLCJkcmFnQmxvY2siLCJlIiwiY29yZHMiLCJzaGlmdFgiLCJzaGlmdFkiLCJtb3ZlT2JqIiwic2V0TnVsbCIsImVuZERyYWciLCJib3giLCJtb3ZlQXQiLCJlbGVtIiwibGVmdCIsInBhZ2VYIiwidG9wIiwicGFnZVkiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ3aW5kb3ciLCJwYWdlWU9mZnNldCIsInBhZ2VYT2Zmc2V0IiwiekluZGV4IiwicGFyZW50Tm9kZSIsImNoYXRDb250cm9sbGVyIiwiZGF0YUZvckdldFVzZXJOYW1lQ2FsbGJhY2siLCJDaGF0Q29udHJvbGxlciIsImNyZWF0ZU5ld1VzZXIiLCJzdGFydEFwcCIsInNldHVwQ2hhdFZpZXciLCJhdXRob3JpemF0aW9uIiwic2V0dXBDaGF0QmFzaWNMaXN0ZW5lcnMiLCJzZXR1cENoYXRTdHlsZSIsInNldHVwQ2hhdFNlbmRMaXN0ZW5lcnMiLCJ1c2VyTmFtZUlzUmVxdWlyZSIsImdldENvbmRpdGlvbkZyb21Mb2NhbFN0b3JhZ2UiLCJzZXR1cENoYXRDb25kaXRpb24iLCJzZXR1cEludGVydmFsRnVuY3Rpb25zIiwic2F2ZUNvbmRpdGlvblRvTG9jYWxTdG9yYWdlIiwiZ2V0VXNlck5hbWVGcm9tSW5wdXQiLCJ0b2dnbGVBdXRob3JpemF0aW9uTWVudVZpc2libGUiLCJtaW5NYXhTdHlsZVRvZ2dsZSIsImNoYW5nZUlucHV0QW5kU2VuZEJ1dHRvbkNsYXNzIiwiYWN0aXZpdHlOb3RpZnkiLCJjb25kaXRpb24iLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiZ2V0SXRlbSIsInNldEludGVydmFsIl0sIm1h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QUlTLEVBQVlDLGFBQWFFLFFBQVE1VSxFQUFPOUIsb0JBQzVDLFFBQUd1VyxHQUNRdFIsS0FBS0MsTUFBTXFSLElBTzFCbEIsRUFBZWxTLFVBQVU2Uyx1QkFBeUIsV0FDOUMsSUFBSWhQLEVBQU9mLEtBQ1gwUSxZQUFhLFdBQ2dDLGFBQXRDN1UsRUFBT3pDLGFBQWFNLGVBQ25Cb1IsRUFBZ0JFLFlBQVluUCxFQUFPbEQsb0JBQW9CQyxRQUUzRG1JLEVBQUtzUCxrQkFDTnhVLEVBQU9kLHdCQUdQLElBQUlxVSxFQXJNTSxDQXVNbEIzWCxXQUFZaU8scUJBQXNCb0YsaUJBR3JDb0UsZUFBZUkiLCJmaWxlIjoiY2hhdEFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGNvbmZpZ1xyXG5cclxudmFyIG1haW5Db25maWcgPSB7XHJcbiAgICBET006IHtcclxuICAgICAgICBNQUlOX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRcIixcclxuICAgICAgICBBVVRIT1JJWkFUSU9OX01FTlVfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfaW5wdXQtbmFtZS1ibG9ja1wiLFxyXG4gICAgICAgIFVTRVJfTkFNRV9JTlBVVF9DTEFTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9pbnB1dC1uYW1lXCIsXHJcbiAgICAgICAgU0VORF9VU0VSX05BTUVfQlVUVE9OOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X2lucHV0LW5hbWUtYnV0dG9uXCIsXHJcblxyXG4gICAgICAgIFNFTkRfTUVTU0FHRV9NSU5fU0laRV9CVVRUT046IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfbWluaW1pemUtc3R5bGVfX3NlbmQtYnV0dG9uXCIsXHJcblxyXG4gICAgICAgIFNFTkRfTUVTU0FHRV9GVUxMX1NJWkVfQlVUVE9OOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X19ib3R0b21fc2VuZC1idXR0b25cIixcclxuICAgICAgICAvLyDQrdC70LXQvNC10L3RgiDQtNC70Y8g0LLQstC+0LTQsCDRgdC+0L7QsdGJ0LXQvdC40Y9cclxuICAgICAgICBDU1NfTUFYX1NJWkVfSU5QVVRfTUVTU0FHRV9CTE9DS19DTEFTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9fdGV4dGFyZWFcIixcclxuICAgICAgICBDU1NfTUlOX1NJWkVfSU5QVVRfTUVTU0FHRV9CTE9DS19DTEFTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9taW5pbWl6ZS1zdHlsZV9fbWVzc2FnZS1pbnB1dFwiLFxyXG4gICAgICAgIC8vINCt0LvQtdC80LXQvdGCIHRpdGxlXHJcbiAgICAgICAgVElUTEVfQkxPQ0tfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnQtdGl0bGVcIixcclxuICAgICAgICBDSEFOR0VfU1RZTEVfQlVUVE9OX01BWF9TSVpFOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X190b3BfbWluaW1pemUtYnV0dG9uXCIsXHJcbiAgICAgICAgLy8g0YfQsNGCINCyINGB0YLQuNC70LUgbWluXHJcbiAgICAgICAgTUlOSU1JWkVfU1RZTEVfQ0hBVF9CTE9DS19DTEFTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9taW5pbWl6ZS1zdHlsZVwiLFxyXG4gICAgICAgIFNFVF9NSU5fU1RZTEVfQlVUVE9OOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X21pbmltaXplLXN0eWxlX19tYXgtYnV0dG9uXCIsXHJcbiAgICAgICAgU0VUX01BWF9TVFlMRV9CVVRUT046IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfX3RvcF9taW5pbWl6ZS1idXR0b25cIixcclxuICAgICAgICBDSEFUX1FVRVNUSU9OX0NTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9pbmZvcm1hdGlvbi1lbnRlci1uYW1lXCJcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIGRhdGFTb3VyY2VcclxuICAgIERBVEFfQkFTRV9VUkw6IFwiaHR0cHM6Ly9vbmxpbmVjb25zdWx0YW50d2ViYXBwLmZpcmViYXNlaW8uY29tXCIsXHJcblxyXG5cclxuICAgIC8vIHVzZXJEYXRhTWFuYWdlclxyXG4gICAgQ1NTX0NVUlJFTlRfSU5QVVRfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfX3RleHRhcmVhXCIsXHJcblxyXG4gICAgLy8g0L3QsNGB0YLRgNC+0LnQutC4INGC0LXQutGD0YnQtdCz0L4g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMXHJcbiAgICBjdXJyZW50VXNlclNldHRpbmdzOiB7XHJcbiAgICAgICAgdXNlcklkOiBudWxsLFxyXG4gICAgICAgIHVzZXJOYW1lOiBudWxsLFxyXG4gICAgICAgIGlzTWluaW1pemU6IGZhbHNlLFxyXG4gICAgICAgIHJlYWRMYXN0TWVzc2FnZTogZmFsc2UsXHJcbiAgICAgICAgc2VuZE5ld01lc3NhZ2U6IGZhbHNlLFxyXG4gICAgICAgIGxhc3RPbmxpbmU6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXHJcbiAgICB9LFxyXG5cclxuICAgIGNoYXRTZXR0aW5nczoge1xyXG4gICAgICAgIGFsbG93RHJhZzogZmFsc2UsXHJcbiAgICAgICAgcG9zaXRpb246IFwicmlnaHRcIixcclxuICAgICAgICBjaGF0VGl0bGU6IFwiVG91Y2hTb2Z0IENoYXRcIixcclxuICAgICAgICBhbGxvd01pbmltaXplOiB0cnVlLFxyXG4gICAgICAgIG91dGVyQ3NzQ2xhc3M6ICd0b3VjaHNvZnQtY2hhdF9tYWluLWJsb2NrJyxcclxuICAgICAgICB0eXBlT2ZSZXF1ZXN0OiBcImZldGNoXCIsXHJcbiAgICAgICAgcmVxdWlyZU5hbWU6IHRydWVcclxuICAgIH0sXHJcblxyXG4gICAgLy8g0LrQu9Cw0YHRgSDQv9C10YDQtdC60LvRjtGH0LDRgtC10LvRjCDQvtGC0L7QsdGA0LDQttC10L3QuNGPINGN0LvQtdC80LXQvdGC0LBcclxuICAgIElOVklTSUJMRV9DTEFTUzogXCJpbnZpc2libGVcIixcclxuICAgIENIQVRfUE9TSVRJT05fUklHSFQ6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfcmlnaHQtcG9zaXRpb25cIixcclxuICAgIENIQVRfUE9TSVRJT05fTEVGVDogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9sZWZ0LXBvc2l0aW9uXCIsXHJcblxyXG5cclxuICAgIExPQ0FMX1NUT1JBR0VfTkFNRTogXCJ1c2VySURfdG91Y2hzb2Z0X2NoYXRcIixcclxuICAgIERFRkFVTFRfVVNFUl9OQU1FOiBcImd1ZXN0XCIsXHJcblxyXG4gICAgREVGQVVMVF9DU1NfQ0xBU1NfRk9SX0NIQVQ6ICd0b3VjaHNvZnQtY2hhdF9tYWluLWJsb2NrJyxcclxuICAgIERFRkFVTFRfQ0hBVF9USVRMRTogXCJUb3VjaFNvZnQgQ2hhdFwiLFxyXG5cclxuICAgIC8vIGNoYXRWaWV3Q29uZmlnXHJcbiAgICAvLyDQvtGC0LrRg9C00LAg0LfQsNCz0YDRg9C20LDQtdGCIGh0bWwg0LggY3NzINGH0LDRgtCwXHJcbiAgICBIVE1MX0ZJTEVfUEFUSDpcclxuICAgICAgICBcImh0dHBzOi8vcmF3Z2l0LmNvbS9VbmFjY2VwdGFibGVDb25kaXRpb24vb25saW5lX2NvbnN1bHRhbnRfd2ViX2FwcC9tYXN0ZXIvYXBwL2h0bWwvY2hhdEFwcGxpY2F0aW9uL2NoYXQuaHRtbFwiLFxyXG4gICAgQ1NTX0ZJTEVfUEFUSDpcclxuICAgICAgICBcImh0dHBzOi8vcmF3Z2l0LmNvbS9VbmFjY2VwdGFibGVDb25kaXRpb24vb25saW5lX2NvbnN1bHRhbnRfd2ViX2FwcC9tYXN0ZXIvYXBwL2Nzcy9jaGF0LmNzc1wiLFxyXG5cclxuICAgIC8vINCa0LvQsNGB0YHRiyDQtNC70Y8g0YDQsNCx0L7RgtGLINGBINC+0LHRitC10LrRgtCw0LzQuCDRgdC+0L7QsdGJ0LXQvdC40Lkg0LTQu9GPINC40YUg0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDQsiDRh9Cw0YLQtVxyXG4gICAgbWVzc2FnZXM6IHtcclxuICAgICAgICAvLyBDc3Mg0LrQu9Cw0YHRgSDQtNC70Y8g0Y3Qu9C10LzQtdC90LDRgiDRgSDRgdC+0L7QsdGJ0LXQvdC40LUsINC10YHQu9C4INGO0LfQtdGAINC90LUg0L/RgNC+0YfQuNGC0LDQuyDRgdC+0L7QsdGJ0LXQvdC40Y9cclxuICAgICAgICBDU1NfVVNFUl9OT1RfUkVBRF9NRVNTQUdFUzogXCJyb290LXRvdWNoc29mdC1kYXNoYm9hcmRfbWVzc2FnZS1ub3QtcmVhZFwiLFxyXG4gICAgICAgIC8vIENzcyDQutC70LDRgdGBIERPTSDRjdC70LXQvNC10L3RgtCwINCyINC60L7RgtC+0YDQvtC8INCx0YPQtNC10Lwg0L7RgtC+0LHRgNCw0LbQsNGC0Ywg0YHQvtC+0LHRidC10L3QuNGPXHJcbiAgICAgICAgQ1NTX0NIQVRfTUVTU0FHRVNfQ09OVEFJTkVSOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X190b3BfbWVzc2FnZXNcIixcclxuXHJcbiAgICAgICAgLy8gbWVzc2FnZVxyXG4gICAgICAgIC8vIENzcyDQutC70LDRgdGBINGN0LvQtdC80LXQvdGC0LAg0LIg0LrQvtGC0L7RgNC+0Lwg0L3QsNGF0L7QtNC40YLRgdGPINGB0L7QvtCx0YnQtdC90LjRjyzQtNCw0YLQsCDQuCDQuNC80Y8g0L7RgtC/0YDQsNCy0LjRgtC10LvRj1xyXG4gICAgICAgIENTU19NRVNTQUdFX0NPTlRBSU5FUjogXCJyb290LXRvdWNoc29mdC1kYXNoYm9hcmRfY2hhdC1tZXNzYWdlLWVsZW1lbnRzXCIsXHJcbiAgICAgICAgLy8gQ3NzINC60LvQsNGB0YEgRE9NINGN0LvQtdC80LXQvdGC0LAg0LIg0LrQvtGC0L7RgNC+0Lwg0LHRg9C00LXQvCDQvtGC0L7QsdGA0LDQttCw0YLRjCDQuNC80Y8g0L7RgtC/0YDQsNCy0LjRgtC10LvRj1xyXG4gICAgICAgIENTU19DSEFUX01FU1NBR0VfU0VOREVSX05BTUU6IFwicm9vdC10b3VjaHNvZnQtZGFzaGJvYXJkX2NoYXQtbWVzc2FnZS1zZW5kZXJcIixcclxuICAgICAgICAvLyBDc3Mg0LrQu9Cw0YHRgSBET00g0Y3Qu9C10LzQtdC90YLQsCDQsiDQutC+0YLQvtGA0L7QvCDQsdGD0LTQtdC8INC+0YLQvtCx0YDQsNC20LDRgtGMINC00LDRgtGDINGB0L7QvtCx0YnQtdC90LjRj1xyXG4gICAgICAgIENTU19DSEFUX01FU1NBR0VfREFURTogXCJyb290LXRvdWNoc29mdC1kYXNoYm9hcmRfY2hhdC1tZXNzYWdlLWRhdGVcIixcclxuICAgICAgICAvLyBDc3Mg0LrQu9Cw0YHRgSBET00g0Y3Qu9C10LzQtdC90YLQsCDQsiDQutC+0YLQvtGA0L7QvCDQsdGD0LTQtdC8INC+0YLQvtCx0YDQsNC20LDRgtGMINGB0L7QvtCx0YnQtdC90LjQtVxyXG4gICAgICAgIENTU19DSEFUX01FU1NBR0U6IFwicm9vdC10b3VjaHNvZnQtZGFzaGJvYXJkX2NoYXQtbWVzc2FnZVwiXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBESVNQTEFZX01FU1NBR0VfREFURTogdHJ1ZSxcclxuICAgIERJU1BMQVlfU0VOREVSX05BTUU6IHRydWUsXHJcbiAgICBESVNQTEFZX01FU1NBR0U6IHRydWUsXHJcblxyXG4gICAgVVBEQVRFX1VTRVJfREFUQV9USU1FOiA1MDAwLFxyXG5cclxuICAgIENPTU1BTkRfUEFUSF9QUkVGSVg6IFwiaHR0cHM6Ly9vbmxpbmVjb25zdWx0YW50d2ViYXBwLmZpcmViYXNlaW8uY29tL3VzZXJzU2V0dGluZ3MvXCJcclxuXHJcbn07XHJcblxyXG4vLyBJTkNMVURFXHJcbmZ1bmN0aW9uIHBhcnNlU3JjRm9yUGFyYW1ldGVycyhcclxuICAgIHNyY1xyXG4pIHtcclxuICAgIHZhciB1c2VyQ29uZmlnT2JqZWN0ID0ge307XHJcbiAgICB2YXIgYXJyUGFyYW0gPSBzcmMuc3Vic3RyKHNyYy5pbmRleE9mKFwiP1wiKSArIDEpLnNwbGl0KFwiJlwiKTtcclxuICAgIGFyclBhcmFtLmZvckVhY2goZnVuY3Rpb24gY3JlYXRlQ29uZmlnT2JqIChlbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIHBhcmFtT2JqID0gZWxlbWVudC5zcGxpdChcIj1cIik7XHJcbiAgICAgICAgcGFyYW1PYmpbMV0gPSBwYXJhbU9ialsxXS5yZXBsYWNlKC8nL2csIFwiXCIpO1xyXG4gICAgICAgIHVzZXJDb25maWdPYmplY3RbcGFyYW1PYmpbMF1dID0gcGFyYW1PYmpbMV07XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB1c2VyQ29uZmlnT2JqZWN0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRPdXRlckNoYXRTZXR0aW5nVG9Db25maWcgKG91dGVyQ29uZmlnT2JqZWN0LCBjb25maWcpIHtcclxuICAgIE9iamVjdC5rZXlzKG91dGVyQ29uZmlnT2JqZWN0KS5tYXAoZnVuY3Rpb24gZ2V0T3V0ZXJTZXR0aW5ncyAoa2V5KSB7XHJcbiAgICAgICAgY29uZmlnLmNoYXRTZXR0aW5nc1trZXldID0gb3V0ZXJDb25maWdPYmplY3Rba2V5XTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0pXHJcbn1cclxuXHJcbi8vIElOQ0xVREVcclxuXHJcbnNldE91dGVyQ2hhdFNldHRpbmdUb0NvbmZpZyhwYXJzZVNyY0ZvclBhcmFtZXRlcnMoZG9jdW1lbnQuY3VycmVudFNjcmlwdC5nZXRBdHRyaWJ1dGUoXCJzcmNcIikpLCBtYWluQ29uZmlnKTtcclxuLyogZXhwb3J0ZWQgZGF0YUNvbm5lY3RvckNvbmZpZyAqL1xyXG4vKiBleHBvcnRlZCBkYXRhQmFzZVVybCAqL1xyXG4vKiBleHBvcnRlZCBnZXRFbGVtZW50ICovXHJcbi8qIGdsb2JhbCBtYWluQ29uZmlnICovXHJcbnZhciBkYXRhQmFzZVVybCA9IG1haW5Db25maWcuREFUQV9CQVNFX1VSTDtcclxuXHJcbnZhciBnZXRFbGVtZW50ID0gZnVuY3Rpb24gZ2V0RWxlbWVudEZyb21ET00gKHNlbGVjdG9yLCBpc0FsbCwgaXRJc0lkKSB7XHJcbiAgICB2YXIgc2VsZWN0b3JTdGFydCA9IChpdElzSWQpID8gXCIjXCIgOiBcIi5cIjtcclxuICAgIGlmKGlzQWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3JTdGFydCArIHNlbGVjdG9yKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yU3RhcnQgKyBzZWxlY3Rvcik7XHJcbn07XHJcblxyXG5cclxudmFyIGRhdGFDb25uZWN0b3JDb25maWcgPSB7XHJcbiAgICB0eXBlT2ZSZXF1ZXN0OiBtYWluQ29uZmlnLmNoYXRTZXR0aW5ncy50eXBlT2ZSZXF1ZXN0XHJcbn07XHJcblxyXG4vLyBkYXRhYmFzZVxyXG5cclxuLyogZXhwb3J0ZWQgZGF0YUNvbm5lY3RvciAqL1xyXG4vKiBnbG9iYWwgZGF0YUNvbm5lY3RvckNvbmZpZyAqL1xyXG4vLyDQnNC+0LTRg9C70Ywg0L/RgNC10LTQvtGB0YLQsNCy0LvRj9C10YIg0YHQv9C+0YHQvtCxINC+0YLQv9GA0LDQstC60Lgg0LfQsNC/0YDQvtGB0LAg0Log0LjRgdGC0L7Rh9C90LjQutGDINC00LDQvdC90YvRhVxyXG4vLyDQlNC70Y8g0YDQtdC60LLQtdGB0YLQsCDQvdC10L7QsdGF0L7QtNC40Lwg0L/Rg9GC0YwsINGC0LXQu9C+INC30LDQv9GA0L7RgdCwLCDRgtC40L8g0LfQsNC/0YDQvtGB0LBcclxuLy8gcmVxdWVzdCDQstC+0LfQstGA0LDRidCw0LXRgiBQcm9taXNlXHJcbnZhciBkYXRhQ29ubmVjdG9yID0gKGZ1bmN0aW9uIGdldERhdGFTb3VyY2VBUEkoZGF0YUNvbm5lY3RvckNvbmZpZ09iaikge1xyXG4gICAgdmFyIGRhdGFCYXNlQ29ubmVjdG9yO1xyXG5cclxuICAgIGZ1bmN0aW9uIERhdGFCYXNlQ29ubmVjdG9yKCkge31cclxuXHJcbiAgICBEYXRhQmFzZUNvbm5lY3Rvci5wcm90b3R5cGUuc2V0dXBEYXRhQmFzZUFQSSA9IGZ1bmN0aW9uIHNldHVwRGF0YUJhc2VBUEkgKHR5cGVPZlJlcXVlc3QpIHtcclxuICAgICAgICB2YXIgZGF0YUJhc2VBUEk7XHJcbiAgICAgICAgaWYgKHR5cGVPZlJlcXVlc3QgPT09IFwiZmV0Y2hcIikge1xyXG4gICAgICAgICAgICBkYXRhQmFzZUFQSSA9IHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3Q6IGRhdGFCYXNlQ29ubmVjdG9yLnJlcXVlc3RGZXRjaCxcclxuICAgICAgICAgICAgICAgIGdldE5ld0Nvbm5lY3RvckFQSTogZGF0YUJhc2VDb25uZWN0b3Iuc2V0dXBEYXRhQmFzZUFQSVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZU9mUmVxdWVzdCA9PT0gXCJYSFJcIikge1xyXG4gICAgICAgICAgICBkYXRhQmFzZUFQSSA9IHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3Q6IGRhdGFCYXNlQ29ubmVjdG9yLnJlcXVlc3RYTVIsXHJcbiAgICAgICAgICAgICAgICBnZXROZXdDb25uZWN0b3JBUEk6IGRhdGFCYXNlQ29ubmVjdG9yLnNldHVwRGF0YUJhc2VBUElcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkYXRhQmFzZUFQSSA9IHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3Q6IGRhdGFCYXNlQ29ubmVjdG9yLnJlcXVlc3RYTVIsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVMb25nUG9sbENvbm5lY3Rpb246IGRhdGFCYXNlQ29ubmVjdG9yLmxvbmdQb2xsLFxyXG4gICAgICAgICAgICAgICAgZ2V0TmV3Q29ubmVjdG9yQVBJOiBkYXRhQmFzZUNvbm5lY3Rvci5zZXR1cERhdGFCYXNlQVBJXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhQmFzZUFQSTtcclxuICAgIH07XHJcblxyXG4gICAgRGF0YUJhc2VDb25uZWN0b3IucHJvdG90eXBlLnJlcXVlc3RGZXRjaCA9IGZ1bmN0aW9uIHJlcXVlc3RGZXRjaChcclxuICAgICAgICByZXF1ZXN0UGF0aCxcclxuICAgICAgICByZXF1ZXN0Qm9keSxcclxuICAgICAgICByZXF1ZXN0VHlwZSxcclxuICAgICAgICBjb250ZW50VHlwZVxyXG4gICAgKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHJlcXVlc3RQYXRoLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgIEFjY2VwdDogY29udGVudFR5cGUsXHJcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBjb250ZW50VHlwZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtZXRob2Q6IHJlcXVlc3RUeXBlLFxyXG4gICAgICAgICAgICBib2R5OiByZXF1ZXN0Qm9keVxyXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gZ2V0UmVzcG9uc2VKU09OKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIGlmKGNvbnRlbnRUeXBlID09PSBcImFwcGxpY2F0aW9uL2pzb25cIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBEYXRhQmFzZUNvbm5lY3Rvci5wcm90b3R5cGUucmVxdWVzdFhNUiA9IGZ1bmN0aW9uIHJlcXVlc3RYTVIoXHJcbiAgICAgICAgcmVxdWVzdFBhdGgsXHJcbiAgICAgICAgcmVxdWVzdEJvZHksXHJcbiAgICAgICAgcmVxdWVzdFR5cGUsXHJcbiAgICAgICAgY29udGVudFR5cGVcclxuICAgICkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiByZXF1ZXN0KHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgICAgIHhoci5vcGVuKHJlcXVlc3RUeXBlLCByZXF1ZXN0UGF0aCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIGNvbnRlbnRUeXBlKTtcclxuICAgICAgICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uIGxvYWRDYXNlKCkge1xyXG4gICAgICAgICAgICAgICAgaWYoY29udGVudFR5cGUgPT09IFwiYXBwbGljYXRpb24vanNvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShKU09OLnBhcnNlKHhoci5yZXNwb25zZSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24gZXJyb3JDYXNlKCkge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KHhoci5zdGF0dXNUZXh0KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKHJlcXVlc3RCb2R5KSB7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2VuZChyZXF1ZXN0Qm9keSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2VuZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIERhdGFCYXNlQ29ubmVjdG9yLnByb3RvdHlwZS5sb25nUG9sbCA9IGZ1bmN0aW9uIGxvbmdQb2xsICh0YXJnZXRVcmwpIHtcclxuICAgICAgICB2YXIgeGh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB4aHR0cC5vcGVuKCdHRVQnLCB0YXJnZXRVcmwsIHRydWUpO1xyXG4gICAgICAgIHhodHRwLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsICd0ZXh0L2V2ZW50LXN0cmVhbScpO1xyXG4gICAgICAgIHJldHVybiB4aHR0cDtcclxuICAgIH07XHJcblxyXG4gICAgZGF0YUJhc2VDb25uZWN0b3IgPSBuZXcgRGF0YUJhc2VDb25uZWN0b3IoKTtcclxuICAgIHJldHVybiBkYXRhQmFzZUNvbm5lY3Rvci5zZXR1cERhdGFCYXNlQVBJKGRhdGFDb25uZWN0b3JDb25maWdPYmoudHlwZU9mUmVxdWVzdCk7XHJcblxyXG59KShkYXRhQ29ubmVjdG9yQ29uZmlnKTtcclxuLyogZXhwb3J0ZWQgZGF0YVNvdXJjZSAqL1xyXG4vKiBnbG9iYWwgbWFpbkNvbmZpZyAqL1xyXG4vKiBnbG9iYWwgZGF0YUJhc2VVcmwgKi9cclxuLyogZ2xvYmFsIGRhdGFDb25uZWN0b3IgKi9cclxuLy8g0JzQvtC00YPQu9GMINC00LvRjyDQv9C+0LvRg9GH0LXQvdC40Y8g0LTQsNC90L3Ri9GFXHJcbi8vINCS0YHQtSBBUEkg0YTRg9C90LrRhtC40Lgg0LLQvtC30LLRgNCw0YnQsNGO0YIg0L/RgNC+0LzQuNGB0YtcclxudmFyIGRhdGFTb3VyY2UgPSAoZnVuY3Rpb24gY3JlYXRlRGF0YVNvdXJjZSAoZGF0YUNvbm5lY3RvciwgY29uZmlnKSB7XHJcbiAgICB2YXIgZGF0YVNvdXJjZUluc3RhbmNlO1xyXG4gICAgdmFyIFVTRVJfTElTVCA9IFwidXNlckxpc3RcIjtcclxuICAgIHZhciBVU0VSX01FU1NBR0VTID0gXCJ1c2Vyc01lc3NhZ2VzXCI7XHJcbiAgICB2YXIgVVNFUlNfU0VUVElOR1MgPSBcInVzZXJzU2V0dGluZ3NcIjtcclxuICAgIHZhciBuZXdVc2VyRGF0YSA9IHtcclxuICAgICAgICBpc01pbmltaXplOiBmYWxzZSxcclxuICAgICAgICByZWFkTGFzdE1lc3NhZ2U6IHRydWVcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gRGF0YVNvdXJjZSgpIHt9XHJcblxyXG4gICAgZnVuY3Rpb24gbG9uZ1BvbGxDb25uZWN0IChkYXRhVHlwZSwgdXNlcklkKSB7XHJcbiAgICAgICAgdmFyIHJlcXVlc3RQYXRoID0gdGhpcy5jcmVhdGVSZXF1ZXN0UGF0aChkYXRhQmFzZVVybCwgdXNlcklkLCBudWxsLCBkYXRhVHlwZSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGFDb25uZWN0b3IuY3JlYXRlTG9uZ1BvbGxDb25uZWN0aW9uKHJlcXVlc3RQYXRoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBiYXNpY0Nvbm5lY3QgKGRhdGFUeXBlLCB1c2VySWQpIHtcclxuICAgICAgICB2YXIgcmVxdWVzdFBhdGggPSB0aGlzLmNyZWF0ZVJlcXVlc3RQYXRoKGRhdGFCYXNlVXJsLCB1c2VySWQsIG51bGwsIGRhdGFUeXBlKTtcclxuICAgICAgICByZXR1cm4gZGF0YUNvbm5lY3Rvci5yZXF1ZXN0LmJpbmQobnVsbCwgcmVxdWVzdFBhdGgsIG51bGwsIFwiR0VUXCIsIFwiYXBwbGljYXRpb24vanNvblwiKVxyXG4gICAgfVxyXG5cclxuICAgIERhdGFTb3VyY2UucHJvdG90eXBlLmNyZWF0ZVJlcXVlc3RQYXRoID0gZnVuY3Rpb24gY3JlYXRlUmVxdWVzdFBhdGgoXHJcbiAgICAgICAgZGF0YUJhc2VVUkwsXHJcbiAgICAgICAgdXNlcklkLFxyXG4gICAgICAgIHJlcXVlc3RQb3N0Zml4LFxyXG4gICAgICAgIHJlcXVlc3RQcmVmaXhcclxuICAgICkge1xyXG4gICAgICAgIHZhciBwYXRoID0gZGF0YUJhc2VVUkw7XHJcbiAgICAgICAgaWYocmVxdWVzdFByZWZpeCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBwYXRoICs9IFwiL1wiICsgcmVxdWVzdFByZWZpeFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodXNlcklkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gXCIvXCIgKyB1c2VySWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXF1ZXN0UG9zdGZpeCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBwYXRoICs9IFwiL1wiICsgcmVxdWVzdFBvc3RmaXg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhdGggKz0gXCIuanNvblwiO1xyXG4gICAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfTtcclxuXHJcbiAgICBEYXRhU291cmNlLnByb3RvdHlwZS5nZXRIVE1MID0gZnVuY3Rpb24gZ2V0SFRNTCAocmVxdWVzdFBhdGgpIHtcclxuICAgICAgICByZXR1cm4gZGF0YUNvbm5lY3Rvci5yZXF1ZXN0KFxyXG4gICAgICAgICAgICByZXF1ZXN0UGF0aCxcclxuICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgXCJHRVRcIiwgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCdcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgRGF0YVNvdXJjZS5wcm90b3R5cGUuc2V0RGF0YSA9IGZ1bmN0aW9uIHNldERhdGEgKGRhdGFUeXBlLCByZXF1ZXN0VHlwZSwgZmllbGROYW1lLCB1c2VySWQsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIHJlcXVlc3RQYXRoO1xyXG4gICAgICAgIGlmKHJlcXVlc3RUeXBlID09PSBcIlBVVFwiKSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RQYXRoID0gdGhpcy5jcmVhdGVSZXF1ZXN0UGF0aChkYXRhQmFzZVVybCwgdXNlcklkLCBmaWVsZE5hbWUsIGRhdGFUeXBlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXF1ZXN0UGF0aCA9IHRoaXMuY3JlYXRlUmVxdWVzdFBhdGgoZGF0YUJhc2VVcmwsIHVzZXJJZCwgbnVsbCwgZGF0YVR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGF0YUNvbm5lY3Rvci5yZXF1ZXN0KFxyXG4gICAgICAgICAgICByZXF1ZXN0UGF0aCxcclxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkodmFsdWUpLFxyXG4gICAgICAgICAgICByZXF1ZXN0VHlwZSxcclxuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICBEYXRhU291cmNlLnByb3RvdHlwZS5hZGROZXdVc2VyVG9EYXRhU291cmNlID0gZnVuY3Rpb24gYWRkTmV3VXNlclRvRGF0YVNvdXJjZSAodXNlcklkLCB1c2VyTmFtZSkge1xyXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGU7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIG5ld1VzZXJEYXRhLnVzZXJOYW1lID0gdXNlck5hbWU7XHJcbiAgICAgICAgT2JqZWN0LmtleXMobmV3VXNlckRhdGEpLm1hcChmdW5jdGlvbiBhZGROZXdTZXR0aW5ncyAoc2V0dGluZ05hbWUpIHtcclxuICAgICAgICAgICAgdGhhdC5zZXREYXRhKFVTRVJTX1NFVFRJTkdTLCBcIlBVVFwiLCBzZXR0aW5nTmFtZSwgdXNlcklkLCBuZXdVc2VyRGF0YVtzZXR0aW5nTmFtZV0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNldERhdGEoVVNFUl9MSVNULCBcIlBVVFwiLCBudWxsLCB1c2VySWQsIHtcImxhc3RPbmxpbmVcIjogZGF0ZS5nZXRUaW1lKCksIFwic2VuZE5ld01lc3NhZ2VcIjogZmFsc2V9KTtcclxuICAgIH07XHJcblxyXG4gICAgRGF0YVNvdXJjZS5wcm90b3R5cGUuZ2V0RGF0YVNvdXJjZUFQSSA9IGZ1bmN0aW9uIGdldERhdGFTb3VyY2VBUEkgKHR5cGVPZlJlcXVlc3QpIHtcclxuICAgICAgICBpZih0eXBlT2ZSZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jaGF0U2V0dGluZ3MudHlwZU9mUmVxdWVzdCA9IHR5cGVPZlJlcXVlc3Q7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGNvbmZpZy5jaGF0U2V0dGluZ3MudHlwZU9mUmVxdWVzdCA9PT0gXCJsb25nUG9sbFwiKSB7XHJcbiAgICAgICAgICAgIERhdGFTb3VyY2UucHJvdG90eXBlLmdldERhdGEgPSBsb25nUG9sbENvbm5lY3RcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBEYXRhU291cmNlLnByb3RvdHlwZS5nZXREYXRhID0gYmFzaWNDb25uZWN0XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHVzZXJzQVBJOiB7XHJcbiAgICAgICAgICAgICAgICBnZXRVc2VyTGlzdDogZGF0YVNvdXJjZUluc3RhbmNlLmdldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUl9MSVNUXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgZ2V0VXNlclNldHRpbmdzOiBkYXRhU291cmNlSW5zdGFuY2UuZ2V0RGF0YS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZSxcclxuICAgICAgICAgICAgICAgICAgICBVU0VSU19TRVRUSU5HU1xyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIGdldFVzZXJNZXNzYWdlczogZGF0YVNvdXJjZUluc3RhbmNlLmdldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUl9NRVNTQUdFU1xyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIGdldFNldHRpbmdGaWVsZDogZGF0YVNvdXJjZUluc3RhbmNlLmdldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUlNfU0VUVElOR1NcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZTogZGF0YVNvdXJjZUluc3RhbmNlLnNldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUl9NRVNTQUdFUyxcclxuICAgICAgICAgICAgICAgICAgICBcIlBPU1RcIlxyXG5cclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBzZXRTZXR0aW5nRmllbGQ6IGRhdGFTb3VyY2VJbnN0YW5jZS5zZXREYXRhLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZUluc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIFVTRVJTX1NFVFRJTkdTLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiUFVUXCJcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBhZGROZXdVc2VyVG9EYXRhU291cmNlOiBkYXRhU291cmNlSW5zdGFuY2UuYWRkTmV3VXNlclRvRGF0YVNvdXJjZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZVxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZUxhc3RPbmxpbmU6IGRhdGFTb3VyY2VJbnN0YW5jZS5zZXREYXRhLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZUluc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIFVTRVJfTElTVCxcclxuICAgICAgICAgICAgICAgICAgICBcIlBVVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwibGFzdE9ubGluZVwiXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlU2VuZE5ld01lc3NhZ2VGbGFnOiBkYXRhU291cmNlSW5zdGFuY2Uuc2V0RGF0YS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZSxcclxuICAgICAgICAgICAgICAgICAgICBVU0VSX0xJU1QsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJQVVRcIixcclxuICAgICAgICAgICAgICAgICAgICBcInNlbmROZXdNZXNzYWdlXCJcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVNZXNzYWdlSXNSZWFkRmllbGQ6IGRhdGFTb3VyY2VJbnN0YW5jZS5zZXREYXRhLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZUluc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIFVTRVJfTUVTU0FHRVMsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJQVVRcIlxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb21tb25BUEk6IHtcclxuICAgICAgICAgICAgICAgIGdldEhUTUw6IGRhdGFTb3VyY2VJbnN0YW5jZS5nZXRIVE1MLmJpbmQoZGF0YVNvdXJjZUluc3RhbmNlKSxcclxuICAgICAgICAgICAgICAgIGdldERhdGFTb3VyY2VBUEk6IGRhdGFTb3VyY2VJbnN0YW5jZS5nZXREYXRhU291cmNlQVBJLmJpbmQoZGF0YVNvdXJjZUluc3RhbmNlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgLy8g0KHQvtC30LTQsNC10LwgaW5zdGFuY2Ug0L7QsdGK0LXQutGC0LAsINC30LDQtNCw0LXQvCBBUElcclxuICAgIGRhdGFTb3VyY2VJbnN0YW5jZSA9IG5ldyBEYXRhU291cmNlKCk7XHJcblxyXG5cclxuXHJcbiAgICByZXR1cm4gZGF0YVNvdXJjZUluc3RhbmNlLmdldERhdGFTb3VyY2VBUEkoKTtcclxufSkoZGF0YUNvbm5lY3RvciwgbWFpbkNvbmZpZyk7XHJcblxyXG4vLyBldmVudEVtaXR0ZXJcclxuXHJcbi8qIGV4cG9ydGVkIGV2ZW50RW1pdHRlciAqL1xyXG52YXIgZXZlbnRFbWl0dGVyID0gKGZ1bmN0aW9uIGNyZWF0ZUV2ZW50RW1pdHRlciAoKSB7XHJcbiAgICBmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XHJcbiAgICAgICAgdGhpcy5ldmVudHMgPSB7fTtcclxuICAgIH1cclxuXHJcbiAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZFN1YnNjcmliZSA9IGZ1bmN0aW9uIGFkZFN1YnNjcmliZShldmVudE5hbWUsIGNhbGxiYWNrICkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICBpZiggIXRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gPSBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjayk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZVN1YnNjcmliZSAoKSB7XHJcbiAgICAgICAgICAgIHRoYXQuZXZlbnRzW2V2ZW50TmFtZV0gPSB0aGF0LmV2ZW50c1tldmVudE5hbWVdLmZpbHRlcihmdW5jdGlvbiByZW1vdmUgKGVsZW1lbnRDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnRDYWxsYmFjayAhPT0gY2FsbGJhY2tcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZW1vdmVTdWJzY3JpYmVcclxuICAgIH07XHJcblxyXG4gICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gZW1pdCAoZXZlbnROYW1lLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIGV2ZW50ID0gdGhpcy5ldmVudHNbZXZlbnROYW1lXTtcclxuICAgICAgICBpZiggZXZlbnQgKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LmZvckVhY2goZnVuY3Rpb24gaW52b2tlIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbChudWxsLCBkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG59KSgpO1xyXG4vKiBleHBvcnRlZCBsb25nUG9sbFJlc3BvbnNlUGFyc2VyICovXHJcbnZhciBsb25nUG9sbFJlc3BvbnNlUGFyc2VyID0gKGZ1bmN0aW9uIGNyZWF0ZUxvbmdQb2xsUmVzcG9uc2VQYXJzZXIoKSB7XHJcbiAgICB2YXIgdHlwZXNPZkNoYW5nZSA9IHtcclxuICAgICAgICBtZXNzYWdlOiAvbWVzc2FnZS8sXHJcbiAgICAgICAgdXNlckxpc3Q6IC9sYXN0T25saW5lLnsxLH1zZW5kTmV3TWVzc2FnZS8sXHJcbiAgICAgICAgbGFzdE9ubGluZTogL1wicGF0aFwiOlwiXFwvXFx3ezEsfVxcL2xhc3RPbmxpbmUvLFxyXG4gICAgICAgIHNlbmROZXdNZXNzYWdlOiAvXCJwYXRoXCI6XCJcXC9cXHd7MSx9XFwvc2VuZE5ld01lc3NhZ2UvLFxyXG4gICAgICAgIHNldHRpbmc6IC9yZWFkTGFzdE1lc3NhZ2UvLFxyXG4gICAgICAgIHJlYWQ6IC9yZWFkLyxcclxuICAgICAgICBnZXRJcDogL2dldElwLyxcclxuICAgICAgICBhc2tRdWVzdGlvbjogL2Fza1F1ZXN0aW9uL1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgZXZlbnRSZWd1bGFyID0gL2V2ZW50OiBwdXQvO1xyXG4gICAgdmFyIGhhc051bGxEYXRhID0gL2RhdGE6IG51bGwvO1xyXG4gICAgdmFyIGdldERhdGFSZWd1bGFyID0gL1wiLFwiZGF0YVwiOi87XHJcbiAgICB2YXIgaXRJc05ld01lc3NhZ2VSZWd1bGFyID0gL1wicGF0aFwiOlwiXFwvLS87XHJcbiAgICB2YXIgaXRJc05ld1VzZXJMaXN0UmVndWxhciA9IC9cImRhdGFcIjp7XCJsYXN0T25saW5lXCI6XFxkKyxcInNlbmROZXdNZXNzYWdlXCI6LztcclxuICAgIHZhciBpdElzRmlyc3RJcERhdGFSZWd1bGFyID0gL2RhdGE6IHtcInBhdGhcIjpcIlxcL1wiLFwiZGF0YVwiOntcImdldElwXCI6LztcclxuICAgIHZhciBpdElzRmlyc3RRdWVzdGlvbnNEYXRhID0gL2RhdGE6IHtcInBhdGhcIjpcIlxcL1wiLFwiZGF0YVwiOntcImFza1F1ZXN0aW9uXCI6LztcclxuICAgIHZhciBpdElzTmV3UXVlc3Rpb25zQ29tbWFuZCA9IC9kYXRhOiB7XCJwYXRoXCI6XCJcXC9hc2tRdWVzdGlvblwiLFwiZGF0YVwiOi87XHJcbiAgICB2YXIgaXRJc0ZpcnN0VXNlckxpc3RDb25uZWN0aW9uID0gdHJ1ZTtcclxuXHJcbiAgICBmdW5jdGlvbiBMb25nUG9sbFJlc3BvbnNlUGFyc2VyKCkge31cclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5nZXRUeXBlT2ZDaGFuZ2VzID0gZnVuY3Rpb24gZ2V0VHlwZU9mQ2hhbmdlcyhcclxuICAgICAgICBhbnN3ZXJEYXRhXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgdHlwZSA9IE9iamVjdC5rZXlzKHR5cGVzT2ZDaGFuZ2UpLmZpbHRlcihcclxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q3VycmVudFR5cGVPZkNoYW5nZSh0eXBlTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVzT2ZDaGFuZ2VbdHlwZU5hbWVdLnRlc3QoYW5zd2VyRGF0YSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHlwZU5hbWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gdHlwZVswXTtcclxuICAgIH07XHJcblxyXG4gICAgTG9uZ1BvbGxSZXNwb25zZVBhcnNlci5wcm90b3R5cGUucHJlcGFyZURhdGFCZWZvcmVKc29uUGFyc2UgPSBmdW5jdGlvbiBwcmVwYXJlRGF0YUJlZm9yZUpzb25QYXJzZShcclxuICAgICAgICByZXNwb25zZVxyXG4gICAgKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdXHJcbiAgICAgICAgICAgIC5zcGxpdChnZXREYXRhUmVndWxhcilbMV1cclxuICAgICAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgICAgICAuc2xpY2UoMCwgLTEpO1xyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5wYXJzZVVzZXJzTWVzc2FnZXMgPSBmdW5jdGlvbiBwYXJzZVVzZXJzTWVzc2FnZXMoXHJcbiAgICAgICAgcmVzcG9uc2UsXHJcbiAgICAgICAgY2hhbmdlVHlwZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcclxuICAgICAgICB2YXIgbWVzc2FnZUlkO1xyXG4gICAgICAgIHZhciByZXN1bHRPYmplY3QgPSB7fTtcclxuICAgICAgICBpZiAoY2hhbmdlVHlwZSA9PT0gXCJyZWFkXCIpIHtcclxuICAgICAgICAgICAgZGF0YS5pZCA9IHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoJ2RhdGE6IHtcInBhdGhcIjpcIi8nKVxyXG4gICAgICAgICAgICAgICAgLnBvcCgpXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoJy9yZWFkXCIsXCInKVxyXG4gICAgICAgICAgICAgICAgLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgIGRhdGEudmFsdWUgPSByZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXVxyXG4gICAgICAgICAgICAgICAgLnNwbGl0KCcvcmVhZFwiLFwiZGF0YVwiOicpXHJcbiAgICAgICAgICAgICAgICAucG9wKClcclxuICAgICAgICAgICAgICAgIC50cmltKClcclxuICAgICAgICAgICAgICAgIC5zbGljZSgwLCAtMSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWl0SXNOZXdNZXNzYWdlUmVndWxhci50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGaXJzdERhdGEocmVzcG9uc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtZXNzYWdlSWQgPSByZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXVxyXG4gICAgICAgICAgICAuc3BsaXQoJ2RhdGE6IHtcInBhdGhcIjpcIi8nKVxyXG4gICAgICAgICAgICAucG9wKClcclxuICAgICAgICAgICAgLnNwbGl0KGdldERhdGFSZWd1bGFyKVxyXG4gICAgICAgICAgICAuc2hpZnQoKTtcclxuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZSh0aGlzLnByZXBhcmVEYXRhQmVmb3JlSnNvblBhcnNlKHJlc3BvbnNlKSk7XHJcbiAgICAgICAgcmVzdWx0T2JqZWN0W21lc3NhZ2VJZF0gPSBkYXRhO1xyXG4gICAgICAgIHJldHVybiByZXN1bHRPYmplY3Q7XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLmhhc05ld0RhdGEgPSBmdW5jdGlvbiBoYXNOZXdEYXRhKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgIWhhc051bGxEYXRhLnRlc3QocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0pICYmIHJlc3BvbnNlLmxlbmd0aCA+IDFcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5wYXJzZVVzZXJMaXN0ID0gZnVuY3Rpb24gcGFyc2VVc2VyTGlzdChcclxuICAgICAgICByZXNwb25zZSxcclxuICAgICAgICBjaGFuZ2VUeXBlXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHt9O1xyXG4gICAgICAgIHZhciB1c2VySWQ7XHJcbiAgICAgICAgaWYgKGl0SXNGaXJzdFVzZXJMaXN0Q29ubmVjdGlvbikge1xyXG4gICAgICAgICAgICBpdElzRmlyc3RVc2VyTGlzdENvbm5lY3Rpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Rmlyc3REYXRhKHJlc3BvbnNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGl0SXNOZXdVc2VyTGlzdFJlZ3VsYXIudGVzdChyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXSkpIHtcclxuICAgICAgICAgICAgdXNlcklkID0gdGhpcy5nZXRVc2VySWQocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0sIG51bGwpO1xyXG4gICAgICAgICAgICBkYXRhW3VzZXJJZF0gPSB0aGlzLmdldEZpcnN0RGF0YShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShcclxuICAgICAgICAgICAgcmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV1cclxuICAgICAgICAgICAgICAgIC5zcGxpdChnZXREYXRhUmVndWxhcilbMV1cclxuICAgICAgICAgICAgICAgIC50cmltKClcclxuICAgICAgICAgICAgICAgIC5zbGljZSgwLCAtMSlcclxuICAgICAgICApO1xyXG4gICAgICAgIHVzZXJJZCA9IHRoaXMuZ2V0VXNlcklkKHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdLCBjaGFuZ2VUeXBlKTtcclxuICAgICAgICByZXR1cm4gW3VzZXJJZCwgZGF0YV07XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLmdldEZpcnN0RGF0YSA9IGZ1bmN0aW9uIGdldEZpcnN0RGF0YShcclxuICAgICAgICByZXNwb25zZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGpzb25EYXRhO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGpzb25EYXRhID0gSlNPTi5wYXJzZSh0aGlzLnByZXBhcmVEYXRhQmVmb3JlSnNvblBhcnNlKHJlc3BvbnNlKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBqc29uRGF0YTtcclxuICAgICAgICB9IGNhdGNoIChleGNlcHRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5nZXRVc2VySWQgPSBmdW5jdGlvbiBnZXRVc2VySWQoXHJcbiAgICAgICAgcmVzcG9uc2UsXHJcbiAgICAgICAgY2hhbmdlVHlwZVxyXG4gICAgKSB7XHJcbiAgICAgICAgaWYgKGNoYW5nZVR5cGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoY2hhbmdlVHlwZSlcclxuICAgICAgICAgICAgICAgIC5zaGlmdCgpXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoJ2RhdGE6IHtcInBhdGhcIjpcIi8nKVxyXG4gICAgICAgICAgICAgICAgLnBvcCgpXHJcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgLTEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoJ2RhdGE6IHtcInBhdGhcIjpcIi8nKVxyXG4gICAgICAgICAgICAgICAgLnBvcCgpXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoXCIsXCIpWzBdXHJcbiAgICAgICAgICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgLTEpO1xyXG5cclxuICAgIH07XHJcblxyXG4gICAgTG9uZ1BvbGxSZXNwb25zZVBhcnNlci5wcm90b3R5cGUucGFyc2VDb21tYW5kQW5zd2VyID0gZnVuY3Rpb24gcGFyc2VDb21tYW5kQW5zd2VyKFxyXG4gICAgICAgIHJlc3BvbnNlXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgZGF0YTtcclxuICAgICAgICB2YXIgaXBEYXRhO1xyXG4gICAgICAgIHZhciBhc2tRdWVzdGlvbkRhdGE7XHJcbiAgICAgICAgdmFyIGl0SXNJUEluZm9ybWF0aW9uID0gL2dldElwLy50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKTtcclxuICAgICAgICB2YXIgaXRJc1F1ZXN0aW9uc0luZm9ybWF0aW9uID0gL2Fza1F1ZXN0aW9uLy50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKTtcclxuXHJcbiAgICAgICAgaWYoaXRJc0lQSW5mb3JtYXRpb24gJiYgaXRJc1F1ZXN0aW9uc0luZm9ybWF0aW9uKSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSByZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXS5zcGxpdCgvZGF0YToge1wicGF0aFwiOlwiXFwvXCIsXCJkYXRhXCI6LykucG9wKCkuc3BsaXQoXCJ9LFwiKTtcclxuICAgICAgICAgICAgYXNrUXVlc3Rpb25EYXRhID0gSlNPTi5wYXJzZShkYXRhWzBdKyBcIn19XCIpO1xyXG4gICAgICAgICAgICBpcERhdGEgPSBKU09OLnBhcnNlKFwie1wiICsgZGF0YVsxXS50cmltKCkuc2xpY2UoMCwtMSkpO1xyXG4gICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgYXNrUXVlc3Rpb25EYXRhLFxyXG4gICAgICAgICAgICAgICAgaXBEYXRhXHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9IGVsc2UgaWYgKGl0SXNJUEluZm9ybWF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlVXNlcklwRGF0YShyZXNwb25zZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChpdElzUXVlc3Rpb25zSW5mb3JtYXRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VRdWVzdGlvbnNEYXRhKHJlc3BvbnNlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLnBhcnNlVXNlcklwRGF0YSA9IGZ1bmN0aW9uIHBhcnNlVXNlcklwRGF0YShcclxuICAgICAgICByZXNwb25zZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgaWYoaXRJc0ZpcnN0SXBEYXRhUmVndWxhci50ZXN0KHJlc3BvbnNlKSkge1xyXG4gICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXS5zcGxpdChpdElzRmlyc3RJcERhdGFSZWd1bGFyKS5wb3AoKS50cmltKCkuc2xpY2UoMCwtMikpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdLnNwbGl0KGV2ZW50UmVndWxhcikucG9wKCkuc3BsaXQoXCJkYXRhOiB7XFxcInBhdGhcXFwiOlxcXCIvZ2V0SXBcXFwiLFxcXCJkYXRhXFxcIjpcIikucG9wKCkudHJpbSgpLnNsaWNlKDAsLTEpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLnBhcnNlUXVlc3Rpb25zRGF0YSA9IGZ1bmN0aW9uIHBhcnNlUXVlc3Rpb25zRGF0YShcclxuICAgICAgICByZXNwb25zZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgaWYoaXRJc0ZpcnN0UXVlc3Rpb25zRGF0YS50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKSkge1xyXG4gICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXS5zcGxpdChpdElzRmlyc3RRdWVzdGlvbnNEYXRhKS5wb3AoKS50cmltKCkuc2xpY2UoMCwtMikpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaXRJc05ld1F1ZXN0aW9uc0NvbW1hbmQudGVzdChyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXSkpIHtcclxuICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0uc3BsaXQoaXRJc05ld1F1ZXN0aW9uc0NvbW1hbmQpLnBvcCgpLnRyaW0oKS5zbGljZSgwLC0xKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoXCJ7XFxcImFza1F1ZXN0aW9uXFxcIjp7XFxcIlwiICsgcmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0uc3BsaXQoXCJkYXRhOiB7XFxcInBhdGhcXFwiOlxcXCIvYXNrUXVlc3Rpb24vXCIpLnBvcCgpLnJlcGxhY2UoXCJcXFwiLFxcXCJkYXRhXFxcIlwiLCBcIlxcXCJcIikgKyBcIn1cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlKHRleHQpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gdGV4dC5zcGxpdChldmVudFJlZ3VsYXIpO1xyXG4gICAgICAgIHZhciBjaGFuZ2VUeXBlID0gdGhpcy5nZXRUeXBlT2ZDaGFuZ2VzKHJlc3VsdFtyZXN1bHQubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgIHZhciByZXN1bHRPZlBhcnNlID0geyB0eXBlOiBjaGFuZ2VUeXBlIH07XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzTmV3RGF0YShyZXN1bHQpKSB7XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2VUeXBlID09PSBcIm1lc3NhZ2VcIiB8fCBjaGFuZ2VUeXBlID09PSBcInJlYWRcIikge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0T2ZQYXJzZS5vYmplY3QgPSB0aGlzLnBhcnNlVXNlcnNNZXNzYWdlcyhyZXN1bHQsIGNoYW5nZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdE9mUGFyc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VUeXBlID09PSBcInNlbmROZXdNZXNzYWdlXCIgfHxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVR5cGUgPT09IFwibGFzdE9ubGluZVwiIHx8XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VUeXBlID09PSBcInVzZXJMaXN0XCJcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRPZlBhcnNlLm9iamVjdCA9IHRoaXMucGFyc2VVc2VyTGlzdChyZXN1bHQsIGNoYW5nZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdE9mUGFyc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbmdlVHlwZSA9PT0gXCJnZXRJcFwiIHx8IGNoYW5nZVR5cGUgPT09IFwiYXNrUXVlc3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICByZXN1bHRPZlBhcnNlLm9iamVjdCA9IHRoaXMucGFyc2VDb21tYW5kQW5zd2VyKHJlc3VsdCwgY2hhbmdlVHlwZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0T2ZQYXJzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgTG9uZ1BvbGxSZXNwb25zZVBhcnNlcigpO1xyXG59KSgpO1xyXG5cclxuLy8gaW5zdHJ1Y3Rpb25zXHJcblxyXG52YXIgaW5zdHJ1Y3Rpb25QZXJmb3JtZXIgPSAoZnVuY3Rpb24gKGNvbmZpZywgZGF0YUNvbm5lY3RvciwgcGFyc2VyKSB7XHJcblxyXG4gICAgdmFyIGluc3RydWN0aW9ucyA9IHtcclxuICAgICAgICBnZXRJcDogZ2V0VXNlcklQLFxyXG4gICAgICAgIGFza1F1ZXN0aW9uOiBzaG93UXVlc3Rpb25cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHF1ZXN0aW9uTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgdmFyIGluc3RydWN0aW9uc1F1ZXVlID0gW107XHJcblxyXG4gICAgZnVuY3Rpb24gZXhlY3V0ZUNvbW1hbmQgKGluc3RydWN0aW9uTmFtZSwgZGF0YSwgdHlwZU9mQ29tbWFuZCwgY2FsbGJhY2ssIGNvbnRleHQsIGlzTmVlZE5vdGlmeSkge1xyXG4gICAgICAgIHZhciBwZXJmb3JtZXJPYmplY3QgPSBpbnN0cnVjdGlvbnNbaW5zdHJ1Y3Rpb25OYW1lXS5jYWxsKG51bGwsIGRhdGEsIGluc3RydWN0aW9uTmFtZSwgY2FsbGJhY2ssIGNvbnRleHQsIGlzTmVlZE5vdGlmeSk7XHJcbiAgICAgICAgaWYodHlwZU9mQ29tbWFuZCA9PT0gXCJhc3luY1wiKSB7XHJcbiAgICAgICAgICAgIHBlcmZvcm1lck9iamVjdC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uc0NhbGxiYWNrKGluc3RydWN0aW9uTmFtZSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldElQICgpIHtcclxuICAgICAgICByZXR1cm4gZGF0YUNvbm5lY3Rvci5yZXF1ZXN0KFxyXG4gICAgICAgICAgICBcImh0dHBzOi8vZ2VvaXAtZGIuY29tL2pzb24vXCIsXHJcbiAgICAgICAgICAgIG51bGwsXHJcbiAgICAgICAgICAgIFwiR0VUXCIsXHJcbiAgICAgICAgICAgIFwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiXHJcbiAgICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNhdmVSZXN1bHQoZGF0YSwgZGF0YU5hbWUpIHtcclxuICAgICAgICB2YXIgdXNlciA9IGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZDtcclxuICAgICAgICByZXR1cm4gZGF0YUNvbm5lY3Rvci5yZXF1ZXN0KFxyXG4gICAgICAgICAgICBcImh0dHBzOi8vb25saW5lY29uc3VsdGFudHdlYmFwcC5maXJlYmFzZWlvLmNvbS91c2Vyc1NldHRpbmdzL1wiICsgdXNlciArIFwiL1wiICsgZGF0YU5hbWUgKyBcIi5qc29uXCIsXHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIFwiUFVUXCIsXHJcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFVzZXJJUCgpIHtcclxuICAgICAgICByZXR1cm4gZ2V0SVAoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzYXZlUmVzdWx0KGRhdGEsIFwiY29tbWFuZHNSZXNwb25zZS9nZXRJcFwiKVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYmFzaWNRdWVzdGlvbkNhbGxiYWNrIChpbnN0cnVjdGlvbk5hbWUsIGRhdGEpIHtcclxuICAgICAgICB2YXIgaW5wdXRWYWx1ZSA9ICBnZXRFbGVtZW50KFxyXG4gICAgICAgICAgICBjb25maWcuRE9NLlVTRVJfTkFNRV9JTlBVVF9DTEFTU1xyXG4gICAgICAgICkudmFsdWU7XHJcbiAgICAgICAgdmFyIGlucHV0RGF0YSA9IEpTT04uc3RyaW5naWZ5KGlucHV0VmFsdWUpO1xyXG4gICAgICAgIHNhdmVSZXN1bHQoaW5wdXREYXRhLCBcImNvbW1hbmRzUmVzcG9uc2UvXCIgKyBpbnN0cnVjdGlvbk5hbWUgKyBcIi9cIiArIGRhdGFbMV0pXHJcbiAgICB9XHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIHRvZ2dsZVF1ZXN0aW9uTWVudVZpc2libGUgKCkge1xyXG4gICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5BVVRIT1JJWkFUSU9OX01FTlVfQ0xBU1MpLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgIGNvbmZpZy5JTlZJU0lCTEVfQ0xBU1NcclxuICAgICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2hvd1F1ZXN0aW9uKGRhdGEsIGluc3RydWN0aW9uTmFtZSwgY2FsbGJhY2ssIGNvbnRleHQsIGlzTmVlZE5vdGlmeSkge1xyXG4gICAgICAgIHZhciBiaW5kQ2FsbGJhY2s7XHJcbiAgICAgICAgdmFyIGZ1bGxDYWxsYmFjaztcclxuICAgICAgICBpZihjYWxsYmFjaykge1xyXG4gICAgICAgICAgICBiaW5kQ2FsbGJhY2sgPSBjYWxsYmFjay5iaW5kKGNvbnRleHQsIGluc3RydWN0aW9uTmFtZSwgZGF0YSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYmluZENhbGxiYWNrID0gYmFzaWNRdWVzdGlvbkNhbGxiYWNrLmJpbmQoY29udGV4dCwgaW5zdHJ1Y3Rpb25OYW1lLCBkYXRhKVxyXG4gICAgICAgIH1cclxuICAgICAgICBmdWxsQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGJpbmRDYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB0b2dnbGVRdWVzdGlvbk1lbnVWaXNpYmxlKCk7XHJcbiAgICAgICAgICAgIGlmKGlzTmVlZE5vdGlmeSkge1xyXG4gICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb25zQ2FsbGJhY2soaW5zdHJ1Y3Rpb25OYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc2V0dXBRdWVzdGlvbk1lbnUoZGF0YSk7XHJcbiAgICAgICAgaWYocXVlc3Rpb25MaXN0ZW5lcikge1xyXG4gICAgICAgICAgICByZW1vdmVQcmV2aW91c1F1ZXN0aW9uTGlzdGVuZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcXVlc3Rpb25MaXN0ZW5lciA9IGdldEFuc3dlck9uUXVlc3Rpb24uYmluZChudWxsLCBmdWxsQ2FsbGJhY2spO1xyXG4gICAgICAgIHNldHVwTmV3UXVlc3Rpb25MaXN0ZW5lcigpO1xyXG4gICAgICAgIHRvZ2dsZVF1ZXN0aW9uTWVudVZpc2libGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzZXR1cFF1ZXN0aW9uTWVudShkYXRhKSB7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLkNIQVRfUVVFU1RJT05fQ1NTKS5pbm5lckhUTUwgPSBkYXRhWzFdO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNldHVwTmV3UXVlc3Rpb25MaXN0ZW5lcigpIHtcclxuICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uU0VORF9VU0VSX05BTUVfQlVUVE9OKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcXVlc3Rpb25MaXN0ZW5lcilcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZW1vdmVQcmV2aW91c1F1ZXN0aW9uTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFTkRfVVNFUl9OQU1FX0JVVFRPTikucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHF1ZXN0aW9uTGlzdGVuZXIpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0QW5zd2VyT25RdWVzdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICBjYWxsYmFjaygpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW5zdHJ1Y3Rpb25zQ2FsbGJhY2soa2V5KSB7XHJcbiAgICAgICAgbm90aWZ5KGtleSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNoZWNrQXZhaWxhYmlsaXR5TmV3SW5zdHJ1Y3Rpb25zKCk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjaGVja0F2YWlsYWJpbGl0eU5ld0luc3RydWN0aW9ucyAoKSB7XHJcbiAgICAgICAgdmFyIGtleU9mQ29tbWFuZHM7XHJcbiAgICAgICAgdmFyIHBhcmFtZXRlcnM7XHJcbiAgICAgICAgdmFyIGtleTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZGF0YUNvbm5lY3Rvci5yZXF1ZXN0KFxyXG4gICAgICAgICAgICAgICAgY29uZmlnLkNPTU1BTkRfUEFUSF9QUkVGSVggKyBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQgKyBcIi9jb21tYW5kcy5qc29uXCIsXHJcbiAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgXCJHRVRcIixcclxuICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgICAgICkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAga2V5T2ZDb21tYW5kcyA9IGhhc0luc3RydWN0aW9uS2V5KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgaWYoa2V5T2ZDb21tYW5kcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5ID0ga2V5T2ZDb21tYW5kcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzID0gZ2V0UGFyYW1ldGVycyhkYXRhW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uUGVyZm9ybWVyLmV4ZWN1dGUoa2V5LCBwYXJhbWV0ZXJzLCBkYXRhW2tleV0udHlwZU9mQ29tbWFuZCwgbnVsbCwgbnVsbCwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tBdmFpbGFiaWxpdHlOZXdJbnN0cnVjdGlvbnMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LGNvbmZpZy5VUERBVEVfVVNFUl9EQVRBX1RJTUUpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0UGFyYW1ldGVycyhjb21tYW5kRGF0YSkge1xyXG4gICAgICAgIHZhciBwYXJhbWV0ZXJzID0gW107XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgZm9yKGkgPSAwOyBpIDwgY29tbWFuZERhdGEucGFyYW1ldGVyc051bWJlcjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHBhcmFtZXRlcnMucHVzaChjb21tYW5kRGF0YVtcInBhcmFtZXRlclwiICsgaV0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJhbWV0ZXJzO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGhhc0luc3RydWN0aW9uS2V5KGNvbW1hbmRzKSB7XHJcbiAgICAgICAgaWYoIWNvbW1hbmRzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGNvbW1hbmRzKS5maWx0ZXIoZnVuY3Rpb24gKGNvbW1hbmRPYmplY3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuICFjb21tYW5kc1tjb21tYW5kT2JqZWN0XS5pc0V4ZWN1dGU7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBub3RpZnkgKHBhdGhPZk5vdGlmeSkge1xyXG4gICAgICAgIHJldHVybiBkYXRhQ29ubmVjdG9yLnJlcXVlc3QoXHJcbiAgICAgICAgICAgIGNvbmZpZy5DT01NQU5EX1BBVEhfUFJFRklYICsgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkICsgXCIvY29tbWFuZHMvXCIgKyBwYXRoT2ZOb3RpZnkgKyBcIi9pc0V4ZWN1dGUuanNvblwiLFxyXG4gICAgICAgICAgICB0cnVlLFxyXG4gICAgICAgICAgICBcIlBVVFwiLFxyXG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2V0dXBMb25nUG9sbENvbm5lY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjb25uZWN0aW9uID0gZGF0YUNvbm5lY3Rvci5jcmVhdGVMb25nUG9sbENvbm5lY3Rpb24oXHJcbiAgICAgICAgICAgIGNvbmZpZy5DT01NQU5EX1BBVEhfUFJFRklYICsgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkICsgXCIvY29tbWFuZHMuanNvblwiXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25uZWN0aW9uLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uIGNvbW1hbmRDaGFuZ2VDYWxsYmFjayAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSAzICYmIHRoaXMuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgIGRhdGEgPSBwYXJzZXIucGFyc2UodGhpcy5yZXNwb25zZVRleHQpLm9iamVjdDtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihkYXRhIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChpbnN0cnVjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGluc3RydWN0aW9ucykubWFwKGZ1bmN0aW9uIChpbnN0cnVjdGlvbk5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighaW5zdHJ1Y3Rpb25zW2luc3RydWN0aW9uTmFtZV0uaXNFeGVjdXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uc1F1ZXVlLnB1c2goaW5zdHJ1Y3Rpb25zW2luc3RydWN0aW9uTmFtZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uc1F1ZXVlLnB1c2goZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGluc3RydWN0aW9uc1F1ZXVlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBrZXlPZkNvbW1hbmRzID0gaGFzSW5zdHJ1Y3Rpb25LZXkoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYoa2V5T2ZDb21tYW5kcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGtleSA9IGtleU9mQ29tbWFuZHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHBhcmFtZXRlcnMgPSBnZXRQYXJhbWV0ZXJzKGRhdGFba2V5XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGluc3RydWN0aW9uUGVyZm9ybWVyLmV4ZWN1dGUoa2V5LCBwYXJhbWV0ZXJzLCBkYXRhW2tleV0udHlwZU9mQ29tbWFuZCwgbnVsbCwgbnVsbCwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICAvLyBsb2dFbGVtZW50LmlubmVySFRNTCA9IEpTT04uc3RyaW5naWZ5KGRhdGEub2JqZWN0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZ2V0UGFyYW1ldGVycyhkYXRhKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coa2V5T2ZDb21tYW5kcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbm5lY3Rpb24uc2VuZCgpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBleGVjdXRlOiBleGVjdXRlQ29tbWFuZCxcclxuICAgICAgICBzZXR1cDogY2hlY2tBdmFpbGFiaWxpdHlOZXdJbnN0cnVjdGlvbnMsXHJcbiAgICAgICAgc2V0dXBMb25nUG9sbENvbm5lY3Rpb246IHNldHVwTG9uZ1BvbGxDb25uZWN0aW9uXHJcbiAgICB9O1xyXG5cclxufSkobWFpbkNvbmZpZywgZGF0YUNvbm5lY3RvciwgbG9uZ1BvbGxSZXNwb25zZVBhcnNlcik7XHJcblxyXG4vLyBtZXNzYWdlTWFuYWdlclxyXG5cclxuLyogZ2xvYmFsIGdldEVsZW1lbnQgKi9cclxuLyogZ2xvYmFsIG1haW5Db25maWcgKi9cclxuLyogZXhwb3J0ZWQgbWVzc2FnZUxpc3RNYW5hZ2VyICovXHJcbi8vINCc0L7QtNGD0LvRjCDQtNC70Y8g0YDQsNCx0L7RgtGLINGB0L4g0YHQv9C40YHQutC+0Lwg0YHQvtC+0LHRidC10L3QuNC5INCe0JTQndCe0JPQniDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y9cclxudmFyIG1lc3NhZ2VMaXN0TWFuYWdlciA9IChmdW5jdGlvbiBzZXR1cE1lc3NhZ2VMaXN0TWFuYWdlciAoY29uZmlnKSB7XHJcbiAgICAvLyAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgLy8g0KTQvtGA0LzQsNGCICBtZXNzYWdlTGlzdCA9IFtcclxuICAgIC8vICAgIHtcclxuICAgIC8vICAgICAgIHNlbmRlcjogc2VuZGVyXHJcbiAgICAvLyAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxyXG4gICAgLy8gICAgICAgcmVhZDogdHJ1ZS9mYWxzZVxyXG4gICAgLy8gICAgICAgZGF0ZTogZGF0ZVxyXG4gICAgLy8gICAgfSxcclxuICAgIC8vIF1cclxuICAgIC8vIHJlYWQgLSDQsdGL0LvQviDQu9C4INC/0YDQvtGH0LjRgtCw0L3QviDRgdC+0L7QsdGJ0LXQvdC40LVcclxuICAgIC8vICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgZnVuY3Rpb24gTWVzc2FnZUxpc3RNYW5hZ2VyKCkge31cclxuXHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLnNldHVwID0gZnVuY3Rpb24gc2V0dXAgKCkge1xyXG4gICAgICAgIHRoaXMubWVzc2FnZUxpc3QgPSBbXTtcclxuICAgICAgICB0aGlzLmNET00gPSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VzQmxvY2s6IGdldEVsZW1lbnQoXHJcbiAgICAgICAgICAgICAgICBjb25maWcubWVzc2FnZXMuQ1NTX0NIQVRfTUVTU0FHRVNfQ09OVEFJTkVSXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICB9O1xyXG5cclxuICAgIH07XHJcblxyXG4gICAgLy8gV09SSyBXSVRIIE1FU1NBR0UgRUxFTUVOVCAvL1xyXG5cclxuICAgIC8vINCh0L7Qt9C00LDQtdGCIERPTSDRjdC70LXQvNC10L3RgiDRgdC+0L7QsdGJ0LXQvdC40Y8g0LTQu9GPINC+0YLQvtCx0YDQsNC20LXQvdC40Y8g0L3QsCDRjdC60YDQsNC90LVcclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUuY3JlYXRlTWVzc2FnZUVsZW1lbnQgPSBmdW5jdGlvbiBjcmVhdGVNZXNzYWdlRWxlbWVudChcclxuICAgICAgICBtZXNzYWdlLFxyXG4gICAgICAgIG1lc3NhZ2VEYXRlLFxyXG4gICAgICAgIHNlbmRlcixcclxuICAgICAgICBpc1JlYWRcclxuICAgICkge1xyXG4gICAgICAgIHZhciBtZXNzYWdlQ29udGFpbmVyRGl2ID0gdGhpcy5jcmVhdGVNZXNzYWdlQ29udGFpbmVyRGl2KGlzUmVhZCwgc2VuZGVyKTtcclxuICAgICAgICB2YXIgbWVzc2FnZURhdGVEaXYgPSB0aGlzLmNyZWF0ZURpdkZvck1lc3NhZ2VCbG9jayhcclxuICAgICAgICAgICAgbWVzc2FnZURhdGUsXHJcbiAgICAgICAgICAgIGNvbmZpZy5ESVNQTEFZX01FU1NBR0VfREFURSxcclxuICAgICAgICAgICAgW2NvbmZpZy5tZXNzYWdlcy5DU1NfQ0hBVF9NRVNTQUdFX0RBVEVdXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgdmFyIG1lc3NhZ2VTZW5kZXJEaXYgPSB0aGlzLmNyZWF0ZURpdkZvck1lc3NhZ2VCbG9jayhcclxuICAgICAgICAgICAgc2VuZGVyLFxyXG4gICAgICAgICAgICBjb25maWcuRElTUExBWV9TRU5ERVJfTkFNRSxcclxuICAgICAgICAgICAgW2NvbmZpZy5tZXNzYWdlcy5DU1NfQ0hBVF9NRVNTQUdFX1NFTkRFUl9OQU1FXVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHZhciBtZXNzYWdlRGl2ID0gdGhpcy5jcmVhdGVEaXZGb3JNZXNzYWdlQmxvY2soXHJcbiAgICAgICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgICAgIGNvbmZpZy5ESVNQTEFZX01FU1NBR0UsXHJcbiAgICAgICAgICAgIFtjb25maWcubWVzc2FnZXMuQ1NTX0NIQVRfTUVTU0FHRV1cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBtZXNzYWdlQ29udGFpbmVyRGl2LmFwcGVuZENoaWxkKG1lc3NhZ2VEYXRlRGl2KTtcclxuICAgICAgICBtZXNzYWdlQ29udGFpbmVyRGl2LmFwcGVuZENoaWxkKG1lc3NhZ2VTZW5kZXJEaXYpO1xyXG4gICAgICAgIG1lc3NhZ2VDb250YWluZXJEaXYuYXBwZW5kQ2hpbGQobWVzc2FnZURpdik7XHJcblxyXG4gICAgICAgIHJldHVybiBtZXNzYWdlQ29udGFpbmVyRGl2O1xyXG4gICAgfTtcclxuXHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLmdldE1lc3NhZ2VPYmplY3RzRm9yTWFya0FzUmVhZCA9IGZ1bmN0aW9uICBnZXRNZXNzYWdlT2JqZWN0c0Zvck1hcmtBc1JlYWQgKCkge1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIHZhciBtZXNzYWdlc0lzUmVhZCA9IFtdO1xyXG4gICAgICAgIHZhciB1c2VyTmFtZSA9IGNvbmZpZy5BRE1JTl9OQU1FIHx8IGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lO1xyXG4gICAgICAgIHZhciB1c2VySWQgPSBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQ7XHJcbiAgICAgICAgZm9yKGkgPSB0aGlzLm1lc3NhZ2VMaXN0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMubWVzc2FnZUxpc3RbaV0uc2VuZGVyICE9PSB1c2VyTmFtZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoIXRoaXMubWVzc2FnZUxpc3RbaV0ucmVhZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzSXNSZWFkLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGROYW1lOiB0aGlzLm1lc3NhZ2VMaXN0W2ldLmlkICsgXCIvcmVhZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRWYWx1ZTogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VMaXN0W2ldLnJlYWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWVzc2FnZXNJc1JlYWQ7XHJcbiAgICB9O1xyXG5cclxuXHJcblxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS5jcmVhdGVNZXNzYWdlQ29udGFpbmVyRGl2ID0gZnVuY3Rpb24gY3JlYXRlTWVzc2FnZUNvbnRhaW5lckRpdiAoaXNSZWFkLCBzZW5kZXIpIHtcclxuICAgICAgICB2YXIgbWVzc2FnZUNvbnRhaW5lckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lckRpdi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5tZXNzYWdlcy5DU1NfTUVTU0FHRV9DT05UQUlORVIpO1xyXG4gICAgICAgIGlmICghaXNSZWFkICYmIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lICE9PSBzZW5kZXIpIHtcclxuICAgICAgICAgICAgbWVzc2FnZUNvbnRhaW5lckRpdi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5tZXNzYWdlcy5DU1NfVVNFUl9OT1RfUkVBRF9NRVNTQUdFUyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtZXNzYWdlQ29udGFpbmVyRGl2O1xyXG4gICAgfTtcclxuXHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLmNyZWF0ZURpdkZvck1lc3NhZ2VCbG9jayA9IGZ1bmN0aW9uIGNyZWF0ZURpdkZvck1lc3NhZ2VCbG9jayAodGV4dCwgaXNEaXNwbGF5LCBzdHlsZUNsYXNzZXMpIHtcclxuICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBzdHlsZUNsYXNzZXMuZm9yRWFjaChmdW5jdGlvbiBjbGFzc0FkZCAoc3R5bGUpIHtcclxuICAgICAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoc3R5bGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRpdi5pbm5lckhUTUwgPSB0ZXh0O1xyXG4gICAgICAgIHJldHVybiBkaXY7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFdPUksgV0lUSCBNRVNTQUdFIEVMRU1FTlQgLy9cclxuXHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLmNyZWF0ZU1lc3NhZ2VMaXN0ID0gZnVuY3Rpb24gY3JlYXRlTWVzc2FnZUxpc3QgKG1lc3NhZ2VPYmplY3RzKSAge1xyXG4gICAgICAgIHZhciBuZXdNZXNzYWdlTGlzdCA9IFtdO1xyXG4gICAgICAgIGlmKG1lc3NhZ2VPYmplY3RzKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VPYmplY3RzLmZvckVhY2goZnVuY3Rpb24gYWRkRWxlbWVudFRvTWVzc2FnZUxpc3QgKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIG5ld01lc3NhZ2VMaXN0LnB1c2goZWxlbWVudCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3TWVzc2FnZUxpc3Q7XHJcbiAgICB9O1xyXG5cclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUudXBkYXRlTWVzc2FnZUxpc3QgPSBmdW5jdGlvbiB1cGRhdGVNZXNzYWdlTGlzdCAobmV3TWVzc2FnZUxpc3QpIHtcclxuICAgICAgICBpZih0aGlzLmdldE1lc3NhZ2VPYmplY3RzRm9yTWFya0FzUmVhZCgpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MucmVhZExhc3RNZXNzYWdlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubWVzc2FnZUxpc3QgPSBuZXdNZXNzYWdlTGlzdDtcclxuICAgICAgICB0aGlzLmRpc3BsYXlNZXNzYWdlcygpO1xyXG4gICAgfTtcclxuXHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLmFkZE1lc3NhZ2VUb01lc3NhZ2VMaXN0ID0gZnVuY3Rpb24gYWRkTWVzc2FnZVRvTWVzc2FnZUxpc3QgKFxyXG4gICAgICAgIG1lc3NhZ2VPYmpcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMubWVzc2FnZUxpc3QucHVzaChtZXNzYWdlT2JqKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8g0J/QtdGA0LXQsdC40YDQsNC10YIg0YHQv9C40YHQvtC6INGB0L7QvtCx0YnQtdC90LjQuSwg0YHQvtC30LTQsNC10YIg0YHQvtC+0YLQstC10YLRgdCy0YPRjtGJ0LjQtSDQuNC8IERPTSDRjdC70LXQvNC10L3RgtGLINC4INCy0YHRgtCw0LLQu9GP0LXRgiDQuNGFINCyINGH0LDRglxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS5kaXNwbGF5TWVzc2FnZXMgPSBmdW5jdGlvbiBkaXNwbGF5TWVzc2FnZXMoKSB7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIHZhciBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMuY2xlYXJDaGF0KCk7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIGNyZWF0ZU1lc3NhZ2UgKG1lc3NhZ2VPYmplY3QpIHtcclxuICAgICAgICAgICAgZWxlbWVudCA9IHRoYXQuY3JlYXRlTWVzc2FnZUVsZW1lbnQoXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlT2JqZWN0Lm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlT2JqZWN0LmRhdGUsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlT2JqZWN0LnNlbmRlcixcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VPYmplY3QucmVhZFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB0aGF0LmNET00ubWVzc2FnZXNCbG9jay5hcHBlbmRDaGlsZChlbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLy8g0J7Rh9C40YHRgtC40YLRjCBET00g0Y3Qu9C10LzQtdC90YIg0LIg0LrQvtGC0L7RgNC+0Lwg0L7RgtC+0LHRgNCw0LbQsNGO0YLRgdGPINGB0L7QvtCx0YnQtdC90LjRjyAo0L3QsNC/0YDQuNC80LXRgCDRh9GC0L7QsdGLINCy0YHRgtCw0LLQuNGC0Ywg0L3QstC+0YvQuSDRgdC/0LjRgdC+0Log0YHQvtC+0LHRidC10L3QuNC5KVxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS5jbGVhckNoYXQgPSBmdW5jdGlvbiBjbGVhckNoYXQoKSB7XHJcbiAgICAgICAgd2hpbGUgKHRoaXMuY0RPTS5tZXNzYWdlc0Jsb2NrLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgdGhpcy5jRE9NLm1lc3NhZ2VzQmxvY2sucmVtb3ZlQ2hpbGQodGhpcy5jRE9NLm1lc3NhZ2VzQmxvY2suZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IE1lc3NhZ2VMaXN0TWFuYWdlcigpO1xyXG5cclxufSkobWFpbkNvbmZpZyk7XHJcbi8qIGV4cG9ydGVkIHVzZXJEYXRhTWFuYWdlciAqL1xyXG4vKiBnbG9iYWwgZGF0YVNvdXJjZSAqL1xyXG4vKiBnbG9iYWwgbWVzc2FnZUxpc3RNYW5hZ2VyICovXHJcbi8qIGdsb2JhbCBjcmVhdGVNZXNzYWdlT2JqZWN0ICovXHJcbi8qIGdsb2JhbCBnZXRDdXJyZW50RGF0ZSAqL1xyXG4vKiBnbG9iYWwgZ2V0RWxlbWVudCAqL1xyXG4vKiBnbG9iYWwgZXZlbnRFbWl0dGVyICovXHJcbi8qIGdsb2JhbCBtYWluQ29uZmlnICovXHJcbi8qIGdsb2JhbCBsb25nUG9sbFJlc3BvbnNlUGFyc2VyICovXHJcbnZhciB1c2VyRGF0YU1hbmFnZXIgPSAgKGZ1bmN0aW9uIGNyZWF0ZVVzZXJEYXRhTWFuYWdlciAoY29uZmlnLCBldmVudEVtaXR0ZXIsIGxvbmdQb2xsUmVzcG9uc2VQYXJzZXIpIHtcclxuXHJcbiAgICAvLyBJTkNMVURFXHJcblxyXG4gICAgLyogZXhwb3J0ZWQgZ2V0Q3VycmVudERhdGUgKi9cclxuICAgIGZ1bmN0aW9uIGdldEN1cnJlbnREYXRlKCkge1xyXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICB2YXIgbWludXRlcyA9IChkYXRlLmdldE1pbnV0ZXMoKS50b1N0cmluZygpLmxlbmd0aCA9PT0gMSkgPyBcIjBcIiArIGRhdGUuZ2V0TWludXRlcygpIDogZGF0ZS5nZXRNaW51dGVzKCk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGVcclxuICAgICAgICAgICAgLmdldEhvdXJzKClcclxuICAgICAgICAgICAgLnRvU3RyaW5nKClcclxuICAgICAgICAgICAgLmNvbmNhdChcIjpcIiwgbWludXRlcyk7XHJcbiAgICB9XHJcbiAgICAvKiBleHBvcnRlZCBjcmVhdGVNZXNzYWdlT2JqZWN0ICovXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVNZXNzYWdlT2JqZWN0IChcclxuICAgICAgICBtZXNzYWdlLFxyXG4gICAgICAgIGRhdGUsXHJcbiAgICAgICAgc2VuZGVyLFxyXG4gICAgICAgIGlzUmVhZCxcclxuICAgICAgICBpZFxyXG4gICAgKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2VuZGVyOiBzZW5kZXIsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXHJcbiAgICAgICAgICAgIHJlYWQ6IGlzUmVhZCxcclxuICAgICAgICAgICAgZGF0ZTogZGF0ZSxcclxuICAgICAgICAgICAgaWQ6IGlkXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJTkNMVURFXHJcblxyXG4gICAgLy8gYmFzaWNcclxuICAgIGZ1bmN0aW9uIGdldFVzZXJEYXRhQmFzaWMgKHVzZXJJZCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gZ2V0Q29ycmVzcG9uZGVuY2UgKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoYXQuZ2V0VXNlckNvcnJlc3BvbmRlbmNlKHVzZXJJZCkudGhlbiggZnVuY3Rpb24gZ2V0UmVzb2x2ZSAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKClcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB1cGRhdGVNZXNzYWdlTGlzdEJhc2ljIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIG5ld01lc3NhZ2VMaXN0O1xyXG4gICAgICAgIHZhciBtZXNzYWdlc09iamVjdCA9IFtdO1xyXG4gICAgICAgIGlmKGRhdGEpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMoZGF0YSkubWFwKGZ1bmN0aW9uIHB1c2hEYXRhIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIGRhdGFba2V5XS5pZCA9IGtleTtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzT2JqZWN0LnB1c2goZGF0YVtrZXldKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLmRpc3BsYXlNZXNzYWdlcygpO1xyXG4gICAgICAgIG5ld01lc3NhZ2VMaXN0ID0gbWVzc2FnZUxpc3RNYW5hZ2VyLmNyZWF0ZU1lc3NhZ2VMaXN0KG1lc3NhZ2VzT2JqZWN0KTtcclxuICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIudXBkYXRlTWVzc2FnZUxpc3QobmV3TWVzc2FnZUxpc3QpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFVzZXJDb3JyZXNwb25kZW5jZUJhc2ljICh1c2VySWQpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIGRhdGFTb3VyY2UudXNlcnNBUEkuZ2V0VXNlck1lc3NhZ2VzKHVzZXJJZCkoKS50aGVuKGZ1bmN0aW9uIHVwZGF0ZU1lc3NhZ2VzTGlzdCAoZGF0YSkge1xyXG4gICAgICAgICAgICB0aGF0LnVwZGF0ZU1lc3NhZ2VMaXN0KGRhdGEpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0VXNlckRhdGFGcm9tTG9uZ1BvbGxDb25uZWN0aW9uKHVzZXJJZCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gZ2V0TG9uZ1BvbGxDb3JyZXNwb25kZW5jZShyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgIHRoYXQuZ2V0VXNlckNvcnJlc3BvbmRlbmNlKHVzZXJJZCk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRVc2VyQ29ycmVzcG9uZGVuY2VGcm9tTG9uZ1BvbGxDb25uZWN0aW9uKHVzZXJJZCkge1xyXG4gICAgICAgIHZhciBkYXRhO1xyXG4gICAgICAgIGlmKGNvbmZpZy5jdXJyZW50TWVzc2FnZUNvbm5lY3Rpb24pIHtcclxuICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRNZXNzYWdlQ29ubmVjdGlvbi5hYm9ydCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25maWcuY3VycmVudE1lc3NhZ2VDb25uZWN0aW9uID0gZGF0YVNvdXJjZS51c2Vyc0FQSS5nZXRVc2VyTWVzc2FnZXModXNlcklkKTtcclxuICAgICAgICBjb25maWcuY3VycmVudE1lc3NhZ2VDb25uZWN0aW9uLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uIHNldHVwQ29ubmVjdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IDMgJiYgdGhpcy5zdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgZGF0YSA9IGxvbmdQb2xsUmVzcG9uc2VQYXJzZXIucGFyc2UodGhpcy5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudEVtaXR0ZXIuZW1pdChkYXRhLnR5cGUsIGRhdGEub2JqZWN0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uZmlnLmN1cnJlbnRNZXNzYWdlQ29ubmVjdGlvbi5zZW5kKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdXBkYXRlTWVzc2FnZUxpc3RBZnRlckxvbmdQb2xsIChkYXRhKSB7XHJcbiAgICAgICAgaWYoZGF0YSkge1xyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhkYXRhKS5tYXAoZnVuY3Rpb24gYWRkVG9NZXNzYWdlTGlzdExvbmdQb2xsIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIGRhdGFba2V5XS5pZCA9IGtleTtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5hZGRNZXNzYWdlVG9NZXNzYWdlTGlzdChkYXRhW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIuZGlzcGxheU1lc3NhZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gVXNlckRhdGFNYW5hZ2VyICgpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgaWYoY29uZmlnLmNoYXRTZXR0aW5ncy50eXBlT2ZSZXF1ZXN0ID09PSBcImxvbmdQb2xsXCIpIHtcclxuICAgICAgICAgICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGdldFVzZXJEYXRhRnJvbUxvbmdQb2xsQ29ubmVjdGlvbi5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLmdldFVzZXJDb3JyZXNwb25kZW5jZSA9IGdldFVzZXJDb3JyZXNwb25kZW5jZUZyb21Mb25nUG9sbENvbm5lY3Rpb24uYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS51cGRhdGVNZXNzYWdlTGlzdCA9IHVwZGF0ZU1lc3NhZ2VMaXN0QWZ0ZXJMb25nUG9sbC5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICBldmVudEVtaXR0ZXIuYWRkU3Vic2NyaWJlKFwibWVzc2FnZVwiLCBmdW5jdGlvbiBzdWJzY3JpYmVNZXNzYWdlIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnVwZGF0ZU1lc3NhZ2VMaXN0KGRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZXZlbnRFbWl0dGVyLmFkZFN1YnNjcmliZShcInJlYWRcIiwgZnVuY3Rpb24gc3Vic2NyaWJlUmVhZCAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaWYoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5tZXNzYWdlTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIGRpc3BsYXlNZXNzYWdlcyAobWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihtZXNzYWdlLmlkID09PSBkYXRhLmlkKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UucmVhZCA9IGRhdGEudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIuZGlzcGxheU1lc3NhZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLmdldFVzZXJEYXRhID0gZ2V0VXNlckRhdGFCYXNpYy5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLmdldFVzZXJDb3JyZXNwb25kZW5jZSA9IGdldFVzZXJDb3JyZXNwb25kZW5jZUJhc2ljLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUudXBkYXRlTWVzc2FnZUxpc3QgPSB1cGRhdGVNZXNzYWdlTGlzdEJhc2ljLmJpbmQodGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuc2V0dXAgPSBmdW5jdGlvbiBzZXR1cCAoKSB7XHJcbiAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLnNldHVwKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuY2xlYXJNZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIGNsZWFyTWVzc2FnZUxpc3QgKCkge1xyXG4gICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5tZXNzYWdlTGlzdCA9IFtdO1xyXG4gICAgfTtcclxuXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLmNyZWF0ZU5ld1VzZXJQcm9maWxlVG9EYXRhQmFzZSA9IGZ1bmN0aW9uIGNyZWF0ZU5ld1VzZXJQcm9maWxlVG9EYXRhQmFzZSAodXNlcklkLCB1c2VyTmFtZSkge1xyXG4gICAgICAgIGRhdGFTb3VyY2UudXNlcnNBUEkuYWRkTmV3VXNlclRvRGF0YVNvdXJjZSh1c2VySWQsIHVzZXJOYW1lKTtcclxuICAgIH07XHJcblxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5zYXZlU2V0dGluZ0ZpZWxkID0gZnVuY3Rpb24gc2V0RmllbGQgKGZpZWxkTmFtZSkge1xyXG4gICAgICAgIGRhdGFTb3VyY2UudXNlcnNBUEkuc2V0U2V0dGluZ0ZpZWxkKFxyXG4gICAgICAgICAgICBmaWVsZE5hbWUsXHJcbiAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZCxcclxuICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3NbZmllbGROYW1lXVxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUudXBkYXRlVXNlck9ubGluZSA9IGZ1bmN0aW9uIHVwZGF0ZVVzZXJPbmxpbmUgKHVzZXJJZCkge1xyXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGU7XHJcbiAgICAgICAgZGF0YVNvdXJjZS51c2Vyc0FQSS51cGRhdGVMYXN0T25saW5lKHVzZXJJZCwgZGF0ZS5nZXRUaW1lKCkpXHJcbiAgICB9O1xyXG5cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuc2VuZE1lc3NhZ2UgPSBmdW5jdGlvbiBzZW5kTWVzc2FnZSAoKSB7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSB0aGlzLmdldE1lc3NhZ2VGcm9tSW5wdXRFbGVtZW50KCk7XHJcbiAgICAgICAgdmFyIGRhdGUgPSBnZXRDdXJyZW50RGF0ZSgpO1xyXG4gICAgICAgIHZhciB1c2VyTmFtZSA9IGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lIHx8IGNvbmZpZy5BRE1JTl9OQU1FO1xyXG4gICAgICAgIHZhciBtZXNzYWdlT2JqZWN0ID0gY3JlYXRlTWVzc2FnZU9iamVjdChcclxuICAgICAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICAgICAgZGF0ZSxcclxuICAgICAgICAgICAgdXNlck5hbWUsXHJcbiAgICAgICAgICAgIGZhbHNlXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpZihjb25maWcuY2hhdFNldHRpbmdzLnR5cGVPZlJlcXVlc3QgIT09IFwibG9uZ1BvbGxcIikge1xyXG4gICAgICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIuYWRkTWVzc2FnZVRvTWVzc2FnZUxpc3QobWVzc2FnZU9iamVjdCk7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5kaXNwbGF5TWVzc2FnZXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zYXZlTWVzc2FnZVRvRGF0YVNvdXJjZShtZXNzYWdlT2JqZWN0KTtcclxuICAgIH07XHJcblxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5nZXRNZXNzYWdlRnJvbUlucHV0RWxlbWVudCA9IGZ1bmN0aW9uIGdldE1lc3NhZ2VGcm9tSW5wdXRFbGVtZW50ICgpIHtcclxuICAgICAgICB2YXIgZWxlbWVudCA9IGdldEVsZW1lbnQoY29uZmlnLkNTU19DVVJSRU5UX0lOUFVUX0NMQVNTKTtcclxuICAgICAgICB2YXIgdmFsdWUgPSBlbGVtZW50LnZhbHVlO1xyXG4gICAgICAgIGVsZW1lbnQudmFsdWUgPSBcIlwiO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH07XHJcblxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5zZXRNZXNzYWdlQXNSZWFkID0gZnVuY3Rpb24gc2V0TWVzc2FnZUFzUmVhZCAoKSB7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2VPYmplY3RzID0gbWVzc2FnZUxpc3RNYW5hZ2VyLmdldE1lc3NhZ2VPYmplY3RzRm9yTWFya0FzUmVhZCgpO1xyXG4gICAgICAgIGlmKG1lc3NhZ2VPYmplY3RzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbWVzc2FnZU9iamVjdHMuZm9yRWFjaChmdW5jdGlvbiBzZXRSZWFkIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhU291cmNlLnVzZXJzQVBJLnVwZGF0ZU1lc3NhZ2VJc1JlYWRGaWVsZChcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmZpZWxkTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmZpZWxkVmFsdWVcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5yZWFkTGFzdE1lc3NhZ2UgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIuZGlzcGxheU1lc3NhZ2VzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuc2F2ZU1lc3NhZ2VUb0RhdGFTb3VyY2UgPSBmdW5jdGlvbiBzYXZlTWVzc2FnZVRvRGF0YVNvdXJjZSAobWVzc2FnZU9iamVjdCkge1xyXG4gICAgICAgIGlmKG1lc3NhZ2VPYmplY3Quc2VuZGVyID09PSBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZSkge1xyXG4gICAgICAgICAgICBkYXRhU291cmNlLnVzZXJzQVBJLnVwZGF0ZVNlbmROZXdNZXNzYWdlRmxhZyhjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQsdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRhdGFTb3VyY2UudXNlcnNBUEkuc2VuZE1lc3NhZ2UoXHJcbiAgICAgICAgICAgIG51bGwsXHJcbiAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZCxcclxuICAgICAgICAgICAgbWVzc2FnZU9iamVjdFxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFNldHRpbmdzID0gW3t1c2VySWQsIGZpZWxkTmFtZSwgZmllbGRWYWx1ZX0se30uLi5dXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLnNhdmVVc2VyU2V0dGluZ3NUb0RhdGFTb3VyY2UgPSBmdW5jdGlvbiBzYXZlVXNlclNldHRpbmdzVG9EYXRhU291cmNlIChzZXR0aW5ncykge1xyXG4gICAgICAgIHNldHRpbmdzLmZvckVhY2goZnVuY3Rpb24gc2F2ZVNldHRpbmcgKG5ld0ZpZWxkU2V0dGluZykge1xyXG4gICAgICAgICAgICBkYXRhU291cmNlLnVzZXJzQVBJLnNldFNldHRpbmdGaWVsZChcclxuICAgICAgICAgICAgICAgIG5ld0ZpZWxkU2V0dGluZy5maWVsZE5hbWUsXHJcbiAgICAgICAgICAgICAgICBuZXdGaWVsZFNldHRpbmcudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbmV3RmllbGRTZXR0aW5nLmZpZWxkVmFsdWVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG5cclxuICAgIHJldHVybiBuZXcgVXNlckRhdGFNYW5hZ2VyKCk7XHJcblxyXG59KShtYWluQ29uZmlnLCBldmVudEVtaXR0ZXIsIGxvbmdQb2xsUmVzcG9uc2VQYXJzZXIpO1xyXG5cclxuLy8gdmlld1xyXG5cclxuLyogZXhwb3J0ZWQgdmlld0ZhY3RvcnkgKi9cclxuLyogZ2xvYmFsIGdldEVsZW1lbnQgKi9cclxuLyogZ2xvYmFsIGRhdGFTb3VyY2UgKi9cclxudmFyIHZpZXdGYWN0b3J5ID0gKGZ1bmN0aW9uIGNyZWF0ZVZpZXdGYWN0b3J5IChkYXRhU291cmNlKSB7XHJcblxyXG4gICAgZnVuY3Rpb24gVmlld0ZhY3RvcnkgKCkge31cclxuXHJcbiAgICBWaWV3RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlVmlldyA9IGZ1bmN0aW9uIGNyZWF0ZUNoYXRWaWV3IChodG1sUGF0aCwgY3NzUGF0aCwgY29udGFpbmVyQ2xhc3MpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIGNyZWF0ZVZpZXdQcm9taXNlIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgaWYoaHRtbFBhdGgpIHtcclxuICAgICAgICAgICAgICAgIGlmKGNzc1BhdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LmluY2x1ZGVWaWV3Q3NzVG9QYWdlKHRoYXQuY3JlYXRlQ1NTTGluayhcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzUGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdHlsZXNoZWV0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGV4dC9jc3NcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b3VjaC1zb2Z0LWNoYXQtY3NzXCJcclxuICAgICAgICAgICAgICAgICAgICApKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJlc29sdmUodGhhdC5pbmNsdWRlVmlld0hUTUxUb1BhZ2UoaHRtbFBhdGgsIGNvbnRhaW5lckNsYXNzKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiaHRtbFBhdGggaXMgbnVsbC4gUGxlYXNlIGFkZCBodG1sUGF0aFwiKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgVmlld0ZhY3RvcnkucHJvdG90eXBlLmluY2x1ZGVWaWV3SFRNTFRvUGFnZSA9IGZ1bmN0aW9uIGluY2x1ZGVDaGF0SFRNTFRvUGFnZSAoaHRtbFBhdGgsIGNvbnRhaW5lckNsYXNzKSB7XHJcbiAgICAgICAgdmFyIGNvbnRhaW5lckRpdiA9IChjb250YWluZXJDbGFzcykgPyBnZXRFbGVtZW50KGNvbnRhaW5lckNsYXNzKSA6IGRvY3VtZW50LmJvZHk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGFTb3VyY2UuY29tbW9uQVBJLmdldEhUTUwoaHRtbFBhdGgpLnRoZW4oZnVuY3Rpb24gc2V0SHRtbCAoaHRtbCkge1xyXG4gICAgICAgICAgICBjb250YWluZXJEaXYuaW5uZXJIVE1MID0gaHRtbDtcclxuICAgICAgICB9KVxyXG4gICAgfTtcclxuXHJcbiAgICBWaWV3RmFjdG9yeS5wcm90b3R5cGUuaW5jbHVkZVZpZXdDc3NUb1BhZ2UgPSBmdW5jdGlvbiBpbmNsdWRlQ2hhdENzc1RvUGFnZSAobGluaykge1xyXG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQobGluayk7XHJcbiAgICB9O1xyXG5cclxuICAgIFZpZXdGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVDU1NMaW5rID0gZnVuY3Rpb24gY3JlYXRlQ1NTTGluayhcclxuICAgICAgICBmaWxlUGF0aCxcclxuICAgICAgICByZWwsXHJcbiAgICAgICAgdHlwZSxcclxuICAgICAgICBpZFxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTtcclxuICAgICAgICBpZiAoaWQpIHtcclxuICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZWwpIHtcclxuICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoXCJyZWxcIiwgcmVsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGUpIHtcclxuICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIHR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZShcImhyZWZcIiwgZmlsZVBhdGgpO1xyXG4gICAgICAgIHJldHVybiBsaW5rO1xyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFZpZXdGYWN0b3J5KClcclxuXHJcbn0pKGRhdGFTb3VyY2UpO1xyXG5cclxuLy8gY2hhdE1haW5cclxuXHJcbi8qIGV4cG9ydGVkIGNoYXRDdXN0b21pemVyICovXHJcbi8qIGdsb2JhbCBjaGF0Q3VzdG9taXplciAqL1xyXG4vKiBnbG9iYWwgZ2V0RWxlbWVudCAqL1xyXG4vKiBnbG9iYWwgbWFpbkNvbmZpZyAqL1xyXG52YXIgY2hhdEN1c3RvbWl6ZXIgPSAoZnVuY3Rpb24gY3JlYXRlQ2hhdEN1c3RvbWl6ZXIgKGNvbmZpZykge1xyXG5cclxuICAgIGZ1bmN0aW9uIENoYXRDdXN0b21pemVyKCkge31cclxuXHJcbiAgICBDaGF0Q3VzdG9taXplci5wcm90b3R5cGUuc2V0dXBPdXRlckNoYXRTZXR0aW5ncyA9IGZ1bmN0aW9uIHNldHVwT3V0ZXJDaGF0U2V0dGluZ3MoKSB7XHJcbiAgICAgICAgdGhpcy5hbGxvd01pbmltaXplKCk7XHJcbiAgICAgICAgdGhpcy5zZXRQb3NpdGlvbk9mTWFpbkJsb2NrKCk7XHJcbiAgICAgICAgdGhpcy5zZXRUaXRsZSgpO1xyXG4gICAgICAgIHRoaXMuc2V0TWFpbkNzc0NsYXNzKCk7XHJcbiAgICAgICAgdGhpcy5hbGxvd0RyYWdORHJvcCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBDaGF0Q3VzdG9taXplci5wcm90b3R5cGUuYWxsb3dEcmFnTkRyb3AgPSBmdW5jdGlvbiBhbGxvd0RyYWdORHJvcCgpIHtcclxuICAgICAgICB2YXIgY2xpY2tCbG9jayA9IGdldEVsZW1lbnQoY29uZmlnLkRPTS5USVRMRV9CTE9DS19DTEFTUyk7XHJcbiAgICAgICAgdmFyIGRyYWdCbG9jayA9IGdldEVsZW1lbnQoY29uZmlnLkRPTS5NQUlOX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpO1xyXG4gICAgICAgIGlmIChjb25maWcuY2hhdFNldHRpbmdzLmFsbG93RHJhZyA9PT0gXCJmYWxzZVwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2xpY2tCbG9jay5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIGRyYWdBbmREcm9wKGUpIHtcclxuICAgICAgICAgICAgdmFyIGNvcmRzO1xyXG4gICAgICAgICAgICB2YXIgc2hpZnRYO1xyXG4gICAgICAgICAgICB2YXIgc2hpZnRZO1xyXG4gICAgICAgICAgICB2YXIgbW92ZU9iajtcclxuICAgICAgICAgICAgdmFyIHNldE51bGw7XHJcbiAgICAgICAgICAgIHZhciBlbmREcmFnO1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q29vcmRzKGVsZW0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB0b3A6IGJveC50b3AgKyB3aW5kb3cucGFnZVlPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogYm94LmxlZnQgKyB3aW5kb3cucGFnZVhPZmZzZXRcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvcmRzID0gZ2V0Q29vcmRzKGRyYWdCbG9jayk7XHJcbiAgICAgICAgICAgIHNoaWZ0WCA9IGUucGFnZVggLSBjb3Jkcy5sZWZ0O1xyXG4gICAgICAgICAgICBzaGlmdFkgPSBlLnBhZ2VZIC0gY29yZHMudG9wO1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gbW92ZUF0KGVsZW0pIHtcclxuICAgICAgICAgICAgICAgIGRyYWdCbG9jay5zdHlsZS5sZWZ0ID0gZWxlbS5wYWdlWCAtIHNoaWZ0WCArIFwicHhcIjtcclxuICAgICAgICAgICAgICAgIGRyYWdCbG9jay5zdHlsZS50b3AgPSBlbGVtLnBhZ2VZIC0gc2hpZnRZICsgXCJweFwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBtb3ZlT2JqID0gZnVuY3Rpb24gbW92ZU9iakRyYWdBbmREcm9wKGVsZW0pIHtcclxuICAgICAgICAgICAgICAgIG1vdmVBdChlbGVtKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHNldE51bGwgPSBmdW5jdGlvbiBzZXROdWxsRHJhZ0FuZERyb3AgKCkge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLG1vdmVPYmogKTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsc2V0TnVsbCApO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZW5kRHJhZyA9IGZ1bmN0aW9uIGVuZERyYWdBbmREcm9wKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgbW92ZUF0KGUpO1xyXG4gICAgICAgICAgICBkcmFnQmxvY2suc3R5bGUuekluZGV4ID0gMTAwMDtcclxuXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgbW92ZU9iaik7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHNldE51bGwpO1xyXG4gICAgICAgICAgICBkcmFnQmxvY2suYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCBlbmREcmFnKTtcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDdXN0b21pemVyLnByb3RvdHlwZS5zZXRQb3NpdGlvbk9mTWFpbkJsb2NrID0gZnVuY3Rpb24gc2V0UG9zaXRpb25PZk1haW5CbG9jaygpIHtcclxuICAgICAgICBpZiAoY29uZmlnLmNoYXRTZXR0aW5ncy5wb3NpdGlvbiA9PT0gXCJyaWdodFwiKSB7XHJcbiAgICAgICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5NQUlOX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLmNsYXNzTGlzdC5hZGQoXHJcbiAgICAgICAgICAgICAgICBjb25maWcuQ0hBVF9QT1NJVElPTl9SSUdIVFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5NQUlOX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLmNsYXNzTGlzdC5hZGQoXHJcbiAgICAgICAgICAgICAgICBjb25maWcuQ0hBVF9QT1NJVElPTl9MRUZUXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBDaGF0Q3VzdG9taXplci5wcm90b3R5cGUuc2V0VGl0bGUgPSBmdW5jdGlvbiBzZXRUaXRsZSgpIHtcclxuICAgICAgICBpZihjb25maWcuY2hhdFNldHRpbmdzLmNoYXRUaXRsZS5sZW5ndGggPCAxKSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jaGF0U2V0dGluZ3MuY2hhdFRpdGxlID0gY29uZmlnLkRFRkFVTFRfQ0hBVF9USVRMRTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlRJVExFX0JMT0NLX0NMQVNTKS5pbm5lckhUTUwgPSBjb25maWcuY2hhdFNldHRpbmdzLmNoYXRUaXRsZTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdEN1c3RvbWl6ZXIucHJvdG90eXBlLmFsbG93TWluaW1pemUgPSBmdW5jdGlvbiBhbGxvd01pbmltaXplKCkge1xyXG4gICAgICAgIGlmIChjb25maWcuY2hhdFNldHRpbmdzLmFsbG93TWluaW1pemUgPT09IFwiZmFsc2VcIikge1xyXG4gICAgICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uQ0hBTkdFX1NUWUxFX0JVVFRPTl9NQVhfU0laRSkuY2xhc3NMaXN0LmFkZChcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5JTlZJU0lCTEVfQ0xBU1NcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDdXN0b21pemVyLnByb3RvdHlwZS5zZXRNYWluQ3NzQ2xhc3MgPSBmdW5jdGlvbiBzZXRNYWluQ3NzQ2xhc3MoKSB7XHJcbiAgICAgICAgaWYoY29uZmlnLmNoYXRTZXR0aW5ncy5vdXRlckNzc0NsYXNzLmxlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgY29uZmlnLmNoYXRTZXR0aW5ncy5vdXRlckNzc0NsYXNzID0gY29uZmlnLkRFRkFVTFRfQ1NTX0NMQVNTX0ZPUl9DSEFUO1xyXG4gICAgICAgIH1cclxuICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uTUFJTl9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTKS5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoXHJcbiAgICAgICAgICAgIGNvbmZpZy5jaGF0U2V0dGluZ3Mub3V0ZXJDc3NDbGFzc1xyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgQ2hhdEN1c3RvbWl6ZXIoKTtcclxufSkobWFpbkNvbmZpZyk7XHJcbi8qIGdsb2JhbCB1c2VyRGF0YU1hbmFnZXIgKi9cclxuLyogZ2xvYmFsIGNoYXRDdXN0b21pemVyICovXHJcbi8qIGdsb2JhbCBnZXRIYXNoICovXHJcbi8qIGdsb2JhbCBnZXRFbGVtZW50ICovXHJcbi8qIGdsb2JhbCBtYWluQ29uZmlnICovXHJcbi8qIGdsb2JhbCB2aWV3RmFjdG9yeSAqL1xyXG4vKiBnbG9iYWwgZXZlbnRFbWl0dGVyICovXHJcbnZhciBjaGF0Q29udHJvbGxlciA9IChmdW5jdGlvbiBjcmVhdGVDaGF0Q29udHJvbGxlciAoY29uZmlnLCBpbnN0cnVjdGlvblBlcmZvcm1lciwgdXNlckRhdGFNYW5hZ2VyKSB7XHJcblxyXG4gICAgdmFyIGRhdGFGb3JHZXRVc2VyTmFtZUNhbGxiYWNrID0gW1xyXG4gICAgICAgIFwiYXV0aG9yaXphdGlvblwiLFxyXG4gICAgICAgIFwiZW50ZXIgeW91ciBuYW1lLCBwbGVhc2VcIixcclxuICAgICAgICBcIlwiXHJcbiAgICBdO1xyXG5cclxuICAgIC8vIElOQ0xVREUgLy9cclxuXHJcbiAgICAvKiBleHBvcnRlZCBnZXRIYXNoICovXHJcbiAgICBmdW5jdGlvbiBnZXRIYXNoKHN0cikge1xyXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICByZXR1cm4gc3RyICsgZGF0ZS5nZXRUaW1lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSU5DTFVERSAvL1xyXG5cclxuICAgIGZ1bmN0aW9uIENoYXRDb250cm9sbGVyKCkge1xyXG4gICAgICAgIHRoaXMuY3JlYXRlTmV3VXNlciA9IHVzZXJEYXRhTWFuYWdlci5jcmVhdGVOZXdVc2VyUHJvZmlsZVRvRGF0YUJhc2VcclxuICAgIH1cclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuc3RhcnRBcHAgPSBmdW5jdGlvbiBzdGFydEFwcEJhc2ljICgpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgLy8gbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oY29uZmlnLkxPQ0FMX1NUT1JBR0VfTkFNRSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dXBDaGF0VmlldygpLnRoZW4oIGZ1bmN0aW9uIHN0YXJ0QXV0aG9yaXphdGlvbkFuZEJhc2ljTGlzdGVuZXJzICgpIHtcclxuICAgICAgICAgICAgdGhhdC5hdXRob3JpemF0aW9uKGNvbmZpZy5jaGF0U2V0dGluZ3MucmVxdWlyZU5hbWUpO1xyXG4gICAgICAgICAgICB0aGF0LnNldHVwQ2hhdEJhc2ljTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiBhZnRlclNldHVwVmlld0NvbmZpZ3VyYXRpb24gKCkge1xyXG4gICAgICAgICAgICB1c2VyRGF0YU1hbmFnZXIuZ2V0VXNlckRhdGEoY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkKS50aGVuKGZ1bmN0aW9uIGFmdGVyVXNlckRhdGFTZXR1cCAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnNldHVwQ2hhdFN0eWxlKCk7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnNldHVwQ2hhdFNlbmRMaXN0ZW5lcnMoKTtcclxuICAgICAgICAgICAgICAgIGNoYXRDdXN0b21pemVyLnNldHVwT3V0ZXJDaGF0U2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uUGVyZm9ybWVyLnNldHVwTG9uZ1BvbGxDb25uZWN0aW9uKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIGF1dGhvcml6YXRpb24gYmxvY2sgLy9cclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuYXV0aG9yaXphdGlvbiA9IGZ1bmN0aW9uIGF1dGhvcml6YXRpb24gKHVzZXJOYW1lSXNSZXF1aXJlKSB7XHJcbiAgICAgICAgdXNlckRhdGFNYW5hZ2VyLnNldHVwKCk7XHJcbiAgICAgICAgaWYoIXRoaXMuZ2V0Q29uZGl0aW9uRnJvbUxvY2FsU3RvcmFnZSgpKSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZCA9IGdldEhhc2goXHJcbiAgICAgICAgICAgICAgICBjb25maWcuREVGQVVMVF9VU0VSX05BTUVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYodXNlck5hbWVJc1JlcXVpcmUgPT09IFwiZmFsc2VcIikge1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWUgPSBjb25maWcuREVGQVVMVF9VU0VSX05BTUU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVDb25kaXRpb25Ub0xvY2FsU3RvcmFnZSgpO1xyXG4gICAgICAgICAgICAgICAgdXNlckRhdGFNYW5hZ2VyLmNyZWF0ZU5ld1VzZXJQcm9maWxlVG9EYXRhQmFzZShjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQsIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dXBJbnRlcnZhbEZ1bmN0aW9ucygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb25QZXJmb3JtZXIuZXhlY3V0ZShcclxuICAgICAgICAgICAgICAgICAgICBcImFza1F1ZXN0aW9uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YUZvckdldFVzZXJOYW1lQ2FsbGJhY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgXCJwZW5kaW5nXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRVc2VyTmFtZUZyb21JbnB1dCxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNldHVwQ2hhdENvbmRpdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLnNldHVwSW50ZXJ2YWxGdW5jdGlvbnMoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS50b2dnbGVBdXRob3JpemF0aW9uTWVudVZpc2libGUgPSBmdW5jdGlvbiB0b2dnbGVBdXRob3JpemF0aW9uTWVudVZpc2libGUgKCkge1xyXG4gICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5BVVRIT1JJWkFUSU9OX01FTlVfQ0xBU1MpLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgIGNvbmZpZy5JTlZJU0lCTEVfQ0xBU1NcclxuICAgICAgICApXHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICAvLyDQldGB0LvQuCDRgtGA0LXQsdGD0LXRgtGB0Y8g0LLQstC10YHRgtC4INC40LzRjywg0L/QvtC70YPRh9Cw0LXQvCDQtdCz0L4g0Lgg0LfQsNC90L7RgdC40Lwg0Y7Qt9C10YDQsCDQsiDQsdC0XHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuZ2V0VXNlck5hbWVGcm9tSW5wdXQgPSBmdW5jdGlvbiBnZXRVc2VyTmFtZUZyb21JbnB1dCAoKSB7XHJcbiAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWUgPSBnZXRFbGVtZW50KFxyXG4gICAgICAgICAgICBjb25maWcuRE9NLlVTRVJfTkFNRV9JTlBVVF9DTEFTU1xyXG4gICAgICAgICkudmFsdWU7XHJcbiAgICAgICAgY29uZmlnLmNoYXRTZXR0aW5ncy5pc01pbmltaXplID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVOZXdVc2VyKGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZCwgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWUpO1xyXG4gICAgICAgIHRoaXMuc2V0dXBJbnRlcnZhbEZ1bmN0aW9ucygpO1xyXG4gICAgICAgIHRoaXMuc2F2ZUNvbmRpdGlvblRvTG9jYWxTdG9yYWdlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFNldHVwIENoYXQgLy9cclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuc2V0dXBDaGF0U2VuZExpc3RlbmVycyA9IGZ1bmN0aW9uIHNldHVwQ2hhdFNlbmRMaXN0ZW5lcnMgKCkge1xyXG4gICAgICAgIC8vIHNldHVwIGNoYXQgbGlzdGVuZXJzXHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFTkRfTUVTU0FHRV9GVUxMX1NJWkVfQlVUVE9OKS5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAnY2xpY2snLFxyXG4gICAgICAgICAgICB1c2VyRGF0YU1hbmFnZXIuc2VuZE1lc3NhZ2UuYmluZCh1c2VyRGF0YU1hbmFnZXIsXHJcbiAgICAgICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFTkRfTUVTU0FHRV9NSU5fU0laRV9CVVRUT04pLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICdjbGljaycsXHJcbiAgICAgICAgICAgIHVzZXJEYXRhTWFuYWdlci5zZW5kTWVzc2FnZS5iaW5kKHVzZXJEYXRhTWFuYWdlcixcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdXNlckRhdGFNYW5hZ2VyLnNldE1lc3NhZ2VBc1JlYWQuYmluZCh1c2VyRGF0YU1hbmFnZXIpKTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwQ2hhdEJhc2ljTGlzdGVuZXJzID0gZnVuY3Rpb24gc2V0dXBDaGF0QmFzaWNMaXN0ZW5lcnMgKCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uU0VUX01BWF9TVFlMRV9CVVRUT04pLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICdjbGljaycsXHJcbiAgICAgICAgICAgIHRoYXQubWluTWF4U3R5bGVUb2dnbGUuYmluZCh0aGF0KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFVF9NSU5fU1RZTEVfQlVUVE9OKS5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAnY2xpY2snLFxyXG4gICAgICAgICAgICB0aGF0Lm1pbk1heFN0eWxlVG9nZ2xlLmJpbmQodGhhdClcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwQ2hhdFZpZXcgPSBmdW5jdGlvbiBzZXR1cENoYXRWaWV3ICgpIHtcclxuICAgICAgICByZXR1cm4gdmlld0ZhY3RvcnkuY3JlYXRlVmlldyhjb25maWcuSFRNTF9GSUxFX1BBVEgsIGNvbmZpZy5DU1NfRklMRV9QQVRILCBudWxsKTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwQ2hhdFN0eWxlID0gZnVuY3Rpb24gc2V0dXBDaGF0U3R5bGUoKSB7XHJcbiAgICAgICAgaWYgKCFjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5pc01pbmltaXplKSB7XHJcbiAgICAgICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5NQUlOX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgICAgICBjb25maWcuSU5WSVNJQkxFX0NMQVNTXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLk1JTklNSVpFX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgICAgICBjb25maWcuSU5WSVNJQkxFX0NMQVNTXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hhbmdlSW5wdXRBbmRTZW5kQnV0dG9uQ2xhc3MoKTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLm1pbk1heFN0eWxlVG9nZ2xlID0gZnVuY3Rpb24gbWluTWF4U3R5bGVUb2dnbGUoKSB7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLk1BSU5fU1RZTEVfQ0hBVF9CTE9DS19DTEFTUykuY2xhc3NMaXN0LnRvZ2dsZShcclxuICAgICAgICAgICAgY29uZmlnLklOVklTSUJMRV9DTEFTU1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLk1JTklNSVpFX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgIGNvbmZpZy5JTlZJU0lCTEVfQ0xBU1NcclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLmlzTWluaW1pemUgPSBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5pc01pbmltaXplID09PSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNoYW5nZUlucHV0QW5kU2VuZEJ1dHRvbkNsYXNzKCk7XHJcbiAgICAgICAgdGhpcy5zYXZlQ29uZGl0aW9uVG9Mb2NhbFN0b3JhZ2UoKTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLmFjdGl2aXR5Tm90aWZ5ID0gZnVuY3Rpb24gYWN0aXZpdHlOb3RpZnkgKCkge1xyXG4gICAgICAgIHVzZXJEYXRhTWFuYWdlci51cGRhdGVVc2VyT25saW5lKGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZCk7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5jaGFuZ2VJbnB1dEFuZFNlbmRCdXR0b25DbGFzcyA9IGZ1bmN0aW9uIGNoYW5nZUlucHV0QW5kU2VuZEJ1dHRvbkNsYXNzICgpIHtcclxuICAgICAgICBpZihjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5pc01pbmltaXplKSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5DU1NfQ1VSUkVOVF9JTlBVVF9DTEFTUyA9IGNvbmZpZy5ET00uQ1NTX01JTl9TSVpFX0lOUFVUX01FU1NBR0VfQkxPQ0tfQ0xBU1NcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25maWcuQ1NTX0NVUlJFTlRfSU5QVVRfQ0xBU1MgPSBjb25maWcuRE9NLkNTU19NQVhfU0laRV9JTlBVVF9NRVNTQUdFX0JMT0NLX0NMQVNTXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBXT1JLIFdJVEggTE9DQUwgU1RPUkFHRSAvL1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5zZXR1cENoYXRDb25kaXRpb24gPSBmdW5jdGlvbiBzZXR1cENoYXRDb25kaXRpb24gKCkge1xyXG4gICAgICAgIHZhciBjb25kaXRpb24gPSB0aGlzLmdldENvbmRpdGlvbkZyb21Mb2NhbFN0b3JhZ2UoKTtcclxuICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQgPSB0aGlzLmdldENvbmRpdGlvbkZyb21Mb2NhbFN0b3JhZ2UoKS51c2VySWQ7XHJcbiAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWUgPSB0aGlzLmdldENvbmRpdGlvbkZyb21Mb2NhbFN0b3JhZ2UoKS51c2VyTmFtZTtcclxuICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5pc01pbmltaXplID0gY29uZGl0aW9uLmlzTWluaW1pemU7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5zYXZlQ29uZGl0aW9uVG9Mb2NhbFN0b3JhZ2UgPSBmdW5jdGlvbiBzYXZlQ29uZGl0aW9uVG9Mb2NhbFN0b3JhZ2UoKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIHVzZXJJZDogY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkLFxyXG4gICAgICAgICAgICBpc01pbmltaXplOiBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5pc01pbmltaXplLFxyXG4gICAgICAgICAgICB1c2VyTmFtZTogY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWVcclxuICAgICAgICB9KTtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjb25maWcuTE9DQUxfU1RPUkFHRV9OQU1FLCBkYXRhKTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLmdldENvbmRpdGlvbkZyb21Mb2NhbFN0b3JhZ2UgPSBmdW5jdGlvbiBnZXRDb25kaXRpb25Gcm9tTG9jYWxTdG9yYWdlICgpIHtcclxuICAgICAgICB2YXIgY29uZGl0aW9uID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oY29uZmlnLkxPQ0FMX1NUT1JBR0VfTkFNRSk7XHJcbiAgICAgICAgaWYoY29uZGl0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGNvbmRpdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gV09SSyBXSVRIIExPQ0FMIFNUT1JBR0UgLy9cclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuc2V0dXBJbnRlcnZhbEZ1bmN0aW9ucyA9IGZ1bmN0aW9uIHNldHVwSW50ZXJ2YWxGdW5jdGlvbnMgKCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICBzZXRJbnRlcnZhbCggZnVuY3Rpb24gaW50ZXJ2YWxGdW5jdGlvbnMgKCkge1xyXG4gICAgICAgICAgICBpZihjb25maWcuY2hhdFNldHRpbmdzLnR5cGVPZlJlcXVlc3QgIT09IFwibG9uZ1BvbGxcIikge1xyXG4gICAgICAgICAgICAgICAgdXNlckRhdGFNYW5hZ2VyLmdldFVzZXJEYXRhKGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhhdC5hY3Rpdml0eU5vdGlmeSgpO1xyXG4gICAgICAgIH0sIGNvbmZpZy5VUERBVEVfVVNFUl9EQVRBX1RJTUUpXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgQ2hhdENvbnRyb2xsZXIoKTtcclxuXHJcbn0pKG1haW5Db25maWcsIGluc3RydWN0aW9uUGVyZm9ybWVyLCB1c2VyRGF0YU1hbmFnZXIpO1xyXG5cclxuXHJcbmNoYXRDb250cm9sbGVyLnN0YXJ0QXBwKCk7Il19
