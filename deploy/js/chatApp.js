var mainConfig={DOM:{MAIN_STYLE_CHAT_BLOCK_CLASS:"root_chat_for_touchsoft",AUTHORIZATION_MENU_CLASS:"root_chat_for_touchsoft_input-name-block",USER_NAME_INPUT_CLASS:"root_chat_for_touchsoft_input-name",SEND_USER_NAME_BUTTON:"root_chat_for_touchsoft_input-name-button",SEND_MESSAGE_MIN_SIZE_BUTTON:"root_chat_for_touchsoft_minimize-style__send-button",SEND_MESSAGE_FULL_SIZE_BUTTON:"root_chat_for_touchsoft__bottom_send-button",CSS_MAX_SIZE_INPUT_MESSAGE_BLOCK_CLASS:"root_chat_for_touchsoft__textarea",CSS_MIN_SIZE_INPUT_MESSAGE_BLOCK_CLASS:"root_chat_for_touchsoft_minimize-style__message-input",TITLE_BLOCK_CLASS:"root_chat_for_touchsoft-title",CHANGE_STYLE_BUTTON_MAX_SIZE:"root_chat_for_touchsoft__top_minimize-button",MINIMIZE_STYLE_CHAT_BLOCK_CLASS:"root_chat_for_touchsoft_minimize-style",SET_MIN_STYLE_BUTTON:"root_chat_for_touchsoft_minimize-style__max-button",SET_MAX_STYLE_BUTTON:"root_chat_for_touchsoft__top_minimize-button",CHAT_QUESTION_CSS:"root_chat_for_touchsoft_information-enter-name"},DATA_BASE_URL:"https://onlineconsultantwebapp.firebaseio.com",CSS_CURRENT_INPUT_CLASS:"root_chat_for_touchsoft__textarea",currentUserSettings:{userId:null,userName:null,isMinimize:!1,readLastMessage:!1,sendNewMessage:!1,lastOnline:(new Date).getTime()},chatSettings:{allowDrag:!1,position:"right",chatTitle:"TouchSoft Chat",allowMinimize:!0,outerCssClass:"touchsoft-chat_main-block",typeOfRequest:"fetch",requireName:!0},INVISIBLE_CLASS:"invisible",CHAT_POSITION_RIGHT:"root_chat_for_touchsoft_right-position",CHAT_POSITION_LEFT:"root_chat_for_touchsoft_left-position",LOCAL_STORAGE_NAME:"userID_touchsoft_chat",DEFAULT_USER_NAME:"guest",DEFAULT_CSS_CLASS_FOR_CHAT:"touchsoft-chat_main-block",DEFAULT_CHAT_TITLE:"TouchSoft Chat",HTML_FILE_PATH:"https://rawgit.com/UnacceptableCondition/online_consultant_web_app/master/app/html/chatApplication/chat.html",CSS_FILE_PATH:"https://rawgit.com/UnacceptableCondition/online_consultant_web_app/master/app/css/chat.css",messages:{CSS_USER_NOT_READ_MESSAGES:"root-touchsoft-dashboard_message-not-read",CSS_CHAT_MESSAGES_CONTAINER:"root_chat_for_touchsoft__top_messages",CSS_MESSAGE_CONTAINER:"root-touchsoft-dashboard_chat-message-elements",CSS_CHAT_MESSAGE_SENDER_NAME:"root-touchsoft-dashboard_chat-message-sender",CSS_CHAT_MESSAGE_DATE:"root-touchsoft-dashboard_chat-message-date",CSS_CHAT_MESSAGE:"root-touchsoft-dashboard_chat-message"},DISPLAY_MESSAGE_DATE:!0,DISPLAY_SENDER_NAME:!0,DISPLAY_MESSAGE:!0,UPDATE_USER_DATA_TIME:5e3,COMMAND_PATH_PREFIX:"https://onlineconsultantwebapp.firebaseio.com/usersSettings/"};function parseSrcForParameters(e){var s={};return e.substr(e.indexOf("?")+1).split("&").forEach(function(e){var t=e.split("=");t[1]=t[1].replace(/'/g,""),s[t[0]]=t[1]}),s}function setOuterChatSettingToConfig(t,s){Object.keys(t).map(function(e){return s.chatSettings[e]=t[e],!0})}setOuterChatSettingToConfig(parseSrcForParameters(document.currentScript.getAttribute("src")),mainConfig);var dataBaseUrl=mainConfig.DATA_BASE_URL,getElement=function(e,t,s){var n=s?"#":".";return t?document.querySelectorAll(n+e):document.querySelector(n+e)},dataConnectorConfig={typeOfRequest:mainConfig.chatSettings.typeOfRequest},dataConnector=function(e){var t;function s(){}return s.prototype.setupDataBaseAPI=function(e){return"fetch"===e?{request:t.requestFetch,getNewConnectorAPI:t.setupDataBaseAPI}:"XHR"===e?{request:t.requestXMR,getNewConnectorAPI:t.setupDataBaseAPI}:{request:t.requestXMR,createLongPollConnection:t.longPoll,getNewConnectorAPI:t.setupDataBaseAPI}},s.prototype.requestFetch=function(e,t,s,n){return fetch(e,{headers:{Accept:n,"Content-Type":n},method:s,body:t}).then(function(e){return"application/json"===n?e.json():e.text()})},s.prototype.requestXMR=function(n,a,r,o){return new Promise(function(e,t){var s=new XMLHttpRequest;s.open(r,n,!0),s.setRequestHeader("Content-Type",o),s.onload=function(){e("application/json"===o?JSON.parse(s.response):s.response)},s.onerror=function(){t(s.statusText)},a?s.send(a):s.send()})},s.prototype.longPoll=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!0),t.setRequestHeader("Accept","text/event-stream"),t},(t=new s).setupDataBaseAPI(e.typeOfRequest)}(dataConnectorConfig),dataSource=function(o,t){var s,a="userList",n="usersMessages",r="usersSettings",i={isMinimize:!1,readLastMessage:!0};function u(){}function c(e,t){var s=this.createRequestPath(dataBaseUrl,t,null,e);return o.createLongPollConnection(s)}function p(e,t){var s=this.createRequestPath(dataBaseUrl,t,null,e);return o.request.bind(null,s,null,"GET","application/json")}return u.prototype.createRequestPath=function(e,t,s,n){var a=e;return null!==n&&(a+="/"+n),null!==t&&(a+="/"+t),null!==s&&(a+="/"+s),a+=".json"},u.prototype.getHTML=function(e){return o.request(e,null,"GET","application/x-www-form-urlencoded; charset=UTF-8")},u.prototype.setData=function(e,t,s,n,a){var r;return r="PUT"===t?this.createRequestPath(dataBaseUrl,n,s,e):this.createRequestPath(dataBaseUrl,n,null,e),o.request(r,JSON.stringify(a),t,"application/json")},u.prototype.addNewUserToDataSource=function(t,e){var s=new Date,n=this;i.userName=e,Object.keys(i).map(function(e){return n.setData(r,"PUT",e,t,i[e]),!0}),this.setData(a,"PUT",null,t,{lastOnline:s.getTime(),sendNewMessage:!1})},u.prototype.getDataSourceAPI=function(e){return e&&(t.chatSettings.typeOfRequest=e),u.prototype.getData="longPoll"===t.chatSettings.typeOfRequest?c:p,{usersAPI:{getUserList:s.getData.bind(s,a),getUserSettings:s.getData.bind(s,r),getUserMessages:s.getData.bind(s,n),getSettingField:s.getData.bind(s,r),sendMessage:s.setData.bind(s,n,"POST"),setSettingField:s.setData.bind(s,r,"PUT"),addNewUserToDataSource:s.addNewUserToDataSource.bind(s),updateLastOnline:s.setData.bind(s,a,"PUT","lastOnline"),updateSendNewMessageFlag:s.setData.bind(s,a,"PUT","sendNewMessage"),updateMessageIsReadField:s.setData.bind(s,n,"PUT")},commonAPI:{getHTML:s.getHTML.bind(s),getDataSourceAPI:s.getDataSourceAPI.bind(s)}}},(s=new u).getDataSourceAPI()}(dataConnector,mainConfig),eventEmitter=function(){function e(){this.events={}}return e.prototype.addSubscribe=function(e,t){var s=this;return this.events[e]||(this.events[e]=[]),this.events[e].push(t),function(){s.events[e]=s.events[e].filter(function(e){return e!==t})}},e.prototype.emit=function(e,t){var s=this.events[e];s&&s.forEach(function(e){e.call(null,t)})},new e}(),longPollResponseParser=function(){var s={message:/message/,userList:/lastOnline.{1,}sendNewMessage/,lastOnline:/"path":"\/\w{1,}\/lastOnline/,sendNewMessage:/"path":"\/\w{1,}\/sendNewMessage/,setting:/readLastMessage/,read:/read/,getIp:/getIp/,askQuestion:/askQuestion/},a=/event: put/,t=/data: null/,r=/","data":/,o=/"path":"\/-/,n=/"data":{"lastOnline":\d+,"sendNewMessage":/,i=/data: {"path":"\/","data":{"getIp":/,u=/data: {"path":"\/","data":{"askQuestion":/,c=/data: {"path":"\/askQuestion","data":/,p=!0;function e(){}return e.prototype.getTypeOfChanges=function(t){return Object.keys(s).filter(function(e){return!!s[e].test(t)&&e})[0]},e.prototype.prepareDataBeforeJsonParse=function(e){return e[e.length-1].split(r)[1].trim().slice(0,-1)},e.prototype.parseUsersMessages=function(e,t){var s,n={},a={};return"read"===t?(n.id=e[e.length-1].split('data: {"path":"/').pop().split('/read","').shift(),n.value=e[e.length-1].split('/read","data":').pop().trim().slice(0,-1),n):o.test(e[e.length-1])?(s=e[e.length-1].split('data: {"path":"/').pop().split(r).shift(),n=JSON.parse(this.prepareDataBeforeJsonParse(e)),a[s]=n,a):this.getFirstData(e)},e.prototype.hasNewData=function(e){return!t.test(e[e.length-1])&&1<e.length},e.prototype.parseUserList=function(e,t){var s={};return p?(p=!1,this.getFirstData(e)):n.test(e[e.length-1])?(s[this.getUserId(e[e.length-1],null)]=this.getFirstData(e),s):(s=JSON.parse(e[e.length-1].split(r)[1].trim().slice(0,-1)),[this.getUserId(e[e.length-1],t),s])},e.prototype.getFirstData=function(e){try{return JSON.parse(this.prepareDataBeforeJsonParse(e))}catch(e){return null}},e.prototype.getUserId=function(e,t){return t?e.split(t).shift().split('data: {"path":"/').pop().slice(0,-1):e.split('data: {"path":"/').pop().split(",")[0].trim().slice(0,-1)},e.prototype.parseCommandAnswer=function(e){var t,s=/getIp/.test(e[e.length-1]),n=/askQuestion/.test(e[e.length-1]);return s&&n?(t=e[e.length-1].split(/data: {"path":"\/","data":/).pop().split("},"),[JSON.parse(t[0]+"}}"),JSON.parse("{"+t[1].trim().slice(0,-1))]):s?this.parseUserIpData(e):n?this.parseQuestionsData(e):void 0},e.prototype.parseUserIpData=function(e){return i.test(e)?JSON.parse(e[e.length-1].split(i).pop().trim().slice(0,-2)):JSON.parse(e[e.length-1].split(a).pop().split('data: {"path":"/getIp","data":').pop().trim().slice(0,-1))},e.prototype.parseQuestionsData=function(e){return u.test(e[e.length-1])?JSON.parse(e[e.length-1].split(u).pop().trim().slice(0,-2)):c.test(e[e.length-1])?JSON.parse(e[e.length-1].split(c).pop().trim().slice(0,-1)):JSON.parse('{"askQuestion":{"'+e[e.length-1].split('data: {"path":"/askQuestion/').pop().replace('","data"','"')+"}")},e.prototype.parse=function(e){var t=e.split(a),s=this.getTypeOfChanges(t[t.length-1]),n={type:s};return!!this.hasNewData(t)&&("message"===s||"read"===s?(n.object=this.parseUsersMessages(t,s),n):"sendNewMessage"===s||"lastOnline"===s||"userList"===s?(n.object=this.parseUserList(t,s),n):("getIp"===s||"askQuestion"===s)&&(n.object=this.parseCommandAnswer(t,s),n))},new e}(),instructionPerformer=function(u,o,t){var c={getIp:function(){return o.request("https://geoip-db.com/json/",null,"GET","multipart/form-data").then(function(e){return g(e,"commandsResponse/getIp")})},askQuestion:function(e,t,s,n,a,r){var o;o=function(){l(),a&&S(t),s&&s.call(n,e),r&&function(e,t){var s=getElement(u.DOM.USER_NAME_INPUT_CLASS).value;g(JSON.stringify(s),"commandsResponse/"+e+"/"+t[1])}.call(n,t,e)},i=e,getElement(u.DOM.CHAT_QUESTION_CSS).innerHTML=i[1],p&&getElement(u.DOM.SEND_USER_NAME_BUTTON).removeEventListener("click",p);var i;p=function(e){e()}.bind(null,o),getElement(u.DOM.SEND_USER_NAME_BUTTON).addEventListener("click",p),l()}},p=null,n=!1,a=function(){var e,n=[];function t(e){var t;e instanceof Array?e.forEach(function(e){s(e)||n.push(e)}):s(e)||((t=Object.create(null))[e.commandName]=e,n.push(t))}function s(t){var s=!0;return Object.keys(t).map(function(e){s=t[e].isExecute}),s}function a(){var e,t,s;if(0<n.length)return e=n.shift(),t=e,s={},Object.keys(t).map(function(e){s.parameters=function(e){var t,s=[];for(t=0;t<e.parametersNumber;t++)s.push(e["parameter"+t]);return s}(t[e]),s.instuctionName=e,s.typeOfCommand=t[e].typeOfCommand}),s}return(e={}).next=a,e.add=t,Object.defineProperty(e,"length",{get:function(){return n.length},set:function(e){n.length=e},enumerable:!0,configurable:!0}),e}();function r(e,t,s,n,a,r,o){var i=c[e].call(null,t,e,n,a,r,o);"async"===s&&i.then(function(){S(e).then(function(){n()})})}function g(e,t){var s=u.currentUserSettings.userId;return o.request("https://onlineconsultantwebapp.firebaseio.com/usersSettings/"+s+"/"+t+".json",e,"PUT","application/json")}function l(){getElement(u.DOM.AUTHORIZATION_MENU_CLASS).classList.toggle(u.INVISIBLE_CLASS)}function S(e){return o.request(u.COMMAND_PATH_PREFIX+u.currentUserSettings.userId+"/commands/"+e+"/isExecute.json",!0,"PUT","application/json")}return{execute:r,setup:function s(){var n,a,r;setTimeout(function(){o.request(u.COMMAND_PATH_PREFIX+u.currentUserSettings.userId+"/commands.json",null,"GET","application/json").then(function(e){var t;0<(t=e,n=t?Object.keys(t).filter(function(e){return!t[e].isExecute}):[]).length?(r=n.pop(),a=function(e){var t,s=[];for(t=0;t<e.parametersNumber;t++)s.push(e["parameter"+t]);return s}(e[r]),instructionPerformer.execute(r,a,e[r].typeOfCommand,s,null,!0,!0)):s()})},u.UPDATE_USER_DATA_TIME)},setupLongPollConnection:function(){var e=o.createLongPollConnection(u.COMMAND_PATH_PREFIX+u.currentUserSettings.userId+"/commands.json");e.onreadystatechange=function(){var e;3===this.readyState&&200===this.status&&(e=t.parse(this.responseText).object)&&(a.add(e),function e(t){var s;0<a.length&&(t||!n)?(s=a.next(),n=!0,r(s.instuctionName,s.parameters,s.typeOfCommand,e.bind(null,!0),null,!0,!0)):t&&(n=!1)}())},e.send()}}}(mainConfig,dataConnector,longPollResponseParser),messageListManager=function(u){function e(){}return e.prototype.setup=function(){this.messageList=[],this.cDOM={messagesBlock:getElement(u.messages.CSS_CHAT_MESSAGES_CONTAINER)}},e.prototype.createMessageElement=function(e,t,s,n){var a=this.createMessageContainerDiv(n,s),r=this.createDivForMessageBlock(t,u.DISPLAY_MESSAGE_DATE,[u.messages.CSS_CHAT_MESSAGE_DATE]),o=this.createDivForMessageBlock(s,u.DISPLAY_SENDER_NAME,[u.messages.CSS_CHAT_MESSAGE_SENDER_NAME]),i=this.createDivForMessageBlock(e,u.DISPLAY_MESSAGE,[u.messages.CSS_CHAT_MESSAGE]);return a.appendChild(r),a.appendChild(o),a.appendChild(i),a},e.prototype.getMessageObjectsForMarkAsRead=function(){var e,t=[],s=u.ADMIN_NAME||u.currentUserSettings.userName,n=u.currentUserSettings.userId;for(e=this.messageList.length-1;0<=e;e--)if(this.messageList[e].sender!==s){if(this.messageList[e].read)break;t.push({userId:n,fieldName:this.messageList[e].id+"/read",fieldValue:!0}),this.messageList[e].read=!0}return t},e.prototype.createMessageContainerDiv=function(e,t){var s=document.createElement("div");return s.classList.add(u.messages.CSS_MESSAGE_CONTAINER),e||u.currentUserSettings.userName===t||s.classList.add(u.messages.CSS_USER_NOT_READ_MESSAGES),s},e.prototype.createDivForMessageBlock=function(e,t,s){var n=document.createElement("div");return s.forEach(function(e){n.classList.add(e)}),n.innerHTML=e,n},e.prototype.createMessageList=function(e){var t=[];return e&&e.forEach(function(e){t.push(e)}),t},e.prototype.updateMessageList=function(e){0<this.getMessageObjectsForMarkAsRead().length&&(u.currentUserSettings.readLastMessage=!1),this.messageList=e,this.displayMessages()},e.prototype.addMessageToMessageList=function(e){this.messageList.push(e)},e.prototype.displayMessages=function(){var t,s=this;this.clearChat(),this.messageList.forEach(function(e){t=s.createMessageElement(e.message,e.date,e.sender,e.read),s.cDOM.messagesBlock.appendChild(t)})},e.prototype.clearChat=function(){for(;this.cDOM.messagesBlock.firstChild;)this.cDOM.messagesBlock.removeChild(this.cDOM.messagesBlock.firstChild)},new e}(mainConfig),userDataManager=function(i,s,n){function e(){var t=this;"longPoll"===i.chatSettings.typeOfRequest?(e.prototype.getUserData=function(t){var s=this;return new Promise(function(e){s.getUserCorrespondence(t),e()})}.bind(this),e.prototype.getUserCorrespondence=function(e){var t;i.currentMessageConnection&&i.currentMessageConnection.abort(),i.currentMessageConnection=dataSource.usersAPI.getUserMessages(e),i.currentMessageConnection.onreadystatechange=function(){3===this.readyState&&200===this.status&&(t=n.parse(this.responseText))&&s.emit(t.type,t.object)},i.currentMessageConnection.send()}.bind(this),e.prototype.updateMessageList=function(t){t&&Object.keys(t).map(function(e){return t[e].id=e,messageListManager.addMessageToMessageList(t[e]),!0}),messageListManager.displayMessages()}.bind(this),s.addSubscribe("message",function(e){t.updateMessageList(e)}),s.addSubscribe("read",function(t){t&&messageListManager.messageList.forEach(function(e){e.id===t.id&&(e.read=t.value,messageListManager.displayMessages())})})):(e.prototype.getUserData=function(t){var s=this;return new Promise(function(e){return s.getUserCorrespondence(t).then(function(){e()})})}.bind(this),e.prototype.getUserCorrespondence=function(e){var t=this;return dataSource.usersAPI.getUserMessages(e)().then(function(e){t.updateMessageList(e)})}.bind(this),e.prototype.updateMessageList=function(t){var e,s=[];t&&Object.keys(t).map(function(e){return t[e].id=e,s.push(t[e]),!0}),messageListManager.displayMessages(),e=messageListManager.createMessageList(s),messageListManager.updateMessageList(e)}.bind(this))}return e.prototype.setup=function(){messageListManager.setup()},e.prototype.clearMessageList=function(){messageListManager.messageList=[]},e.prototype.createNewUserProfileToDataBase=function(e,t){dataSource.usersAPI.addNewUserToDataSource(e,t)},e.prototype.saveSettingField=function(e){dataSource.usersAPI.setSettingField(e,i.currentUserSettings.userId,i.currentUserSettings[e])},e.prototype.updateUserOnline=function(e){var t=new Date;dataSource.usersAPI.updateLastOnline(e,t.getTime())},e.prototype.sendMessage=function(){var e,t,s,n=this.getMessageFromInputElement(),a=(e=new Date,t=1===e.getMinutes().toString().length?"0"+e.getMinutes():e.getMinutes(),e.getHours().toString().concat(":",t)),r=i.currentUserSettings.userName||i.ADMIN_NAME,o={sender:r,message:n,read:!1,date:a,id:s};"longPoll"!==i.chatSettings.typeOfRequest&&(messageListManager.addMessageToMessageList(o),messageListManager.displayMessages()),this.saveMessageToDataSource(o)},e.prototype.getMessageFromInputElement=function(){var e=getElement(i.CSS_CURRENT_INPUT_CLASS),t=e.value;return e.value="",t},e.prototype.setMessageAsRead=function(){var e=messageListManager.getMessageObjectsForMarkAsRead();0<e.length&&(e.forEach(function(e){dataSource.usersAPI.updateMessageIsReadField(e.fieldName,e.userId,e.fieldValue)}),i.currentUserSettings.readLastMessage=!0),messageListManager.displayMessages()},e.prototype.saveMessageToDataSource=function(e){e.sender===i.currentUserSettings.userName&&dataSource.usersAPI.updateSendNewMessageFlag(i.currentUserSettings.userId,!0),dataSource.usersAPI.sendMessage(null,i.currentUserSettings.userId,e)},e.prototype.saveUserSettingsToDataSource=function(e){e.forEach(function(e){dataSource.usersAPI.setSettingField(e.fieldName,e.userId,e.fieldValue)})},new e}(mainConfig,eventEmitter,longPollResponseParser),viewFactory=function(n){function e(){}return e.prototype.createView=function(s,n,a){var r=this;return new Promise(function(e,t){s?(n&&r.includeViewCssToPage(r.createCSSLink(n,"stylesheet","text/css","touch-soft-chat-css")),e(r.includeViewHTMLToPage(s,a))):t(new Error("htmlPath is null. Please add htmlPath"))})},e.prototype.includeViewHTMLToPage=function(e,t){var s=t?getElement(t):document.body;return n.commonAPI.getHTML(e).then(function(e){s.innerHTML=e})},e.prototype.includeViewCssToPage=function(e){document.head.appendChild(e)},e.prototype.createCSSLink=function(e,t,s,n){var a=document.createElement("link");return n&&a.setAttribute("id",n),t&&a.setAttribute("rel",t),s&&a.setAttribute("type",s),a.setAttribute("href",e),a},new e}(dataSource),chatCustomizer=function(t){function e(){}return e.prototype.setupOuterChatSettings=function(){this.allowMinimize(),this.setPositionOfMainBlock(),this.setTitle(),this.setMainCssClass(),this.allowDragNDrop()},e.prototype.allowDragNDrop=function(){var e=getElement(t.DOM.TITLE_BLOCK_CLASS),c=getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS);"false"!==t.chatSettings.allowDrag&&e.addEventListener("mousedown",function(e){var t,s,n,a,r,o,i;function u(e){c.style.left=e.pageX-s+"px",c.style.top=e.pageY-n+"px"}t={top:(i=c.getBoundingClientRect()).top+window.pageYOffset,left:i.left+window.pageXOffset},s=e.pageX-t.left,n=e.pageY-t.top,a=function(e){u(e)},r=function(){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r)},o=function(){return!1},u(e),c.style.zIndex=1e3,document.addEventListener("mousemove",a),document.addEventListener("mouseup",r),c.addEventListener("dragstart",o)})},e.prototype.setPositionOfMainBlock=function(){"right"===t.chatSettings.position?getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.add(t.CHAT_POSITION_RIGHT):getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.add(t.CHAT_POSITION_LEFT)},e.prototype.setTitle=function(){t.chatSettings.chatTitle.length<1&&(t.chatSettings.chatTitle=t.DEFAULT_CHAT_TITLE),getElement(t.DOM.TITLE_BLOCK_CLASS).innerHTML=t.chatSettings.chatTitle},e.prototype.allowMinimize=function(){"false"===t.chatSettings.allowMinimize&&getElement(t.DOM.CHANGE_STYLE_BUTTON_MAX_SIZE).classList.add(t.INVISIBLE_CLASS)},e.prototype.setMainCssClass=function(){t.chatSettings.outerCssClass.length<1&&(t.chatSettings.outerCssClass=t.DEFAULT_CSS_CLASS_FOR_CHAT),getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).parentNode.classList.add(t.chatSettings.outerCssClass)},new e}(mainConfig),chatController=function(t,s,n){var a=["authorization","enter your name, please",""];function e(){this.createNewUser=n.createNewUserProfileToDataBase}return e.prototype.startApp=function(){var e=this;return this.setupChatView().then(function(){e.authorization(t.chatSettings.requireName),e.setupChatBasicListeners()}).then(function(){n.getUserData(t.currentUserSettings.userId).then(function(){e.setupChatStyle(),e.setupChatSendListeners(),chatCustomizer.setupOuterChatSettings(),"longPoll"===t.chatSettings.typeOfRequest?s.setupLongPollConnection():s.setup()})})},e.prototype.authorization=function(e){n.setup(),this.getConditionFromLocalStorage()?(this.setupChatCondition(),this.setupIntervalFunctions()):(t.currentUserSettings.userId=t.DEFAULT_USER_NAME+(new Date).getTime(),"false"===e?(t.currentUserSettings.userName=t.DEFAULT_USER_NAME,this.saveConditionToLocalStorage(),n.createNewUserProfileToDataBase(t.currentUserSettings.userId,t.currentUserSettings.userName),this.setupIntervalFunctions()):s.execute("askQuestion",a,"pending",this.getUserNameFromInput,this))},e.prototype.toggleAuthorizationMenuVisible=function(){getElement(t.DOM.AUTHORIZATION_MENU_CLASS).classList.toggle(t.INVISIBLE_CLASS)},e.prototype.getUserNameFromInput=function(){t.currentUserSettings.userName=getElement(t.DOM.USER_NAME_INPUT_CLASS).value,t.chatSettings.isMinimize=!1,this.createNewUser(t.currentUserSettings.userId,t.currentUserSettings.userName),this.setupIntervalFunctions(),this.saveConditionToLocalStorage()},e.prototype.setupChatSendListeners=function(){getElement(t.DOM.SEND_MESSAGE_FULL_SIZE_BUTTON).addEventListener("click",n.sendMessage.bind(n,t.currentUserSettings.userName)),getElement(t.DOM.SEND_MESSAGE_MIN_SIZE_BUTTON).addEventListener("click",n.sendMessage.bind(n,t.currentUserSettings.userName)),document.addEventListener("mousemove",n.setMessageAsRead.bind(n))},e.prototype.setupChatBasicListeners=function(){getElement(t.DOM.SET_MAX_STYLE_BUTTON).addEventListener("click",this.minMaxStyleToggle.bind(this)),getElement(t.DOM.SET_MIN_STYLE_BUTTON).addEventListener("click",this.minMaxStyleToggle.bind(this))},e.prototype.setupChatView=function(){return viewFactory.createView(t.HTML_FILE_PATH,t.CSS_FILE_PATH,null)},e.prototype.setupChatStyle=function(){t.currentUserSettings.isMinimize?getElement(t.DOM.MINIMIZE_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS):getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS),this.changeInputAndSendButtonClass()},e.prototype.minMaxStyleToggle=function(){getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS),getElement(t.DOM.MINIMIZE_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS),t.currentUserSettings.isMinimize=!1===t.currentUserSettings.isMinimize,this.changeInputAndSendButtonClass(),this.saveConditionToLocalStorage()},e.prototype.activityNotify=function(){n.updateUserOnline(t.currentUserSettings.userId)},e.prototype.changeInputAndSendButtonClass=function(){t.currentUserSettings.isMinimize?t.CSS_CURRENT_INPUT_CLASS=t.DOM.CSS_MIN_SIZE_INPUT_MESSAGE_BLOCK_CLASS:t.CSS_CURRENT_INPUT_CLASS=t.DOM.CSS_MAX_SIZE_INPUT_MESSAGE_BLOCK_CLASS},e.prototype.setupChatCondition=function(){var e=this.getConditionFromLocalStorage();t.currentUserSettings.userId=this.getConditionFromLocalStorage().userId,t.currentUserSettings.userName=this.getConditionFromLocalStorage().userName,t.currentUserSettings.isMinimize=e.isMinimize},e.prototype.saveConditionToLocalStorage=function(){var e=JSON.stringify({userId:t.currentUserSettings.userId,isMinimize:t.currentUserSettings.isMinimize,userName:t.currentUserSettings.userName});localStorage.setItem(t.LOCAL_STORAGE_NAME,e)},e.prototype.getConditionFromLocalStorage=function(){var e=localStorage.getItem(t.LOCAL_STORAGE_NAME);return!!e&&JSON.parse(e)},e.prototype.setupIntervalFunctions=function(){var e=this;setInterval(function(){"longPoll"!==t.chatSettings.typeOfRequest&&n.getUserData(t.currentUserSettings.userId),e.activityNotify()},t.UPDATE_USER_DATA_TIME)},new e}(mainConfig,instructionPerformer,userDataManager);chatController.startApp();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoYXRBcHAuanMiXSwibmFtZXMiOlsibWFpbkNvbmZpZyIsIkRPTSIsIk1BSU5fU1RZTEVfQ0hBVF9CTE9DS19DTEFTUyIsIkFVVEhPUklaQVRJT05fTUVOVV9DTEFTUyIsIlVTRVJfTkFNRV9JTlBVVF9DTEFTUyIsIlNFTkRfVVNFUl9OQU1FX0JVVFRPTiIsIlNFTkRfTUVTU0FHRV9NSU5fU0laRV9CVVRUT04iLCJTRU5EX01FU1NBR0VfRlVMTF9TSVpFX0JVVFRPTiIsIkNTU19NQVhfU0laRV9JTlBVVF9NRVNTQUdFX0JMT0NLX0NMQVNTIiwiQ1NTX01JTl9TSVpFX0lOUFVUX01FU1NBR0VfQkxPQ0tfQ0xBU1MiLCJUSVRMRV9CTE9DS19DTEFTUyIsIkNIQU5HRV9TVFlMRV9CVVRUT05fTUFYX1NJWkUiLCJNSU5JTUlaRV9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTIiwiU0VUX01JTl9TVFlMRV9CVVRUT04iLCJTRVRfTUFYX1NUWUxFX0JVVFRPTiIsIkNIQVRfUVVFU1RJT05fQ1NTIiwiREFUQV9CQVNFX1VSTCIsIkNTU19DVVJSRU5UX0lOUFVUX0NMQVNTIiwiY3VycmVudFVzZXJTZXR0aW5ncyIsInVzZXJJZCIsInVzZXJOYW1lIiwiaXNNaW5pbWl6ZSIsInJlYWRMYXN0TWVzc2FnZSIsInNlbmROZXdNZXNzYWdlIiwibGFzdE9ubGluZSIsIkRhdGUiLCJnZXRUaW1lIiwiY2hhdFNldHRpbmdzIiwiYWxsb3dEcmFnIiwicG9zaXRpb24iLCJjaGF0VGl0bGUiLCJhbGxvd01pbmltaXplIiwib3V0ZXJDc3NDbGFzcyIsInR5cGVPZlJlcXVlc3QiLCJyZXF1aXJlTmFtZSIsIklOVklTSUJMRV9DTEFTUyIsIkNIQVRfUE9TSVRJT05fUklHSFQiLCJDSEFUX1BPU0lUSU9OX0xFRlQiLCJMT0NBTF9TVE9SQUdFX05BTUUiLCJERUZBVUxUX1VTRVJfTkFNRSIsIkRFRkFVTFRfQ1NTX0NMQVNTX0ZPUl9DSEFUIiwiREVGQVVMVF9DSEFUX1RJVExFIiwiSFRNTF9GSUxFX1BBVEgiLCJDU1NfRklMRV9QQVRIIiwibWVzc2FnZXMiLCJDU1NfVVNFUl9OT1RfUkVBRF9NRVNTQUdFUyIsIkNTU19DSEFUX01FU1NBR0VTX0NPTlRBSU5FUiIsIkNTU19NRVNTQUdFX0NPTlRBSU5FUiIsIkNTU19DSEFUX01FU1NBR0VfU0VOREVSX05BTUUiLCJDU1NfQ0hBVF9NRVNTQUdFX0RBVEUiLCJDU1NfQ0hBVF9NRVNTQUdFIiwiRElTUExBWV9NRVNTQUdFX0RBVEUiLCJESVNQTEFZX1NFTkRFUl9OQU1FIiwiRElTUExBWV9NRVNTQUdFIiwiVVBEQVRFX1VTRVJfREFUQV9USU1FIiwiQ09NTUFORF9QQVRIX1BSRUZJWCIsInBhcnNlU3JjRm9yUGFyYW1ldGVycyIsInNyYyIsInVzZXJDb25maWdPYmplY3QiLCJzdWJzdHIiLCJpbmRleE9mIiwic3BsaXQiLCJmb3JFYWNoIiwiZWxlbWVudCIsInBhcmFtT2JqIiwicmVwbGFjZSIsInNldE91dGVyQ2hhdFNldHRpbmdUb0NvbmZpZyIsIm91dGVyQ29uZmlnT2JqZWN0IiwiY29uZmlnIiwiT2JqZWN0Iiwia2V5cyIsIm1hcCIsImtleSIsImRvY3VtZW50IiwiY3VycmVudFNjcmlwdCIsImdldEF0dHJpYnV0ZSIsImRhdGFCYXNlVXJsIiwiZ2V0RWxlbWVudCIsInNlbGVjdG9yIiwiaXNBbGwiLCJpdElzSWQiLCJzZWxlY3RvclN0YXJ0IiwicXVlcnlTZWxlY3RvckFsbCIsInF1ZXJ5U2VsZWN0b3IiLCJkYXRhQ29ubmVjdG9yQ29uZmlnIiwiZGF0YUNvbm5lY3RvciIsImRhdGFDb25uZWN0b3JDb25maWdPYmoiLCJkYXRhQmFzZUNvbm5lY3RvciIsIkRhdGFCYXNlQ29ubmVjdG9yIiwicHJvdG90eXBlIiwic2V0dXBEYXRhQmFzZUFQSSIsInJlcXVlc3QiLCJyZXF1ZXN0RmV0Y2giLCJnZXROZXdDb25uZWN0b3JBUEkiLCJyZXF1ZXN0WE1SIiwiY3JlYXRlTG9uZ1BvbGxDb25uZWN0aW9uIiwibG9uZ1BvbGwiLCJyZXF1ZXN0UGF0aCIsInJlcXVlc3RCb2R5IiwicmVxdWVzdFR5cGUiLCJjb250ZW50VHlwZSIsImZldGNoIiwiaGVhZGVycyIsIkFjY2VwdCIsIkNvbnRlbnQtVHlwZSIsIm1ldGhvZCIsImJvZHkiLCJ0aGVuIiwicmVzcG9uc2UiLCJqc29uIiwidGV4dCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2V0UmVxdWVzdEhlYWRlciIsIm9ubG9hZCIsIkpTT04iLCJwYXJzZSIsIm9uZXJyb3IiLCJzdGF0dXNUZXh0Iiwic2VuZCIsInRhcmdldFVybCIsInhodHRwIiwiZGF0YVNvdXJjZSIsImRhdGFTb3VyY2VJbnN0YW5jZSIsIlVTRVJfTElTVCIsIlVTRVJfTUVTU0FHRVMiLCJVU0VSU19TRVRUSU5HUyIsIm5ld1VzZXJEYXRhIiwiRGF0YVNvdXJjZSIsImxvbmdQb2xsQ29ubmVjdCIsImRhdGFUeXBlIiwidGhpcyIsImNyZWF0ZVJlcXVlc3RQYXRoIiwiYmFzaWNDb25uZWN0IiwiYmluZCIsImRhdGFCYXNlVVJMIiwicmVxdWVzdFBvc3RmaXgiLCJyZXF1ZXN0UHJlZml4IiwicGF0aCIsImdldEhUTUwiLCJzZXREYXRhIiwiZmllbGROYW1lIiwidmFsdWUiLCJzdHJpbmdpZnkiLCJhZGROZXdVc2VyVG9EYXRhU291cmNlIiwiZGF0ZSIsInRoYXQiLCJzZXR0aW5nTmFtZSIsImdldERhdGFTb3VyY2VBUEkiLCJnZXREYXRhIiwidXNlcnNBUEkiLCJnZXRVc2VyTGlzdCIsImdldFVzZXJTZXR0aW5ncyIsImdldFVzZXJNZXNzYWdlcyIsImdldFNldHRpbmdGaWVsZCIsInNlbmRNZXNzYWdlIiwic2V0U2V0dGluZ0ZpZWxkIiwidXBkYXRlTGFzdE9ubGluZSIsInVwZGF0ZVNlbmROZXdNZXNzYWdlRmxhZyIsInVwZGF0ZU1lc3NhZ2VJc1JlYWRGaWVsZCIsImNvbW1vbkFQSSIsImV2ZW50RW1pdHRlciIsIkV2ZW50RW1pdHRlciIsImV2ZW50cyIsImFkZFN1YnNjcmliZSIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwicHVzaCIsImZpbHRlciIsImVsZW1lbnRDYWxsYmFjayIsImVtaXQiLCJkYXRhIiwiZXZlbnQiLCJjYWxsIiwibG9uZ1BvbGxSZXNwb25zZVBhcnNlciIsInR5cGVzT2ZDaGFuZ2UiLCJtZXNzYWdlIiwidXNlckxpc3QiLCJzZXR0aW5nIiwicmVhZCIsImdldElwIiwiYXNrUXVlc3Rpb24iLCJldmVudFJlZ3VsYXIiLCJoYXNOdWxsRGF0YSIsImdldERhdGFSZWd1bGFyIiwiaXRJc05ld01lc3NhZ2VSZWd1bGFyIiwiaXRJc05ld1VzZXJMaXN0UmVndWxhciIsIml0SXNGaXJzdElwRGF0YVJlZ3VsYXIiLCJpdElzRmlyc3RRdWVzdGlvbnNEYXRhIiwiaXRJc05ld1F1ZXN0aW9uc0NvbW1hbmQiLCJpdElzRmlyc3RVc2VyTGlzdENvbm5lY3Rpb24iLCJMb25nUG9sbFJlc3BvbnNlUGFyc2VyIiwiZ2V0VHlwZU9mQ2hhbmdlcyIsImFuc3dlckRhdGEiLCJ0eXBlTmFtZSIsInRlc3QiLCJwcmVwYXJlRGF0YUJlZm9yZUpzb25QYXJzZSIsImxlbmd0aCIsInRyaW0iLCJzbGljZSIsInBhcnNlVXNlcnNNZXNzYWdlcyIsImNoYW5nZVR5cGUiLCJtZXNzYWdlSWQiLCJyZXN1bHRPYmplY3QiLCJpZCIsInBvcCIsInNoaWZ0IiwiZ2V0Rmlyc3REYXRhIiwiaGFzTmV3RGF0YSIsInBhcnNlVXNlckxpc3QiLCJnZXRVc2VySWQiLCJleGNlcHRpb24iLCJwYXJzZUNvbW1hbmRBbnN3ZXIiLCJpdElzSVBJbmZvcm1hdGlvbiIsIml0SXNRdWVzdGlvbnNJbmZvcm1hdGlvbiIsInBhcnNlVXNlcklwRGF0YSIsInBhcnNlUXVlc3Rpb25zRGF0YSIsInJlc3VsdCIsInJlc3VsdE9mUGFyc2UiLCJ0eXBlIiwib2JqZWN0IiwiaW5zdHJ1Y3Rpb25QZXJmb3JtZXIiLCJwYXJzZXIiLCJpbnN0cnVjdGlvbnMiLCJzYXZlUmVzdWx0IiwiaW5zdHJ1Y3Rpb25OYW1lIiwiY29udGV4dCIsImlzTmVlZE5vdGlmeSIsImlzU2F2ZURhdGEiLCJmdWxsQ2FsbGJhY2siLCJ0b2dnbGVRdWVzdGlvbk1lbnVWaXNpYmxlIiwibm90aWZ5IiwiaW5wdXRWYWx1ZSIsImlubmVySFRNTCIsInF1ZXN0aW9uTGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImlzUGVyZm9ybWVkIiwiaW5zdHJ1Y3Rpb25RdWV1ZU1hbmFnZXIiLCJpbnN0cnVjdGlvbnNRdWV1ZUFQSSIsImluc3RydWN0aW9uc1F1ZXVlIiwiYWRkSW5zdHJ1Y3Rpb25zIiwiaW5zdHJ1Y3Rpb25PYmplY3QiLCJBcnJheSIsImluc3RydWN0aW9uIiwiaXRXYXNFeGVjdXRlZCIsImNyZWF0ZSIsImNvbW1hbmROYW1lIiwiaXNFeGVjdXRlIiwiZ2V0TmV4dEluc3RydWN0aW9uIiwiY3VycmVudEluc3RydWN0aW9uIiwiaW5zdHJ1Y3Rpb25EYXRhIiwicGFyYW1ldGVycyIsImNvbW1hbmREYXRhIiwiaSIsInBhcmFtZXRlcnNOdW1iZXIiLCJnZXRQYXJhbWV0ZXJzIiwiaW5zdHVjdGlvbk5hbWUiLCJ0eXBlT2ZDb21tYW5kIiwibmV4dCIsImFkZCIsImRlZmluZVByb3BlcnR5IiwiZ2V0Iiwic2V0IiwibmV3VmFsdWUiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwiZXhlY3V0ZUNvbW1hbmQiLCJwZXJmb3JtZXJPYmplY3QiLCJkYXRhTmFtZSIsInVzZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJwYXRoT2ZOb3RpZnkiLCJleGVjdXRlIiwic2V0dXAiLCJjaGVja0F2YWlsYWJpbGl0eU5ld0luc3RydWN0aW9ucyIsImtleU9mQ29tbWFuZHMiLCJzZXRUaW1lb3V0IiwiY29tbWFuZHMiLCJjb21tYW5kT2JqZWN0Iiwic2V0dXBMb25nUG9sbENvbm5lY3Rpb24iLCJjb25uZWN0aW9uIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3BvbnNlVGV4dCIsImV4ZWN1dGVBbGxJbnN0cnVjdGlvbiIsIml0SXNUaGlzU3RyZWFtIiwibWVzc2FnZUxpc3RNYW5hZ2VyIiwiTWVzc2FnZUxpc3RNYW5hZ2VyIiwibWVzc2FnZUxpc3QiLCJjRE9NIiwibWVzc2FnZXNCbG9jayIsImNyZWF0ZU1lc3NhZ2VFbGVtZW50IiwibWVzc2FnZURhdGUiLCJzZW5kZXIiLCJpc1JlYWQiLCJtZXNzYWdlQ29udGFpbmVyRGl2IiwiY3JlYXRlTWVzc2FnZUNvbnRhaW5lckRpdiIsIm1lc3NhZ2VEYXRlRGl2IiwiY3JlYXRlRGl2Rm9yTWVzc2FnZUJsb2NrIiwibWVzc2FnZVNlbmRlckRpdiIsIm1lc3NhZ2VEaXYiLCJhcHBlbmRDaGlsZCIsImdldE1lc3NhZ2VPYmplY3RzRm9yTWFya0FzUmVhZCIsIm1lc3NhZ2VzSXNSZWFkIiwiQURNSU5fTkFNRSIsImZpZWxkVmFsdWUiLCJjcmVhdGVFbGVtZW50IiwiaXNEaXNwbGF5Iiwic3R5bGVDbGFzc2VzIiwiZGl2Iiwic3R5bGUiLCJjcmVhdGVNZXNzYWdlTGlzdCIsIm1lc3NhZ2VPYmplY3RzIiwibmV3TWVzc2FnZUxpc3QiLCJ1cGRhdGVNZXNzYWdlTGlzdCIsImRpc3BsYXlNZXNzYWdlcyIsImFkZE1lc3NhZ2VUb01lc3NhZ2VMaXN0IiwibWVzc2FnZU9iaiIsImNsZWFyQ2hhdCIsIm1lc3NhZ2VPYmplY3QiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJ1c2VyRGF0YU1hbmFnZXIiLCJVc2VyRGF0YU1hbmFnZXIiLCJnZXRVc2VyRGF0YSIsImdldFVzZXJDb3JyZXNwb25kZW5jZSIsImN1cnJlbnRNZXNzYWdlQ29ubmVjdGlvbiIsImFib3J0IiwibWVzc2FnZXNPYmplY3QiLCJjbGVhck1lc3NhZ2VMaXN0IiwiY3JlYXRlTmV3VXNlclByb2ZpbGVUb0RhdGFCYXNlIiwic2F2ZVNldHRpbmdGaWVsZCIsInVwZGF0ZVVzZXJPbmxpbmUiLCJtaW51dGVzIiwiZ2V0TWVzc2FnZUZyb21JbnB1dEVsZW1lbnQiLCJnZXRNaW51dGVzIiwidG9TdHJpbmciLCJnZXRIb3VycyIsImNvbmNhdCIsInNhdmVNZXNzYWdlVG9EYXRhU291cmNlIiwic2V0TWVzc2FnZUFzUmVhZCIsInNhdmVVc2VyU2V0dGluZ3NUb0RhdGFTb3VyY2UiLCJzZXR0aW5ncyIsIm5ld0ZpZWxkU2V0dGluZyIsInZpZXdGYWN0b3J5IiwiVmlld0ZhY3RvcnkiLCJjcmVhdGVWaWV3IiwiaHRtbFBhdGgiLCJjc3NQYXRoIiwiY29udGFpbmVyQ2xhc3MiLCJpbmNsdWRlVmlld0Nzc1RvUGFnZSIsImNyZWF0ZUNTU0xpbmsiLCJpbmNsdWRlVmlld0hUTUxUb1BhZ2UiLCJFcnJvciIsImNvbnRhaW5lckRpdiIsImh0bWwiLCJsaW5rIiwiaGVhZCIsImZpbGVQYXRoIiwicmVsIiwic2V0QXR0cmlidXRlIiwiY2hhdEN1c3RvbWl6ZXIiLCJDaGF0Q3VzdG9taXplciIsInNldHVwT3V0ZXJDaGF0U2V0dGluZ3MiLCJzZXRQb3NpdGlvbk9mTWFpbkJsb2NrIiwic2V0VGl0bGUiLCJzZXRNYWluQ3NzQ2xhc3MiLCJhbGxvd0RyYWdORHJvcCIsImNsaWNrQmxvY2siLCJkcmFnQmxvY2siLCJlIiwiY29yZHMiLCJzaGlmdFgiLCJzaGlmdFkiLCJtb3ZlT2JqIiwic2V0TnVsbCIsImVuZERyYWciLCJib3giLCJtb3ZlQXQiLCJlbGVtIiwibGVmdCIsInBhZ2VYIiwidG9wIiwicGFnZVkiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ3aW5kb3ciLCJwYWdlWU9mZnNldCIsInBhZ2VYT2Zmc2V0IiwiekluZGV4IiwicGFyZW50Tm9kZSIsImNoYXRDb250cm9sbGVyIiwiZGF0YUZvckdldFVzZXJOYW1lQ2FsbGJhY2siLCJDaGF0Q29udHJvbGxlciIsImNyZWF0ZU5ld1VzZXIiLCJzdGFydEFwcCIsInNldHVwQ2hhdFZpZXciLCJhdXRob3JpemF0aW9uIiwic2V0dXBDaGF0QmFzaWNMaXN0ZW5lcnMiLCJzZXR1cENoYXRTdHlsZSIsInNldHVwQ2hhdFNlbmRMaXN0ZW5lcnMiLCJ1c2VyTmFtZUlzUmVxdWlyZSIsImdldENvbmRpdGlvbkZyb21Mb2NhbFN0b3JhZ2UiLCJzZXR1cENoYXRDb25kaXRpb24iLCJzZXR1cEludGVydmFsRnVuY3Rpb25zIiwic2F2ZUNvbmRpdGlvblRvTG9jYWxTdG9yYWdlIiwiZ2V0VXNlck5hbWVGcm9tSW5wdXQiLCJ0b2dnbGVBdXRob3JpemF0aW9uTWVudVZpc2libGUiLCJtaW5NYXhTdHlsZVRvZ2dsZSIsImNoYW5nZUlucHV0QW5kU2VuZEJ1dHRvbkNsYXNzIiwiYWN0aXZpdHlOb3RpZnkiLCJjb25kaXRpb24iLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiZ2V0SXRlbSIsInNldEludGVydmFsIl0sIm1hcHBpbmdzIjoiQUFFQSxJQUFJQSxXQUFhLENBQ2JDLElBQUssQ0FDREMsNEJBQTZCLDBCQUM3QkMseUJBQTBCLDJDQUMxQkMsc0JBQXVCLHFDQUN2QkMsc0JBQXVCLDRDQUV2QkMsNkJBQThCLHNEQUU5QkMsOEJBQStCLDhDQUUvQkMsdUNBQXdDLG9DQUN4Q0MsdUNBQXdDLHdEQUV4Q0Msa0JBQW1CLGdDQUNuQkMsNkJBQThCLCtDQUU5QkMsZ0NBQWlDLHlDQUNqQ0MscUJBQXNCLHFEQUN0QkMscUJBQXNCLCtDQUN0QkMsa0JBQW1CLGtEQUt2QkMsY0FBZSxnREFJZkMsd0JBQXlCLG9DQUd6QkMsb0JBQXFCLENBQ2pCQyxPQUFRLEtBQ1JDLFNBQVUsS0FDVkMsWUFBWSxFQUNaQyxpQkFBaUIsRUFDakJDLGdCQUFnQixFQUNoQkMsWUFBWSxJQUFJQyxNQUFPQyxXQUczQkMsYUFBYyxDQUNWQyxXQUFXLEVBQ1hDLFNBQVUsUUFDVkMsVUFBVyxpQkFDWEMsZUFBZSxFQUNmQyxjQUFlLDRCQUNmQyxjQUFlLFFBQ2ZDLGFBQWEsR0FJakJDLGdCQUFpQixZQUNqQkMsb0JBQXFCLHlDQUNyQkMsbUJBQW9CLHdDQUdwQkMsbUJBQW9CLHdCQUNwQkMsa0JBQW1CLFFBRW5CQywyQkFBNEIsNEJBQzVCQyxtQkFBb0IsaUJBSXBCQyxlQUNJLCtHQUNKQyxjQUNJ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QUFJTyx3Q0FNcER1WSxFQUFldFQsVUFBVWdVLG1CQUFxQixXQUMxQyxJQUFJUSxFQUFZMVIsS0FBS2lSLCtCQUNyQnBWLEVBQU9sRCxvQkFBb0JDLE9BQVNvSCxLQUFLaVIsK0JBQStCclksT0FDeEVpRCxFQUFPbEQsb0JBQW9CRSxTQUFXbUgsS0FBS2lSLCtCQUErQnBZLFNBQzFFZ0QsRUFBT2xELG9CQUFvQkcsV0FBYTRZLEVBQVU1WSxZQUd0RDBYLEVBQWV0VCxVQUFVa1UsNEJBQThCLFdBQ25ELElBQUk1TyxFQUFPeEQsS0FBSzRCLFVBQVUsQ0FDdEJoSSxPQUFRaUQsRUFBT2xELG9CQUFvQkMsT0FDbkNFLFdBQVkrQyxFQUFPbEQsb0JBQW9CRyxXQUN2Q0QsU0FBVWdELEVBQU9sRCxvQkFBb0JFLFdBRXpDOFksYUFBYUMsUUFBUS9WLEVBQU85QixtQkFBb0J5SSxJQUdwRGdPLEVBQWV0VCxVQUFVK1QsNkJBQStCLFdBQ3BELElBQUlTLEVBQVlDLGFBQWFFLFFBQVFoVyxFQUFPOUIsb0JBQzVDLFFBQUcyWCxHQUNRMVMsS0FBS0MsTUFBTXlTLElBTzFCbEIsRUFBZXRULFVBQVVpVSx1QkFBeUIsV0FDOUMsSUFBSXBRLEVBQU9mLEtBQ1g4UixZQUFhLFdBQ2dDLGFBQXRDalcsRUFBT3pDLGFBQWFNLGVBQ25Cd1MsRUFBZ0JFLFlBQVl2USxFQUFPbEQsb0JBQW9CQyxRQUUzRG1JLEVBQUswUSxrQkFDTjVWLEVBQU9kLHdCQUdQLElBQUl5VixFQXpNTSxDQTJNbEIvWSxXQUFZaU8scUJBQXNCd0csaUJBR3JDb0UsZUFBZUkiLCJmaWxlIjoiY2hhdEFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGNvbmZpZ1xyXG5cclxudmFyIG1haW5Db25maWcgPSB7XHJcbiAgICBET006IHtcclxuICAgICAgICBNQUlOX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRcIixcclxuICAgICAgICBBVVRIT1JJWkFUSU9OX01FTlVfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfaW5wdXQtbmFtZS1ibG9ja1wiLFxyXG4gICAgICAgIFVTRVJfTkFNRV9JTlBVVF9DTEFTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9pbnB1dC1uYW1lXCIsXHJcbiAgICAgICAgU0VORF9VU0VSX05BTUVfQlVUVE9OOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X2lucHV0LW5hbWUtYnV0dG9uXCIsXHJcblxyXG4gICAgICAgIFNFTkRfTUVTU0FHRV9NSU5fU0laRV9CVVRUT046IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfbWluaW1pemUtc3R5bGVfX3NlbmQtYnV0dG9uXCIsXHJcblxyXG4gICAgICAgIFNFTkRfTUVTU0FHRV9GVUxMX1NJWkVfQlVUVE9OOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X19ib3R0b21fc2VuZC1idXR0b25cIixcclxuICAgICAgICAvLyDQrdC70LXQvNC10L3RgiDQtNC70Y8g0LLQstC+0LTQsCDRgdC+0L7QsdGJ0LXQvdC40Y9cclxuICAgICAgICBDU1NfTUFYX1NJWkVfSU5QVVRfTUVTU0FHRV9CTE9DS19DTEFTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9fdGV4dGFyZWFcIixcclxuICAgICAgICBDU1NfTUlOX1NJWkVfSU5QVVRfTUVTU0FHRV9CTE9DS19DTEFTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9taW5pbWl6ZS1zdHlsZV9fbWVzc2FnZS1pbnB1dFwiLFxyXG4gICAgICAgIC8vINCt0LvQtdC80LXQvdGCIHRpdGxlXHJcbiAgICAgICAgVElUTEVfQkxPQ0tfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnQtdGl0bGVcIixcclxuICAgICAgICBDSEFOR0VfU1RZTEVfQlVUVE9OX01BWF9TSVpFOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X190b3BfbWluaW1pemUtYnV0dG9uXCIsXHJcbiAgICAgICAgLy8g0YfQsNGCINCyINGB0YLQuNC70LUgbWluXHJcbiAgICAgICAgTUlOSU1JWkVfU1RZTEVfQ0hBVF9CTE9DS19DTEFTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9taW5pbWl6ZS1zdHlsZVwiLFxyXG4gICAgICAgIFNFVF9NSU5fU1RZTEVfQlVUVE9OOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X21pbmltaXplLXN0eWxlX19tYXgtYnV0dG9uXCIsXHJcbiAgICAgICAgU0VUX01BWF9TVFlMRV9CVVRUT046IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfX3RvcF9taW5pbWl6ZS1idXR0b25cIixcclxuICAgICAgICBDSEFUX1FVRVNUSU9OX0NTUzogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9pbmZvcm1hdGlvbi1lbnRlci1uYW1lXCJcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIGRhdGFTb3VyY2VcclxuICAgIERBVEFfQkFTRV9VUkw6IFwiaHR0cHM6Ly9vbmxpbmVjb25zdWx0YW50d2ViYXBwLmZpcmViYXNlaW8uY29tXCIsXHJcblxyXG5cclxuICAgIC8vIHVzZXJEYXRhTWFuYWdlclxyXG4gICAgQ1NTX0NVUlJFTlRfSU5QVVRfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfX3RleHRhcmVhXCIsXHJcblxyXG4gICAgLy8g0L3QsNGB0YLRgNC+0LnQutC4INGC0LXQutGD0YnQtdCz0L4g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMXHJcbiAgICBjdXJyZW50VXNlclNldHRpbmdzOiB7XHJcbiAgICAgICAgdXNlcklkOiBudWxsLFxyXG4gICAgICAgIHVzZXJOYW1lOiBudWxsLFxyXG4gICAgICAgIGlzTWluaW1pemU6IGZhbHNlLFxyXG4gICAgICAgIHJlYWRMYXN0TWVzc2FnZTogZmFsc2UsXHJcbiAgICAgICAgc2VuZE5ld01lc3NhZ2U6IGZhbHNlLFxyXG4gICAgICAgIGxhc3RPbmxpbmU6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXHJcbiAgICB9LFxyXG5cclxuICAgIGNoYXRTZXR0aW5nczoge1xyXG4gICAgICAgIGFsbG93RHJhZzogZmFsc2UsXHJcbiAgICAgICAgcG9zaXRpb246IFwicmlnaHRcIixcclxuICAgICAgICBjaGF0VGl0bGU6IFwiVG91Y2hTb2Z0IENoYXRcIixcclxuICAgICAgICBhbGxvd01pbmltaXplOiB0cnVlLFxyXG4gICAgICAgIG91dGVyQ3NzQ2xhc3M6ICd0b3VjaHNvZnQtY2hhdF9tYWluLWJsb2NrJyxcclxuICAgICAgICB0eXBlT2ZSZXF1ZXN0OiBcImZldGNoXCIsXHJcbiAgICAgICAgcmVxdWlyZU5hbWU6IHRydWVcclxuICAgIH0sXHJcblxyXG4gICAgLy8g0LrQu9Cw0YHRgSDQv9C10YDQtdC60LvRjtGH0LDRgtC10LvRjCDQvtGC0L7QsdGA0LDQttC10L3QuNGPINGN0LvQtdC80LXQvdGC0LBcclxuICAgIElOVklTSUJMRV9DTEFTUzogXCJpbnZpc2libGVcIixcclxuICAgIENIQVRfUE9TSVRJT05fUklHSFQ6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfcmlnaHQtcG9zaXRpb25cIixcclxuICAgIENIQVRfUE9TSVRJT05fTEVGVDogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9sZWZ0LXBvc2l0aW9uXCIsXHJcblxyXG5cclxuICAgIExPQ0FMX1NUT1JBR0VfTkFNRTogXCJ1c2VySURfdG91Y2hzb2Z0X2NoYXRcIixcclxuICAgIERFRkFVTFRfVVNFUl9OQU1FOiBcImd1ZXN0XCIsXHJcblxyXG4gICAgREVGQVVMVF9DU1NfQ0xBU1NfRk9SX0NIQVQ6ICd0b3VjaHNvZnQtY2hhdF9tYWluLWJsb2NrJyxcclxuICAgIERFRkFVTFRfQ0hBVF9USVRMRTogXCJUb3VjaFNvZnQgQ2hhdFwiLFxyXG5cclxuICAgIC8vIGNoYXRWaWV3Q29uZmlnXHJcbiAgICAvLyDQvtGC0LrRg9C00LAg0LfQsNCz0YDRg9C20LDQtdGCIGh0bWwg0LggY3NzINGH0LDRgtCwXHJcbiAgICBIVE1MX0ZJTEVfUEFUSDpcclxuICAgICAgICBcImh0dHBzOi8vcmF3Z2l0LmNvbS9VbmFjY2VwdGFibGVDb25kaXRpb24vb25saW5lX2NvbnN1bHRhbnRfd2ViX2FwcC9tYXN0ZXIvYXBwL2h0bWwvY2hhdEFwcGxpY2F0aW9uL2NoYXQuaHRtbFwiLFxyXG4gICAgQ1NTX0ZJTEVfUEFUSDpcclxuICAgICAgICBcImh0dHBzOi8vcmF3Z2l0LmNvbS9VbmFjY2VwdGFibGVDb25kaXRpb24vb25saW5lX2NvbnN1bHRhbnRfd2ViX2FwcC9tYXN0ZXIvYXBwL2Nzcy9jaGF0LmNzc1wiLFxyXG5cclxuICAgIC8vINCa0LvQsNGB0YHRiyDQtNC70Y8g0YDQsNCx0L7RgtGLINGBINC+0LHRitC10LrRgtCw0LzQuCDRgdC+0L7QsdGJ0LXQvdC40Lkg0LTQu9GPINC40YUg0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDQsiDRh9Cw0YLQtVxyXG4gICAgbWVzc2FnZXM6IHtcclxuICAgICAgICAvLyBDc3Mg0LrQu9Cw0YHRgSDQtNC70Y8g0Y3Qu9C10LzQtdC90LDRgiDRgSDRgdC+0L7QsdGJ0LXQvdC40LUsINC10YHQu9C4INGO0LfQtdGAINC90LUg0L/RgNC+0YfQuNGC0LDQuyDRgdC+0L7QsdGJ0LXQvdC40Y9cclxuICAgICAgICBDU1NfVVNFUl9OT1RfUkVBRF9NRVNTQUdFUzogXCJyb290LXRvdWNoc29mdC1kYXNoYm9hcmRfbWVzc2FnZS1ub3QtcmVhZFwiLFxyXG4gICAgICAgIC8vIENzcyDQutC70LDRgdGBIERPTSDRjdC70LXQvNC10L3RgtCwINCyINC60L7RgtC+0YDQvtC8INCx0YPQtNC10Lwg0L7RgtC+0LHRgNCw0LbQsNGC0Ywg0YHQvtC+0LHRidC10L3QuNGPXHJcbiAgICAgICAgQ1NTX0NIQVRfTUVTU0FHRVNfQ09OVEFJTkVSOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X190b3BfbWVzc2FnZXNcIixcclxuXHJcbiAgICAgICAgLy8gbWVzc2FnZVxyXG4gICAgICAgIC8vIENzcyDQutC70LDRgdGBINGN0LvQtdC80LXQvdGC0LAg0LIg0LrQvtGC0L7RgNC+0Lwg0L3QsNGF0L7QtNC40YLRgdGPINGB0L7QvtCx0YnQtdC90LjRjyzQtNCw0YLQsCDQuCDQuNC80Y8g0L7RgtC/0YDQsNCy0LjRgtC10LvRj1xyXG4gICAgICAgIENTU19NRVNTQUdFX0NPTlRBSU5FUjogXCJyb290LXRvdWNoc29mdC1kYXNoYm9hcmRfY2hhdC1tZXNzYWdlLWVsZW1lbnRzXCIsXHJcbiAgICAgICAgLy8gQ3NzINC60LvQsNGB0YEgRE9NINGN0LvQtdC80LXQvdGC0LAg0LIg0LrQvtGC0L7RgNC+0Lwg0LHRg9C00LXQvCDQvtGC0L7QsdGA0LDQttCw0YLRjCDQuNC80Y8g0L7RgtC/0YDQsNCy0LjRgtC10LvRj1xyXG4gICAgICAgIENTU19DSEFUX01FU1NBR0VfU0VOREVSX05BTUU6IFwicm9vdC10b3VjaHNvZnQtZGFzaGJvYXJkX2NoYXQtbWVzc2FnZS1zZW5kZXJcIixcclxuICAgICAgICAvLyBDc3Mg0LrQu9Cw0YHRgSBET00g0Y3Qu9C10LzQtdC90YLQsCDQsiDQutC+0YLQvtGA0L7QvCDQsdGD0LTQtdC8INC+0YLQvtCx0YDQsNC20LDRgtGMINC00LDRgtGDINGB0L7QvtCx0YnQtdC90LjRj1xyXG4gICAgICAgIENTU19DSEFUX01FU1NBR0VfREFURTogXCJyb290LXRvdWNoc29mdC1kYXNoYm9hcmRfY2hhdC1tZXNzYWdlLWRhdGVcIixcclxuICAgICAgICAvLyBDc3Mg0LrQu9Cw0YHRgSBET00g0Y3Qu9C10LzQtdC90YLQsCDQsiDQutC+0YLQvtGA0L7QvCDQsdGD0LTQtdC8INC+0YLQvtCx0YDQsNC20LDRgtGMINGB0L7QvtCx0YnQtdC90LjQtVxyXG4gICAgICAgIENTU19DSEFUX01FU1NBR0U6IFwicm9vdC10b3VjaHNvZnQtZGFzaGJvYXJkX2NoYXQtbWVzc2FnZVwiXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBESVNQTEFZX01FU1NBR0VfREFURTogdHJ1ZSxcclxuICAgIERJU1BMQVlfU0VOREVSX05BTUU6IHRydWUsXHJcbiAgICBESVNQTEFZX01FU1NBR0U6IHRydWUsXHJcblxyXG4gICAgVVBEQVRFX1VTRVJfREFUQV9USU1FOiA1MDAwLFxyXG5cclxuICAgIENPTU1BTkRfUEFUSF9QUkVGSVg6IFwiaHR0cHM6Ly9vbmxpbmVjb25zdWx0YW50d2ViYXBwLmZpcmViYXNlaW8uY29tL3VzZXJzU2V0dGluZ3MvXCJcclxuXHJcbn07XHJcblxyXG4vLyBJTkNMVURFXHJcbmZ1bmN0aW9uIHBhcnNlU3JjRm9yUGFyYW1ldGVycyhcclxuICAgIHNyY1xyXG4pIHtcclxuICAgIHZhciB1c2VyQ29uZmlnT2JqZWN0ID0ge307XHJcbiAgICB2YXIgYXJyUGFyYW0gPSBzcmMuc3Vic3RyKHNyYy5pbmRleE9mKFwiP1wiKSArIDEpLnNwbGl0KFwiJlwiKTtcclxuICAgIGFyclBhcmFtLmZvckVhY2goZnVuY3Rpb24gY3JlYXRlQ29uZmlnT2JqIChlbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIHBhcmFtT2JqID0gZWxlbWVudC5zcGxpdChcIj1cIik7XHJcbiAgICAgICAgcGFyYW1PYmpbMV0gPSBwYXJhbU9ialsxXS5yZXBsYWNlKC8nL2csIFwiXCIpO1xyXG4gICAgICAgIHVzZXJDb25maWdPYmplY3RbcGFyYW1PYmpbMF1dID0gcGFyYW1PYmpbMV07XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB1c2VyQ29uZmlnT2JqZWN0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRPdXRlckNoYXRTZXR0aW5nVG9Db25maWcgKG91dGVyQ29uZmlnT2JqZWN0LCBjb25maWcpIHtcclxuICAgIE9iamVjdC5rZXlzKG91dGVyQ29uZmlnT2JqZWN0KS5tYXAoZnVuY3Rpb24gZ2V0T3V0ZXJTZXR0aW5ncyAoa2V5KSB7XHJcbiAgICAgICAgY29uZmlnLmNoYXRTZXR0aW5nc1trZXldID0gb3V0ZXJDb25maWdPYmplY3Rba2V5XTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0pXHJcbn1cclxuXHJcbi8vIElOQ0xVREVcclxuXHJcbnNldE91dGVyQ2hhdFNldHRpbmdUb0NvbmZpZyhwYXJzZVNyY0ZvclBhcmFtZXRlcnMoZG9jdW1lbnQuY3VycmVudFNjcmlwdC5nZXRBdHRyaWJ1dGUoXCJzcmNcIikpLCBtYWluQ29uZmlnKTtcclxuLyogZXhwb3J0ZWQgZGF0YUNvbm5lY3RvckNvbmZpZyAqL1xyXG4vKiBleHBvcnRlZCBkYXRhQmFzZVVybCAqL1xyXG4vKiBleHBvcnRlZCBnZXRFbGVtZW50ICovXHJcbi8qIGdsb2JhbCBtYWluQ29uZmlnICovXHJcbnZhciBkYXRhQmFzZVVybCA9IG1haW5Db25maWcuREFUQV9CQVNFX1VSTDtcclxuXHJcbnZhciBnZXRFbGVtZW50ID0gZnVuY3Rpb24gZ2V0RWxlbWVudEZyb21ET00gKHNlbGVjdG9yLCBpc0FsbCwgaXRJc0lkKSB7XHJcbiAgICB2YXIgc2VsZWN0b3JTdGFydCA9IChpdElzSWQpID8gXCIjXCIgOiBcIi5cIjtcclxuICAgIGlmKGlzQWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3JTdGFydCArIHNlbGVjdG9yKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yU3RhcnQgKyBzZWxlY3Rvcik7XHJcbn07XHJcblxyXG5cclxudmFyIGRhdGFDb25uZWN0b3JDb25maWcgPSB7XHJcbiAgICB0eXBlT2ZSZXF1ZXN0OiBtYWluQ29uZmlnLmNoYXRTZXR0aW5ncy50eXBlT2ZSZXF1ZXN0XHJcbn07XHJcblxyXG4vLyBkYXRhYmFzZVxyXG5cclxuLyogZXhwb3J0ZWQgZGF0YUNvbm5lY3RvciAqL1xyXG4vKiBnbG9iYWwgZGF0YUNvbm5lY3RvckNvbmZpZyAqL1xyXG4vLyDQnNC+0LTRg9C70Ywg0L/RgNC10LTQvtGB0YLQsNCy0LvRj9C10YIg0YHQv9C+0YHQvtCxINC+0YLQv9GA0LDQstC60Lgg0LfQsNC/0YDQvtGB0LAg0Log0LjRgdGC0L7Rh9C90LjQutGDINC00LDQvdC90YvRhVxyXG4vLyDQlNC70Y8g0YDQtdC60LLQtdGB0YLQsCDQvdC10L7QsdGF0L7QtNC40Lwg0L/Rg9GC0YwsINGC0LXQu9C+INC30LDQv9GA0L7RgdCwLCDRgtC40L8g0LfQsNC/0YDQvtGB0LBcclxuLy8gcmVxdWVzdCDQstC+0LfQstGA0LDRidCw0LXRgiBQcm9taXNlXHJcbnZhciBkYXRhQ29ubmVjdG9yID0gKGZ1bmN0aW9uIGdldERhdGFTb3VyY2VBUEkoZGF0YUNvbm5lY3RvckNvbmZpZ09iaikge1xyXG4gICAgdmFyIGRhdGFCYXNlQ29ubmVjdG9yO1xyXG5cclxuICAgIGZ1bmN0aW9uIERhdGFCYXNlQ29ubmVjdG9yKCkge31cclxuXHJcbiAgICBEYXRhQmFzZUNvbm5lY3Rvci5wcm90b3R5cGUuc2V0dXBEYXRhQmFzZUFQSSA9IGZ1bmN0aW9uIHNldHVwRGF0YUJhc2VBUEkgKHR5cGVPZlJlcXVlc3QpIHtcclxuICAgICAgICB2YXIgZGF0YUJhc2VBUEk7XHJcbiAgICAgICAgaWYgKHR5cGVPZlJlcXVlc3QgPT09IFwiZmV0Y2hcIikge1xyXG4gICAgICAgICAgICBkYXRhQmFzZUFQSSA9IHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3Q6IGRhdGFCYXNlQ29ubmVjdG9yLnJlcXVlc3RGZXRjaCxcclxuICAgICAgICAgICAgICAgIGdldE5ld0Nvbm5lY3RvckFQSTogZGF0YUJhc2VDb25uZWN0b3Iuc2V0dXBEYXRhQmFzZUFQSVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZU9mUmVxdWVzdCA9PT0gXCJYSFJcIikge1xyXG4gICAgICAgICAgICBkYXRhQmFzZUFQSSA9IHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3Q6IGRhdGFCYXNlQ29ubmVjdG9yLnJlcXVlc3RYTVIsXHJcbiAgICAgICAgICAgICAgICBnZXROZXdDb25uZWN0b3JBUEk6IGRhdGFCYXNlQ29ubmVjdG9yLnNldHVwRGF0YUJhc2VBUElcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkYXRhQmFzZUFQSSA9IHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3Q6IGRhdGFCYXNlQ29ubmVjdG9yLnJlcXVlc3RYTVIsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVMb25nUG9sbENvbm5lY3Rpb246IGRhdGFCYXNlQ29ubmVjdG9yLmxvbmdQb2xsLFxyXG4gICAgICAgICAgICAgICAgZ2V0TmV3Q29ubmVjdG9yQVBJOiBkYXRhQmFzZUNvbm5lY3Rvci5zZXR1cERhdGFCYXNlQVBJXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhQmFzZUFQSTtcclxuICAgIH07XHJcblxyXG4gICAgRGF0YUJhc2VDb25uZWN0b3IucHJvdG90eXBlLnJlcXVlc3RGZXRjaCA9IGZ1bmN0aW9uIHJlcXVlc3RGZXRjaChcclxuICAgICAgICByZXF1ZXN0UGF0aCxcclxuICAgICAgICByZXF1ZXN0Qm9keSxcclxuICAgICAgICByZXF1ZXN0VHlwZSxcclxuICAgICAgICBjb250ZW50VHlwZVxyXG4gICAgKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHJlcXVlc3RQYXRoLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgIEFjY2VwdDogY29udGVudFR5cGUsXHJcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBjb250ZW50VHlwZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtZXRob2Q6IHJlcXVlc3RUeXBlLFxyXG4gICAgICAgICAgICBib2R5OiByZXF1ZXN0Qm9keVxyXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gZ2V0UmVzcG9uc2VKU09OKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIGlmKGNvbnRlbnRUeXBlID09PSBcImFwcGxpY2F0aW9uL2pzb25cIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBEYXRhQmFzZUNvbm5lY3Rvci5wcm90b3R5cGUucmVxdWVzdFhNUiA9IGZ1bmN0aW9uIHJlcXVlc3RYTVIoXHJcbiAgICAgICAgcmVxdWVzdFBhdGgsXHJcbiAgICAgICAgcmVxdWVzdEJvZHksXHJcbiAgICAgICAgcmVxdWVzdFR5cGUsXHJcbiAgICAgICAgY29udGVudFR5cGVcclxuICAgICkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiByZXF1ZXN0KHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgICAgIHhoci5vcGVuKHJlcXVlc3RUeXBlLCByZXF1ZXN0UGF0aCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIGNvbnRlbnRUeXBlKTtcclxuICAgICAgICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uIGxvYWRDYXNlKCkge1xyXG4gICAgICAgICAgICAgICAgaWYoY29udGVudFR5cGUgPT09IFwiYXBwbGljYXRpb24vanNvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShKU09OLnBhcnNlKHhoci5yZXNwb25zZSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24gZXJyb3JDYXNlKCkge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KHhoci5zdGF0dXNUZXh0KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKHJlcXVlc3RCb2R5KSB7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2VuZChyZXF1ZXN0Qm9keSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2VuZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIERhdGFCYXNlQ29ubmVjdG9yLnByb3RvdHlwZS5sb25nUG9sbCA9IGZ1bmN0aW9uIGxvbmdQb2xsICh0YXJnZXRVcmwpIHtcclxuICAgICAgICB2YXIgeGh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB4aHR0cC5vcGVuKCdHRVQnLCB0YXJnZXRVcmwsIHRydWUpO1xyXG4gICAgICAgIHhodHRwLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsICd0ZXh0L2V2ZW50LXN0cmVhbScpO1xyXG4gICAgICAgIHJldHVybiB4aHR0cDtcclxuICAgIH07XHJcblxyXG4gICAgZGF0YUJhc2VDb25uZWN0b3IgPSBuZXcgRGF0YUJhc2VDb25uZWN0b3IoKTtcclxuICAgIHJldHVybiBkYXRhQmFzZUNvbm5lY3Rvci5zZXR1cERhdGFCYXNlQVBJKGRhdGFDb25uZWN0b3JDb25maWdPYmoudHlwZU9mUmVxdWVzdCk7XHJcblxyXG59KShkYXRhQ29ubmVjdG9yQ29uZmlnKTtcclxuLyogZXhwb3J0ZWQgZGF0YVNvdXJjZSAqL1xyXG4vKiBnbG9iYWwgbWFpbkNvbmZpZyAqL1xyXG4vKiBnbG9iYWwgZGF0YUJhc2VVcmwgKi9cclxuLyogZ2xvYmFsIGRhdGFDb25uZWN0b3IgKi9cclxuLy8g0JzQvtC00YPQu9GMINC00LvRjyDQv9C+0LvRg9GH0LXQvdC40Y8g0LTQsNC90L3Ri9GFXHJcbi8vINCS0YHQtSBBUEkg0YTRg9C90LrRhtC40Lgg0LLQvtC30LLRgNCw0YnQsNGO0YIg0L/RgNC+0LzQuNGB0YtcclxudmFyIGRhdGFTb3VyY2UgPSAoZnVuY3Rpb24gY3JlYXRlRGF0YVNvdXJjZSAoZGF0YUNvbm5lY3RvciwgY29uZmlnKSB7XHJcbiAgICB2YXIgZGF0YVNvdXJjZUluc3RhbmNlO1xyXG4gICAgdmFyIFVTRVJfTElTVCA9IFwidXNlckxpc3RcIjtcclxuICAgIHZhciBVU0VSX01FU1NBR0VTID0gXCJ1c2Vyc01lc3NhZ2VzXCI7XHJcbiAgICB2YXIgVVNFUlNfU0VUVElOR1MgPSBcInVzZXJzU2V0dGluZ3NcIjtcclxuICAgIHZhciBuZXdVc2VyRGF0YSA9IHtcclxuICAgICAgICBpc01pbmltaXplOiBmYWxzZSxcclxuICAgICAgICByZWFkTGFzdE1lc3NhZ2U6IHRydWVcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gRGF0YVNvdXJjZSgpIHt9XHJcblxyXG4gICAgZnVuY3Rpb24gbG9uZ1BvbGxDb25uZWN0IChkYXRhVHlwZSwgdXNlcklkKSB7XHJcbiAgICAgICAgdmFyIHJlcXVlc3RQYXRoID0gdGhpcy5jcmVhdGVSZXF1ZXN0UGF0aChkYXRhQmFzZVVybCwgdXNlcklkLCBudWxsLCBkYXRhVHlwZSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGFDb25uZWN0b3IuY3JlYXRlTG9uZ1BvbGxDb25uZWN0aW9uKHJlcXVlc3RQYXRoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBiYXNpY0Nvbm5lY3QgKGRhdGFUeXBlLCB1c2VySWQpIHtcclxuICAgICAgICB2YXIgcmVxdWVzdFBhdGggPSB0aGlzLmNyZWF0ZVJlcXVlc3RQYXRoKGRhdGFCYXNlVXJsLCB1c2VySWQsIG51bGwsIGRhdGFUeXBlKTtcclxuICAgICAgICByZXR1cm4gZGF0YUNvbm5lY3Rvci5yZXF1ZXN0LmJpbmQobnVsbCwgcmVxdWVzdFBhdGgsIG51bGwsIFwiR0VUXCIsIFwiYXBwbGljYXRpb24vanNvblwiKVxyXG4gICAgfVxyXG5cclxuICAgIERhdGFTb3VyY2UucHJvdG90eXBlLmNyZWF0ZVJlcXVlc3RQYXRoID0gZnVuY3Rpb24gY3JlYXRlUmVxdWVzdFBhdGgoXHJcbiAgICAgICAgZGF0YUJhc2VVUkwsXHJcbiAgICAgICAgdXNlcklkLFxyXG4gICAgICAgIHJlcXVlc3RQb3N0Zml4LFxyXG4gICAgICAgIHJlcXVlc3RQcmVmaXhcclxuICAgICkge1xyXG4gICAgICAgIHZhciBwYXRoID0gZGF0YUJhc2VVUkw7XHJcbiAgICAgICAgaWYocmVxdWVzdFByZWZpeCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBwYXRoICs9IFwiL1wiICsgcmVxdWVzdFByZWZpeFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodXNlcklkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gXCIvXCIgKyB1c2VySWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXF1ZXN0UG9zdGZpeCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBwYXRoICs9IFwiL1wiICsgcmVxdWVzdFBvc3RmaXg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhdGggKz0gXCIuanNvblwiO1xyXG4gICAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfTtcclxuXHJcbiAgICBEYXRhU291cmNlLnByb3RvdHlwZS5nZXRIVE1MID0gZnVuY3Rpb24gZ2V0SFRNTCAocmVxdWVzdFBhdGgpIHtcclxuICAgICAgICByZXR1cm4gZGF0YUNvbm5lY3Rvci5yZXF1ZXN0KFxyXG4gICAgICAgICAgICByZXF1ZXN0UGF0aCxcclxuICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgXCJHRVRcIiwgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCdcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgRGF0YVNvdXJjZS5wcm90b3R5cGUuc2V0RGF0YSA9IGZ1bmN0aW9uIHNldERhdGEgKGRhdGFUeXBlLCByZXF1ZXN0VHlwZSwgZmllbGROYW1lLCB1c2VySWQsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIHJlcXVlc3RQYXRoO1xyXG4gICAgICAgIGlmKHJlcXVlc3RUeXBlID09PSBcIlBVVFwiKSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RQYXRoID0gdGhpcy5jcmVhdGVSZXF1ZXN0UGF0aChkYXRhQmFzZVVybCwgdXNlcklkLCBmaWVsZE5hbWUsIGRhdGFUeXBlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXF1ZXN0UGF0aCA9IHRoaXMuY3JlYXRlUmVxdWVzdFBhdGgoZGF0YUJhc2VVcmwsIHVzZXJJZCwgbnVsbCwgZGF0YVR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGF0YUNvbm5lY3Rvci5yZXF1ZXN0KFxyXG4gICAgICAgICAgICByZXF1ZXN0UGF0aCxcclxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkodmFsdWUpLFxyXG4gICAgICAgICAgICByZXF1ZXN0VHlwZSxcclxuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICBEYXRhU291cmNlLnByb3RvdHlwZS5hZGROZXdVc2VyVG9EYXRhU291cmNlID0gZnVuY3Rpb24gYWRkTmV3VXNlclRvRGF0YVNvdXJjZSAodXNlcklkLCB1c2VyTmFtZSkge1xyXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGU7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIG5ld1VzZXJEYXRhLnVzZXJOYW1lID0gdXNlck5hbWU7XHJcbiAgICAgICAgT2JqZWN0LmtleXMobmV3VXNlckRhdGEpLm1hcChmdW5jdGlvbiBhZGROZXdTZXR0aW5ncyAoc2V0dGluZ05hbWUpIHtcclxuICAgICAgICAgICAgdGhhdC5zZXREYXRhKFVTRVJTX1NFVFRJTkdTLCBcIlBVVFwiLCBzZXR0aW5nTmFtZSwgdXNlcklkLCBuZXdVc2VyRGF0YVtzZXR0aW5nTmFtZV0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNldERhdGEoVVNFUl9MSVNULCBcIlBVVFwiLCBudWxsLCB1c2VySWQsIHtcImxhc3RPbmxpbmVcIjogZGF0ZS5nZXRUaW1lKCksIFwic2VuZE5ld01lc3NhZ2VcIjogZmFsc2V9KTtcclxuICAgIH07XHJcblxyXG4gICAgRGF0YVNvdXJjZS5wcm90b3R5cGUuZ2V0RGF0YVNvdXJjZUFQSSA9IGZ1bmN0aW9uIGdldERhdGFTb3VyY2VBUEkgKHR5cGVPZlJlcXVlc3QpIHtcclxuICAgICAgICBpZih0eXBlT2ZSZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jaGF0U2V0dGluZ3MudHlwZU9mUmVxdWVzdCA9IHR5cGVPZlJlcXVlc3Q7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGNvbmZpZy5jaGF0U2V0dGluZ3MudHlwZU9mUmVxdWVzdCA9PT0gXCJsb25nUG9sbFwiKSB7XHJcbiAgICAgICAgICAgIERhdGFTb3VyY2UucHJvdG90eXBlLmdldERhdGEgPSBsb25nUG9sbENvbm5lY3RcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBEYXRhU291cmNlLnByb3RvdHlwZS5nZXREYXRhID0gYmFzaWNDb25uZWN0XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHVzZXJzQVBJOiB7XHJcbiAgICAgICAgICAgICAgICBnZXRVc2VyTGlzdDogZGF0YVNvdXJjZUluc3RhbmNlLmdldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUl9MSVNUXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgZ2V0VXNlclNldHRpbmdzOiBkYXRhU291cmNlSW5zdGFuY2UuZ2V0RGF0YS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZSxcclxuICAgICAgICAgICAgICAgICAgICBVU0VSU19TRVRUSU5HU1xyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIGdldFVzZXJNZXNzYWdlczogZGF0YVNvdXJjZUluc3RhbmNlLmdldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUl9NRVNTQUdFU1xyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIGdldFNldHRpbmdGaWVsZDogZGF0YVNvdXJjZUluc3RhbmNlLmdldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUlNfU0VUVElOR1NcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZTogZGF0YVNvdXJjZUluc3RhbmNlLnNldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUl9NRVNTQUdFUyxcclxuICAgICAgICAgICAgICAgICAgICBcIlBPU1RcIlxyXG5cclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBzZXRTZXR0aW5nRmllbGQ6IGRhdGFTb3VyY2VJbnN0YW5jZS5zZXREYXRhLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZUluc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIFVTRVJTX1NFVFRJTkdTLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiUFVUXCJcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBhZGROZXdVc2VyVG9EYXRhU291cmNlOiBkYXRhU291cmNlSW5zdGFuY2UuYWRkTmV3VXNlclRvRGF0YVNvdXJjZS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZVxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZUxhc3RPbmxpbmU6IGRhdGFTb3VyY2VJbnN0YW5jZS5zZXREYXRhLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZUluc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIFVTRVJfTElTVCxcclxuICAgICAgICAgICAgICAgICAgICBcIlBVVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwibGFzdE9ubGluZVwiXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlU2VuZE5ld01lc3NhZ2VGbGFnOiBkYXRhU291cmNlSW5zdGFuY2Uuc2V0RGF0YS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZSxcclxuICAgICAgICAgICAgICAgICAgICBVU0VSX0xJU1QsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJQVVRcIixcclxuICAgICAgICAgICAgICAgICAgICBcInNlbmROZXdNZXNzYWdlXCJcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVNZXNzYWdlSXNSZWFkRmllbGQ6IGRhdGFTb3VyY2VJbnN0YW5jZS5zZXREYXRhLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZUluc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIFVTRVJfTUVTU0FHRVMsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJQVVRcIlxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb21tb25BUEk6IHtcclxuICAgICAgICAgICAgICAgIGdldEhUTUw6IGRhdGFTb3VyY2VJbnN0YW5jZS5nZXRIVE1MLmJpbmQoZGF0YVNvdXJjZUluc3RhbmNlKSxcclxuICAgICAgICAgICAgICAgIGdldERhdGFTb3VyY2VBUEk6IGRhdGFTb3VyY2VJbnN0YW5jZS5nZXREYXRhU291cmNlQVBJLmJpbmQoZGF0YVNvdXJjZUluc3RhbmNlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgLy8g0KHQvtC30LTQsNC10LwgaW5zdGFuY2Ug0L7QsdGK0LXQutGC0LAsINC30LDQtNCw0LXQvCBBUElcclxuICAgIGRhdGFTb3VyY2VJbnN0YW5jZSA9IG5ldyBEYXRhU291cmNlKCk7XHJcblxyXG5cclxuXHJcbiAgICByZXR1cm4gZGF0YVNvdXJjZUluc3RhbmNlLmdldERhdGFTb3VyY2VBUEkoKTtcclxufSkoZGF0YUNvbm5lY3RvciwgbWFpbkNvbmZpZyk7XHJcblxyXG4vLyBldmVudEVtaXR0ZXJcclxuXHJcbi8qIGV4cG9ydGVkIGV2ZW50RW1pdHRlciAqL1xyXG52YXIgZXZlbnRFbWl0dGVyID0gKGZ1bmN0aW9uIGNyZWF0ZUV2ZW50RW1pdHRlciAoKSB7XHJcbiAgICBmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XHJcbiAgICAgICAgdGhpcy5ldmVudHMgPSB7fTtcclxuICAgIH1cclxuXHJcbiAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZFN1YnNjcmliZSA9IGZ1bmN0aW9uIGFkZFN1YnNjcmliZShldmVudE5hbWUsIGNhbGxiYWNrICkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICBpZiggIXRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gPSBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjayk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZVN1YnNjcmliZSAoKSB7XHJcbiAgICAgICAgICAgIHRoYXQuZXZlbnRzW2V2ZW50TmFtZV0gPSB0aGF0LmV2ZW50c1tldmVudE5hbWVdLmZpbHRlcihmdW5jdGlvbiByZW1vdmUgKGVsZW1lbnRDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnRDYWxsYmFjayAhPT0gY2FsbGJhY2tcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZW1vdmVTdWJzY3JpYmVcclxuICAgIH07XHJcblxyXG4gICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gZW1pdCAoZXZlbnROYW1lLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIGV2ZW50ID0gdGhpcy5ldmVudHNbZXZlbnROYW1lXTtcclxuICAgICAgICBpZiggZXZlbnQgKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LmZvckVhY2goZnVuY3Rpb24gaW52b2tlIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbChudWxsLCBkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG59KSgpO1xyXG4vKiBleHBvcnRlZCBsb25nUG9sbFJlc3BvbnNlUGFyc2VyICovXHJcbnZhciBsb25nUG9sbFJlc3BvbnNlUGFyc2VyID0gKGZ1bmN0aW9uIGNyZWF0ZUxvbmdQb2xsUmVzcG9uc2VQYXJzZXIoKSB7XHJcbiAgICB2YXIgdHlwZXNPZkNoYW5nZSA9IHtcclxuICAgICAgICBtZXNzYWdlOiAvbWVzc2FnZS8sXHJcbiAgICAgICAgdXNlckxpc3Q6IC9sYXN0T25saW5lLnsxLH1zZW5kTmV3TWVzc2FnZS8sXHJcbiAgICAgICAgbGFzdE9ubGluZTogL1wicGF0aFwiOlwiXFwvXFx3ezEsfVxcL2xhc3RPbmxpbmUvLFxyXG4gICAgICAgIHNlbmROZXdNZXNzYWdlOiAvXCJwYXRoXCI6XCJcXC9cXHd7MSx9XFwvc2VuZE5ld01lc3NhZ2UvLFxyXG4gICAgICAgIHNldHRpbmc6IC9yZWFkTGFzdE1lc3NhZ2UvLFxyXG4gICAgICAgIHJlYWQ6IC9yZWFkLyxcclxuICAgICAgICBnZXRJcDogL2dldElwLyxcclxuICAgICAgICBhc2tRdWVzdGlvbjogL2Fza1F1ZXN0aW9uL1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgZXZlbnRSZWd1bGFyID0gL2V2ZW50OiBwdXQvO1xyXG4gICAgdmFyIGhhc051bGxEYXRhID0gL2RhdGE6IG51bGwvO1xyXG4gICAgdmFyIGdldERhdGFSZWd1bGFyID0gL1wiLFwiZGF0YVwiOi87XHJcbiAgICB2YXIgaXRJc05ld01lc3NhZ2VSZWd1bGFyID0gL1wicGF0aFwiOlwiXFwvLS87XHJcbiAgICB2YXIgaXRJc05ld1VzZXJMaXN0UmVndWxhciA9IC9cImRhdGFcIjp7XCJsYXN0T25saW5lXCI6XFxkKyxcInNlbmROZXdNZXNzYWdlXCI6LztcclxuICAgIHZhciBpdElzRmlyc3RJcERhdGFSZWd1bGFyID0gL2RhdGE6IHtcInBhdGhcIjpcIlxcL1wiLFwiZGF0YVwiOntcImdldElwXCI6LztcclxuICAgIHZhciBpdElzRmlyc3RRdWVzdGlvbnNEYXRhID0gL2RhdGE6IHtcInBhdGhcIjpcIlxcL1wiLFwiZGF0YVwiOntcImFza1F1ZXN0aW9uXCI6LztcclxuICAgIHZhciBpdElzTmV3UXVlc3Rpb25zQ29tbWFuZCA9IC9kYXRhOiB7XCJwYXRoXCI6XCJcXC9hc2tRdWVzdGlvblwiLFwiZGF0YVwiOi87XHJcbiAgICB2YXIgaXRJc0ZpcnN0VXNlckxpc3RDb25uZWN0aW9uID0gdHJ1ZTtcclxuXHJcbiAgICBmdW5jdGlvbiBMb25nUG9sbFJlc3BvbnNlUGFyc2VyKCkge31cclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5nZXRUeXBlT2ZDaGFuZ2VzID0gZnVuY3Rpb24gZ2V0VHlwZU9mQ2hhbmdlcyhcclxuICAgICAgICBhbnN3ZXJEYXRhXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgdHlwZSA9IE9iamVjdC5rZXlzKHR5cGVzT2ZDaGFuZ2UpLmZpbHRlcihcclxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q3VycmVudFR5cGVPZkNoYW5nZSh0eXBlTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVzT2ZDaGFuZ2VbdHlwZU5hbWVdLnRlc3QoYW5zd2VyRGF0YSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHlwZU5hbWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gdHlwZVswXTtcclxuICAgIH07XHJcblxyXG4gICAgTG9uZ1BvbGxSZXNwb25zZVBhcnNlci5wcm90b3R5cGUucHJlcGFyZURhdGFCZWZvcmVKc29uUGFyc2UgPSBmdW5jdGlvbiBwcmVwYXJlRGF0YUJlZm9yZUpzb25QYXJzZShcclxuICAgICAgICByZXNwb25zZVxyXG4gICAgKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdXHJcbiAgICAgICAgICAgIC5zcGxpdChnZXREYXRhUmVndWxhcilbMV1cclxuICAgICAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgICAgICAuc2xpY2UoMCwgLTEpO1xyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5wYXJzZVVzZXJzTWVzc2FnZXMgPSBmdW5jdGlvbiBwYXJzZVVzZXJzTWVzc2FnZXMoXHJcbiAgICAgICAgcmVzcG9uc2UsXHJcbiAgICAgICAgY2hhbmdlVHlwZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcclxuICAgICAgICB2YXIgbWVzc2FnZUlkO1xyXG4gICAgICAgIHZhciByZXN1bHRPYmplY3QgPSB7fTtcclxuICAgICAgICBpZiAoY2hhbmdlVHlwZSA9PT0gXCJyZWFkXCIpIHtcclxuICAgICAgICAgICAgZGF0YS5pZCA9IHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoJ2RhdGE6IHtcInBhdGhcIjpcIi8nKVxyXG4gICAgICAgICAgICAgICAgLnBvcCgpXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoJy9yZWFkXCIsXCInKVxyXG4gICAgICAgICAgICAgICAgLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgIGRhdGEudmFsdWUgPSByZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXVxyXG4gICAgICAgICAgICAgICAgLnNwbGl0KCcvcmVhZFwiLFwiZGF0YVwiOicpXHJcbiAgICAgICAgICAgICAgICAucG9wKClcclxuICAgICAgICAgICAgICAgIC50cmltKClcclxuICAgICAgICAgICAgICAgIC5zbGljZSgwLCAtMSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWl0SXNOZXdNZXNzYWdlUmVndWxhci50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGaXJzdERhdGEocmVzcG9uc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtZXNzYWdlSWQgPSByZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXVxyXG4gICAgICAgICAgICAuc3BsaXQoJ2RhdGE6IHtcInBhdGhcIjpcIi8nKVxyXG4gICAgICAgICAgICAucG9wKClcclxuICAgICAgICAgICAgLnNwbGl0KGdldERhdGFSZWd1bGFyKVxyXG4gICAgICAgICAgICAuc2hpZnQoKTtcclxuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZSh0aGlzLnByZXBhcmVEYXRhQmVmb3JlSnNvblBhcnNlKHJlc3BvbnNlKSk7XHJcbiAgICAgICAgcmVzdWx0T2JqZWN0W21lc3NhZ2VJZF0gPSBkYXRhO1xyXG4gICAgICAgIHJldHVybiByZXN1bHRPYmplY3Q7XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLmhhc05ld0RhdGEgPSBmdW5jdGlvbiBoYXNOZXdEYXRhKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgIWhhc051bGxEYXRhLnRlc3QocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0pICYmIHJlc3BvbnNlLmxlbmd0aCA+IDFcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5wYXJzZVVzZXJMaXN0ID0gZnVuY3Rpb24gcGFyc2VVc2VyTGlzdChcclxuICAgICAgICByZXNwb25zZSxcclxuICAgICAgICBjaGFuZ2VUeXBlXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHt9O1xyXG4gICAgICAgIHZhciB1c2VySWQ7XHJcbiAgICAgICAgaWYgKGl0SXNGaXJzdFVzZXJMaXN0Q29ubmVjdGlvbikge1xyXG4gICAgICAgICAgICBpdElzRmlyc3RVc2VyTGlzdENvbm5lY3Rpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Rmlyc3REYXRhKHJlc3BvbnNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGl0SXNOZXdVc2VyTGlzdFJlZ3VsYXIudGVzdChyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXSkpIHtcclxuICAgICAgICAgICAgdXNlcklkID0gdGhpcy5nZXRVc2VySWQocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0sIG51bGwpO1xyXG4gICAgICAgICAgICBkYXRhW3VzZXJJZF0gPSB0aGlzLmdldEZpcnN0RGF0YShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShcclxuICAgICAgICAgICAgcmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV1cclxuICAgICAgICAgICAgICAgIC5zcGxpdChnZXREYXRhUmVndWxhcilbMV1cclxuICAgICAgICAgICAgICAgIC50cmltKClcclxuICAgICAgICAgICAgICAgIC5zbGljZSgwLCAtMSlcclxuICAgICAgICApO1xyXG4gICAgICAgIHVzZXJJZCA9IHRoaXMuZ2V0VXNlcklkKHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdLCBjaGFuZ2VUeXBlKTtcclxuICAgICAgICByZXR1cm4gW3VzZXJJZCwgZGF0YV07XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLmdldEZpcnN0RGF0YSA9IGZ1bmN0aW9uIGdldEZpcnN0RGF0YShcclxuICAgICAgICByZXNwb25zZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGpzb25EYXRhO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGpzb25EYXRhID0gSlNPTi5wYXJzZSh0aGlzLnByZXBhcmVEYXRhQmVmb3JlSnNvblBhcnNlKHJlc3BvbnNlKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBqc29uRGF0YTtcclxuICAgICAgICB9IGNhdGNoIChleGNlcHRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5nZXRVc2VySWQgPSBmdW5jdGlvbiBnZXRVc2VySWQoXHJcbiAgICAgICAgcmVzcG9uc2UsXHJcbiAgICAgICAgY2hhbmdlVHlwZVxyXG4gICAgKSB7XHJcbiAgICAgICAgaWYgKGNoYW5nZVR5cGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoY2hhbmdlVHlwZSlcclxuICAgICAgICAgICAgICAgIC5zaGlmdCgpXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoJ2RhdGE6IHtcInBhdGhcIjpcIi8nKVxyXG4gICAgICAgICAgICAgICAgLnBvcCgpXHJcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgLTEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoJ2RhdGE6IHtcInBhdGhcIjpcIi8nKVxyXG4gICAgICAgICAgICAgICAgLnBvcCgpXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoXCIsXCIpWzBdXHJcbiAgICAgICAgICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgLTEpO1xyXG5cclxuICAgIH07XHJcblxyXG4gICAgTG9uZ1BvbGxSZXNwb25zZVBhcnNlci5wcm90b3R5cGUucGFyc2VDb21tYW5kQW5zd2VyID0gZnVuY3Rpb24gcGFyc2VDb21tYW5kQW5zd2VyKFxyXG4gICAgICAgIHJlc3BvbnNlXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgZGF0YTtcclxuICAgICAgICB2YXIgaXBEYXRhO1xyXG4gICAgICAgIHZhciBhc2tRdWVzdGlvbkRhdGE7XHJcbiAgICAgICAgdmFyIGl0SXNJUEluZm9ybWF0aW9uID0gL2dldElwLy50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKTtcclxuICAgICAgICB2YXIgaXRJc1F1ZXN0aW9uc0luZm9ybWF0aW9uID0gL2Fza1F1ZXN0aW9uLy50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKTtcclxuXHJcbiAgICAgICAgaWYoaXRJc0lQSW5mb3JtYXRpb24gJiYgaXRJc1F1ZXN0aW9uc0luZm9ybWF0aW9uKSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSByZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXS5zcGxpdCgvZGF0YToge1wicGF0aFwiOlwiXFwvXCIsXCJkYXRhXCI6LykucG9wKCkuc3BsaXQoXCJ9LFwiKTtcclxuICAgICAgICAgICAgYXNrUXVlc3Rpb25EYXRhID0gSlNPTi5wYXJzZShkYXRhWzBdKyBcIn19XCIpO1xyXG4gICAgICAgICAgICBpcERhdGEgPSBKU09OLnBhcnNlKFwie1wiICsgZGF0YVsxXS50cmltKCkuc2xpY2UoMCwtMSkpO1xyXG4gICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgYXNrUXVlc3Rpb25EYXRhLFxyXG4gICAgICAgICAgICAgICAgaXBEYXRhXHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9IGVsc2UgaWYgKGl0SXNJUEluZm9ybWF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlVXNlcklwRGF0YShyZXNwb25zZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChpdElzUXVlc3Rpb25zSW5mb3JtYXRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VRdWVzdGlvbnNEYXRhKHJlc3BvbnNlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLnBhcnNlVXNlcklwRGF0YSA9IGZ1bmN0aW9uIHBhcnNlVXNlcklwRGF0YShcclxuICAgICAgICByZXNwb25zZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgaWYoaXRJc0ZpcnN0SXBEYXRhUmVndWxhci50ZXN0KHJlc3BvbnNlKSkge1xyXG4gICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXS5zcGxpdChpdElzRmlyc3RJcERhdGFSZWd1bGFyKS5wb3AoKS50cmltKCkuc2xpY2UoMCwtMikpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdLnNwbGl0KGV2ZW50UmVndWxhcikucG9wKCkuc3BsaXQoXCJkYXRhOiB7XFxcInBhdGhcXFwiOlxcXCIvZ2V0SXBcXFwiLFxcXCJkYXRhXFxcIjpcIikucG9wKCkudHJpbSgpLnNsaWNlKDAsLTEpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLnBhcnNlUXVlc3Rpb25zRGF0YSA9IGZ1bmN0aW9uIHBhcnNlUXVlc3Rpb25zRGF0YShcclxuICAgICAgICByZXNwb25zZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgaWYoaXRJc0ZpcnN0UXVlc3Rpb25zRGF0YS50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKSkge1xyXG4gICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXS5zcGxpdChpdElzRmlyc3RRdWVzdGlvbnNEYXRhKS5wb3AoKS50cmltKCkuc2xpY2UoMCwtMikpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaXRJc05ld1F1ZXN0aW9uc0NvbW1hbmQudGVzdChyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXSkpIHtcclxuICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0uc3BsaXQoaXRJc05ld1F1ZXN0aW9uc0NvbW1hbmQpLnBvcCgpLnRyaW0oKS5zbGljZSgwLC0xKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoXCJ7XFxcImFza1F1ZXN0aW9uXFxcIjp7XFxcIlwiICsgcmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0uc3BsaXQoXCJkYXRhOiB7XFxcInBhdGhcXFwiOlxcXCIvYXNrUXVlc3Rpb24vXCIpLnBvcCgpLnJlcGxhY2UoXCJcXFwiLFxcXCJkYXRhXFxcIlwiLCBcIlxcXCJcIikgKyBcIn1cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlKHRleHQpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gdGV4dC5zcGxpdChldmVudFJlZ3VsYXIpO1xyXG4gICAgICAgIHZhciBjaGFuZ2VUeXBlID0gdGhpcy5nZXRUeXBlT2ZDaGFuZ2VzKHJlc3VsdFtyZXN1bHQubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgIHZhciByZXN1bHRPZlBhcnNlID0geyB0eXBlOiBjaGFuZ2VUeXBlIH07XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzTmV3RGF0YShyZXN1bHQpKSB7XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2VUeXBlID09PSBcIm1lc3NhZ2VcIiB8fCBjaGFuZ2VUeXBlID09PSBcInJlYWRcIikge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0T2ZQYXJzZS5vYmplY3QgPSB0aGlzLnBhcnNlVXNlcnNNZXNzYWdlcyhyZXN1bHQsIGNoYW5nZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdE9mUGFyc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VUeXBlID09PSBcInNlbmROZXdNZXNzYWdlXCIgfHxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVR5cGUgPT09IFwibGFzdE9ubGluZVwiIHx8XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VUeXBlID09PSBcInVzZXJMaXN0XCJcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRPZlBhcnNlLm9iamVjdCA9IHRoaXMucGFyc2VVc2VyTGlzdChyZXN1bHQsIGNoYW5nZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdE9mUGFyc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbmdlVHlwZSA9PT0gXCJnZXRJcFwiIHx8IGNoYW5nZVR5cGUgPT09IFwiYXNrUXVlc3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICByZXN1bHRPZlBhcnNlLm9iamVjdCA9IHRoaXMucGFyc2VDb21tYW5kQW5zd2VyKHJlc3VsdCwgY2hhbmdlVHlwZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0T2ZQYXJzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgTG9uZ1BvbGxSZXNwb25zZVBhcnNlcigpO1xyXG59KSgpO1xyXG5cclxuLy8gaW5zdHJ1Y3Rpb25zXHJcblxyXG4vKiBnbG9iYWwgaW5zdHJ1Y3Rpb25RdWV1ZU1hbmFnZXIgKi9cclxudmFyIGluc3RydWN0aW9uUGVyZm9ybWVyID0gKGZ1bmN0aW9uIChjb25maWcsIGRhdGFDb25uZWN0b3IsIHBhcnNlcikge1xyXG5cclxuICAgIHZhciBpbnN0cnVjdGlvbnMgPSB7XHJcbiAgICAgICAgZ2V0SXA6IGdldFVzZXJJUCxcclxuICAgICAgICBhc2tRdWVzdGlvbjogc2hvd1F1ZXN0aW9uXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBxdWVzdGlvbkxpc3RlbmVyID0gbnVsbDtcclxuICAgIHZhciBpc1BlcmZvcm1lZCA9IGZhbHNlO1xyXG5cclxuICAgIHZhciBpbnN0cnVjdGlvblF1ZXVlTWFuYWdlciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBcclxuICAgICAgICB2YXIgaW5zdHJ1Y3Rpb25zUXVldWUgPSBbXTtcclxuICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGFkZEluc3RydWN0aW9ucyAoaW5zdHJ1Y3Rpb25zKSB7XHJcbiAgICAgICAgICAgIHZhciBpbnN0cnVjdGlvbk9iamVjdDtcclxuICAgICAgICAgICAgaWYoaW5zdHJ1Y3Rpb25zIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChpbnN0cnVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFpdFdhc0V4ZWN1dGVkKGluc3RydWN0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbnNRdWV1ZS5wdXNoKGluc3RydWN0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmKCFpdFdhc0V4ZWN1dGVkKGluc3RydWN0aW9ucykpIHtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uT2JqZWN0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uT2JqZWN0W2luc3RydWN0aW9ucy5jb21tYW5kTmFtZV0gPSBpbnN0cnVjdGlvbnM7XHJcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbnNRdWV1ZS5wdXNoKGluc3RydWN0aW9uT2JqZWN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIHByZXBhcmVJbnN0cnVjdGlvbkJlZm9yZUV4ZWN1dGUgKGluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciBpbnN0cnVjdGlvbkRhdGEgPSB7fTtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMoaW5zdHJ1Y3Rpb24pLm1hcChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbkRhdGEucGFyYW1ldGVycyA9IGdldFBhcmFtZXRlcnMoaW5zdHJ1Y3Rpb25ba2V5XSk7XHJcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbkRhdGEuaW5zdHVjdGlvbk5hbWUgPSBrZXk7XHJcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbkRhdGEudHlwZU9mQ29tbWFuZCA9IGluc3RydWN0aW9uW2tleV0udHlwZU9mQ29tbWFuZDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnN0cnVjdGlvbkRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0UGFyYW1ldGVycyhjb21tYW5kRGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgcGFyYW1ldGVycyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgaTtcclxuICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgY29tbWFuZERhdGEucGFyYW1ldGVyc051bWJlcjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzLnB1c2goY29tbWFuZERhdGFbXCJwYXJhbWV0ZXJcIiArIGldKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJhbWV0ZXJzO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGl0V2FzRXhlY3V0ZWQgKGluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciBpc0V4ZWN1dGUgPSB0cnVlO1xyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhpbnN0cnVjdGlvbikubWFwKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIGlzRXhlY3V0ZSA9IGluc3RydWN0aW9uW2tleV0uaXNFeGVjdXRlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGlzRXhlY3V0ZTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBmdW5jdGlvbiBnZXROZXh0SW5zdHJ1Y3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudEluc3RydWN0aW9uO1xyXG4gICAgICAgICAgICBpZihpbnN0cnVjdGlvbnNRdWV1ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50SW5zdHJ1Y3Rpb24gPSBpbnN0cnVjdGlvbnNRdWV1ZS5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByZXBhcmVJbnN0cnVjdGlvbkJlZm9yZUV4ZWN1dGUoY3VycmVudEluc3RydWN0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEFQSSAoKSB7XHJcbiAgICAgICAgICAgIHZhciBpbnN0cnVjdGlvbnNRdWV1ZUFQSSA9IHt9O1xyXG4gICAgXHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uc1F1ZXVlQVBJLm5leHQgPSBnZXROZXh0SW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uc1F1ZXVlQVBJLmFkZCA9IGFkZEluc3RydWN0aW9ucztcclxuICAgIFxyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbnNRdWV1ZUFQSSxcclxuICAgICAgICAgICAgICAgIFwibGVuZ3RoXCIsXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnN0cnVjdGlvbnNRdWV1ZS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24obmV3VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uc1F1ZXVlLmxlbmd0aCA9IG5ld1ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICBcclxuICAgICAgICAgICAgcmV0dXJuIGluc3RydWN0aW9uc1F1ZXVlQVBJO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHJldHVybiBnZXRBUEkoKTtcclxuICAgIFxyXG4gICAgfSkoKTtcclxuXHJcbiAgICBmdW5jdGlvbiBleGVjdXRlQ29tbWFuZCAoaW5zdHJ1Y3Rpb25OYW1lLCBkYXRhLCB0eXBlT2ZDb21tYW5kLCBjYWxsYmFjaywgY29udGV4dCwgaXNOZWVkTm90aWZ5LCBpc1NhdmVEYXRhKSB7XHJcbiAgICAgICAgdmFyIHBlcmZvcm1lck9iamVjdCA9IGluc3RydWN0aW9uc1tpbnN0cnVjdGlvbk5hbWVdLmNhbGwobnVsbCwgZGF0YSwgaW5zdHJ1Y3Rpb25OYW1lLCBjYWxsYmFjaywgY29udGV4dCwgaXNOZWVkTm90aWZ5LCBpc1NhdmVEYXRhKTtcclxuICAgICAgICBpZih0eXBlT2ZDb21tYW5kID09PSBcImFzeW5jXCIpIHtcclxuICAgICAgICAgICAgcGVyZm9ybWVyT2JqZWN0LnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbm90aWZ5KGluc3RydWN0aW9uTmFtZSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRJUCAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGFDb25uZWN0b3IucmVxdWVzdChcclxuICAgICAgICAgICAgXCJodHRwczovL2dlb2lwLWRiLmNvbS9qc29uL1wiLFxyXG4gICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICBcIkdFVFwiLFxyXG4gICAgICAgICAgICBcIm11bHRpcGFydC9mb3JtLWRhdGFcIlxyXG4gICAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzYXZlUmVzdWx0KGRhdGEsIGRhdGFOYW1lKSB7XHJcbiAgICAgICAgdmFyIHVzZXIgPSBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQ7XHJcbiAgICAgICAgcmV0dXJuIGRhdGFDb25uZWN0b3IucmVxdWVzdChcclxuICAgICAgICAgICAgXCJodHRwczovL29ubGluZWNvbnN1bHRhbnR3ZWJhcHAuZmlyZWJhc2Vpby5jb20vdXNlcnNTZXR0aW5ncy9cIiArIHVzZXIgKyBcIi9cIiArIGRhdGFOYW1lICsgXCIuanNvblwiLFxyXG4gICAgICAgICAgICBkYXRhLFxyXG4gICAgICAgICAgICBcIlBVVFwiLFxyXG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRVc2VySVAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGdldElQKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2F2ZVJlc3VsdChkYXRhLCBcImNvbW1hbmRzUmVzcG9uc2UvZ2V0SXBcIilcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGJhc2ljUXVlc3Rpb25DYWxsYmFjayAoaW5zdHJ1Y3Rpb25OYW1lLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIGlucHV0VmFsdWUgPSAgZ2V0RWxlbWVudChcclxuICAgICAgICAgICAgY29uZmlnLkRPTS5VU0VSX05BTUVfSU5QVVRfQ0xBU1NcclxuICAgICAgICApLnZhbHVlO1xyXG4gICAgICAgIHZhciBpbnB1dERhdGEgPSBKU09OLnN0cmluZ2lmeShpbnB1dFZhbHVlKTtcclxuICAgICAgICBzYXZlUmVzdWx0KGlucHV0RGF0YSwgXCJjb21tYW5kc1Jlc3BvbnNlL1wiICsgaW5zdHJ1Y3Rpb25OYW1lICsgXCIvXCIgKyBkYXRhWzFdKVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiB0b2dnbGVRdWVzdGlvbk1lbnVWaXNpYmxlICgpIHtcclxuICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uQVVUSE9SSVpBVElPTl9NRU5VX0NMQVNTKS5jbGFzc0xpc3QudG9nZ2xlKFxyXG4gICAgICAgICAgICBjb25maWcuSU5WSVNJQkxFX0NMQVNTXHJcbiAgICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNob3dRdWVzdGlvbihkYXRhLCBpbnN0cnVjdGlvbk5hbWUsIGNhbGxiYWNrLCBjb250ZXh0LCBpc05lZWROb3RpZnksIGlzU2F2ZURhdGEpIHtcclxuICAgICAgICB2YXIgZnVsbENhbGxiYWNrO1xyXG4gICAgICAgIGZ1bGxDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdG9nZ2xlUXVlc3Rpb25NZW51VmlzaWJsZSgpO1xyXG4gICAgICAgICAgICBpZihpc05lZWROb3RpZnkpIHtcclxuICAgICAgICAgICAgICAgIG5vdGlmeShpbnN0cnVjdGlvbk5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKGNvbnRleHQsIGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKGlzU2F2ZURhdGEpIHtcclxuICAgICAgICAgICAgICAgIGJhc2ljUXVlc3Rpb25DYWxsYmFjay5jYWxsKGNvbnRleHQsIGluc3RydWN0aW9uTmFtZSwgZGF0YSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc2V0dXBRdWVzdGlvbk1lbnUoZGF0YSk7XHJcbiAgICAgICAgaWYocXVlc3Rpb25MaXN0ZW5lcikge1xyXG4gICAgICAgICAgICByZW1vdmVQcmV2aW91c1F1ZXN0aW9uTGlzdGVuZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcXVlc3Rpb25MaXN0ZW5lciA9IGdldEFuc3dlck9uUXVlc3Rpb24uYmluZChudWxsLCBmdWxsQ2FsbGJhY2spO1xyXG4gICAgICAgIHNldHVwTmV3UXVlc3Rpb25MaXN0ZW5lcigpO1xyXG4gICAgICAgIHRvZ2dsZVF1ZXN0aW9uTWVudVZpc2libGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzZXR1cFF1ZXN0aW9uTWVudShkYXRhKSB7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLkNIQVRfUVVFU1RJT05fQ1NTKS5pbm5lckhUTUwgPSBkYXRhWzFdO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNldHVwTmV3UXVlc3Rpb25MaXN0ZW5lcigpIHtcclxuICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uU0VORF9VU0VSX05BTUVfQlVUVE9OKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcXVlc3Rpb25MaXN0ZW5lcilcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZW1vdmVQcmV2aW91c1F1ZXN0aW9uTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFTkRfVVNFUl9OQU1FX0JVVFRPTikucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHF1ZXN0aW9uTGlzdGVuZXIpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0QW5zd2VyT25RdWVzdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICBjYWxsYmFjaygpXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY2hlY2tBdmFpbGFiaWxpdHlOZXdJbnN0cnVjdGlvbnMgKCkge1xyXG4gICAgICAgIHZhciBrZXlPZkNvbW1hbmRzO1xyXG4gICAgICAgIHZhciBwYXJhbWV0ZXJzO1xyXG4gICAgICAgIHZhciBrZXk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRhdGFDb25uZWN0b3IucmVxdWVzdChcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5DT01NQU5EX1BBVEhfUFJFRklYICsgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkICsgXCIvY29tbWFuZHMuanNvblwiLFxyXG4gICAgICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgICAgIFwiR0VUXCIsXHJcbiAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICAgICAgICApLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGtleU9mQ29tbWFuZHMgPSBoYXNJbnN0cnVjdGlvbktleShkYXRhKTtcclxuICAgICAgICAgICAgICAgIGlmKGtleU9mQ29tbWFuZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGtleSA9IGtleU9mQ29tbWFuZHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVycyA9IGdldFBhcmFtZXRlcnMoZGF0YVtrZXldKTtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0cnVjdGlvblBlcmZvcm1lci5leGVjdXRlKGtleSwgcGFyYW1ldGVycywgZGF0YVtrZXldLnR5cGVPZkNvbW1hbmQsIGNoZWNrQXZhaWxhYmlsaXR5TmV3SW5zdHJ1Y3Rpb25zLCBudWxsLCB0cnVlLCB0cnVlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGVja0F2YWlsYWJpbGl0eU5ld0luc3RydWN0aW9ucygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sY29uZmlnLlVQREFURV9VU0VSX0RBVEFfVElNRSlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRQYXJhbWV0ZXJzKGNvbW1hbmREYXRhKSB7XHJcbiAgICAgICAgdmFyIHBhcmFtZXRlcnMgPSBbXTtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICBmb3IoaSA9IDA7IGkgPCBjb21tYW5kRGF0YS5wYXJhbWV0ZXJzTnVtYmVyOyBpKyspIHtcclxuICAgICAgICAgICAgcGFyYW1ldGVycy5wdXNoKGNvbW1hbmREYXRhW1wicGFyYW1ldGVyXCIgKyBpXSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBhcmFtZXRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaGFzSW5zdHJ1Y3Rpb25LZXkoY29tbWFuZHMpIHtcclxuICAgICAgICBpZighY29tbWFuZHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoY29tbWFuZHMpLmZpbHRlcihmdW5jdGlvbiAoY29tbWFuZE9iamVjdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIWNvbW1hbmRzW2NvbW1hbmRPYmplY3RdLmlzRXhlY3V0ZTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG5vdGlmeSAocGF0aE9mTm90aWZ5KSB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGFDb25uZWN0b3IucmVxdWVzdChcclxuICAgICAgICAgICAgY29uZmlnLkNPTU1BTkRfUEFUSF9QUkVGSVggKyBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQgKyBcIi9jb21tYW5kcy9cIiArIHBhdGhPZk5vdGlmeSArIFwiL2lzRXhlY3V0ZS5qc29uXCIsXHJcbiAgICAgICAgICAgIHRydWUsXHJcbiAgICAgICAgICAgIFwiUFVUXCIsXHJcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzZXR1cExvbmdQb2xsQ29ubmVjdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBkYXRhQ29ubmVjdG9yLmNyZWF0ZUxvbmdQb2xsQ29ubmVjdGlvbihcclxuICAgICAgICAgICAgY29uZmlnLkNPTU1BTkRfUEFUSF9QUkVGSVggKyBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQgKyBcIi9jb21tYW5kcy5qc29uXCJcclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbm5lY3Rpb24ub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gY29tbWFuZENoYW5nZUNhbGxiYWNrICgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IDMgJiYgdGhpcy5zdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgZGF0YSA9IHBhcnNlci5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCkub2JqZWN0O1xyXG4gICAgICAgICAgICAgICAgaWYoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uUXVldWVNYW5hZ2VyLmFkZChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICBleGVjdXRlQWxsSW5zdHJ1Y3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29ubmVjdGlvbi5zZW5kKClcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBleGVjdXRlQWxsSW5zdHJ1Y3Rpb24gKGl0SXNUaGlzU3RyZWFtKSB7XHJcbiAgICAgICAgdmFyIGluc3RydWN0aW9uO1xyXG4gICAgICAgIGlmKGluc3RydWN0aW9uUXVldWVNYW5hZ2VyLmxlbmd0aCA+IDAgJiYgKGl0SXNUaGlzU3RyZWFtIHx8ICFpc1BlcmZvcm1lZCkpIHtcclxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24gPSBpbnN0cnVjdGlvblF1ZXVlTWFuYWdlci5uZXh0KCk7XHJcbiAgICAgICAgICAgIGlzUGVyZm9ybWVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgZXhlY3V0ZUNvbW1hbmQoXHJcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbi5pbnN0dWN0aW9uTmFtZSxcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uLnBhcmFtZXRlcnMsXHJcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbi50eXBlT2ZDb21tYW5kLFxyXG4gICAgICAgICAgICAgICAgZXhlY3V0ZUFsbEluc3RydWN0aW9uLmJpbmQobnVsbCwgdHJ1ZSksXHJcbiAgICAgICAgICAgICAgICBudWxsLCB0cnVlLCB0cnVlXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIGlmKGl0SXNUaGlzU3RyZWFtKSB7XHJcbiAgICAgICAgICAgIGlzUGVyZm9ybWVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGV4ZWN1dGU6IGV4ZWN1dGVDb21tYW5kLFxyXG4gICAgICAgIHNldHVwOiBjaGVja0F2YWlsYWJpbGl0eU5ld0luc3RydWN0aW9ucyxcclxuICAgICAgICBzZXR1cExvbmdQb2xsQ29ubmVjdGlvbjogc2V0dXBMb25nUG9sbENvbm5lY3Rpb25cclxuICAgIH07XHJcblxyXG59KShtYWluQ29uZmlnLCBkYXRhQ29ubmVjdG9yLCBsb25nUG9sbFJlc3BvbnNlUGFyc2VyKTtcclxuXHJcbi8vIG1lc3NhZ2VNYW5hZ2VyXHJcblxyXG4vKiBnbG9iYWwgZ2V0RWxlbWVudCAqL1xyXG4vKiBnbG9iYWwgbWFpbkNvbmZpZyAqL1xyXG4vKiBleHBvcnRlZCBtZXNzYWdlTGlzdE1hbmFnZXIgKi9cclxuLy8g0JzQvtC00YPQu9GMINC00LvRjyDRgNCw0LHQvtGC0Ysg0YHQviDRgdC/0LjRgdC60L7QvCDRgdC+0L7QsdGJ0LXQvdC40Lkg0J7QlNCd0J7Qk9CeINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xyXG52YXIgbWVzc2FnZUxpc3RNYW5hZ2VyID0gKGZ1bmN0aW9uIHNldHVwTWVzc2FnZUxpc3RNYW5hZ2VyIChjb25maWcpIHtcclxuICAgIC8vICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICAvLyDQpNC+0YDQvNCw0YIgIG1lc3NhZ2VMaXN0ID0gW1xyXG4gICAgLy8gICAge1xyXG4gICAgLy8gICAgICAgc2VuZGVyOiBzZW5kZXJcclxuICAgIC8vICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXHJcbiAgICAvLyAgICAgICByZWFkOiB0cnVlL2ZhbHNlXHJcbiAgICAvLyAgICAgICBkYXRlOiBkYXRlXHJcbiAgICAvLyAgICB9LFxyXG4gICAgLy8gXVxyXG4gICAgLy8gcmVhZCAtINCx0YvQu9C+INC70Lgg0L/RgNC+0YfQuNGC0LDQvdC+INGB0L7QvtCx0YnQtdC90LjQtVxyXG4gICAgLy8gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICBmdW5jdGlvbiBNZXNzYWdlTGlzdE1hbmFnZXIoKSB7fVxyXG5cclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUuc2V0dXAgPSBmdW5jdGlvbiBzZXR1cCAoKSB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlTGlzdCA9IFtdO1xyXG4gICAgICAgIHRoaXMuY0RPTSA9IHtcclxuICAgICAgICAgICAgbWVzc2FnZXNCbG9jazogZ2V0RWxlbWVudChcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5tZXNzYWdlcy5DU1NfQ0hBVF9NRVNTQUdFU19DT05UQUlORVJcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBXT1JLIFdJVEggTUVTU0FHRSBFTEVNRU5UIC8vXHJcblxyXG4gICAgLy8g0KHQvtC30LTQsNC10YIgRE9NINGN0LvQtdC80LXQvdGCINGB0L7QvtCx0YnQtdC90LjRjyDQtNC70Y8g0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDQvdCwINGN0LrRgNCw0L3QtVxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS5jcmVhdGVNZXNzYWdlRWxlbWVudCA9IGZ1bmN0aW9uIGNyZWF0ZU1lc3NhZ2VFbGVtZW50KFxyXG4gICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgbWVzc2FnZURhdGUsXHJcbiAgICAgICAgc2VuZGVyLFxyXG4gICAgICAgIGlzUmVhZFxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2VDb250YWluZXJEaXYgPSB0aGlzLmNyZWF0ZU1lc3NhZ2VDb250YWluZXJEaXYoaXNSZWFkLCBzZW5kZXIpO1xyXG4gICAgICAgIHZhciBtZXNzYWdlRGF0ZURpdiA9IHRoaXMuY3JlYXRlRGl2Rm9yTWVzc2FnZUJsb2NrKFxyXG4gICAgICAgICAgICBtZXNzYWdlRGF0ZSxcclxuICAgICAgICAgICAgY29uZmlnLkRJU1BMQVlfTUVTU0FHRV9EQVRFLFxyXG4gICAgICAgICAgICBbY29uZmlnLm1lc3NhZ2VzLkNTU19DSEFUX01FU1NBR0VfREFURV1cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICB2YXIgbWVzc2FnZVNlbmRlckRpdiA9IHRoaXMuY3JlYXRlRGl2Rm9yTWVzc2FnZUJsb2NrKFxyXG4gICAgICAgICAgICBzZW5kZXIsXHJcbiAgICAgICAgICAgIGNvbmZpZy5ESVNQTEFZX1NFTkRFUl9OQU1FLFxyXG4gICAgICAgICAgICBbY29uZmlnLm1lc3NhZ2VzLkNTU19DSEFUX01FU1NBR0VfU0VOREVSX05BTUVdXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgdmFyIG1lc3NhZ2VEaXYgPSB0aGlzLmNyZWF0ZURpdkZvck1lc3NhZ2VCbG9jayhcclxuICAgICAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICAgICAgY29uZmlnLkRJU1BMQVlfTUVTU0FHRSxcclxuICAgICAgICAgICAgW2NvbmZpZy5tZXNzYWdlcy5DU1NfQ0hBVF9NRVNTQUdFXVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIG1lc3NhZ2VDb250YWluZXJEaXYuYXBwZW5kQ2hpbGQobWVzc2FnZURhdGVEaXYpO1xyXG4gICAgICAgIG1lc3NhZ2VDb250YWluZXJEaXYuYXBwZW5kQ2hpbGQobWVzc2FnZVNlbmRlckRpdik7XHJcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZChtZXNzYWdlRGl2KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2VDb250YWluZXJEaXY7XHJcbiAgICB9O1xyXG5cclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUuZ2V0TWVzc2FnZU9iamVjdHNGb3JNYXJrQXNSZWFkID0gZnVuY3Rpb24gIGdldE1lc3NhZ2VPYmplY3RzRm9yTWFya0FzUmVhZCAoKSB7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2VzSXNSZWFkID0gW107XHJcbiAgICAgICAgdmFyIHVzZXJOYW1lID0gY29uZmlnLkFETUlOX05BTUUgfHwgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWU7XHJcbiAgICAgICAgdmFyIHVzZXJJZCA9IGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZDtcclxuICAgICAgICBmb3IoaSA9IHRoaXMubWVzc2FnZUxpc3QubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgaWYodGhpcy5tZXNzYWdlTGlzdFtpXS5zZW5kZXIgIT09IHVzZXJOYW1lKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZighdGhpcy5tZXNzYWdlTGlzdFtpXS5yZWFkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXNJc1JlYWQucHVzaChcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZE5hbWU6IHRoaXMubWVzc2FnZUxpc3RbaV0uaWQgKyBcIi9yZWFkXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZFZhbHVlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUxpc3RbaV0ucmVhZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtZXNzYWdlc0lzUmVhZDtcclxuICAgIH07XHJcblxyXG5cclxuXHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLmNyZWF0ZU1lc3NhZ2VDb250YWluZXJEaXYgPSBmdW5jdGlvbiBjcmVhdGVNZXNzYWdlQ29udGFpbmVyRGl2IChpc1JlYWQsIHNlbmRlcikge1xyXG4gICAgICAgIHZhciBtZXNzYWdlQ29udGFpbmVyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBtZXNzYWdlQ29udGFpbmVyRGl2LmNsYXNzTGlzdC5hZGQoY29uZmlnLm1lc3NhZ2VzLkNTU19NRVNTQUdFX0NPTlRBSU5FUik7XHJcbiAgICAgICAgaWYgKCFpc1JlYWQgJiYgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWUgIT09IHNlbmRlcikge1xyXG4gICAgICAgICAgICBtZXNzYWdlQ29udGFpbmVyRGl2LmNsYXNzTGlzdC5hZGQoY29uZmlnLm1lc3NhZ2VzLkNTU19VU0VSX05PVF9SRUFEX01FU1NBR0VTKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2VDb250YWluZXJEaXY7XHJcbiAgICB9O1xyXG5cclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUuY3JlYXRlRGl2Rm9yTWVzc2FnZUJsb2NrID0gZnVuY3Rpb24gY3JlYXRlRGl2Rm9yTWVzc2FnZUJsb2NrICh0ZXh0LCBpc0Rpc3BsYXksIHN0eWxlQ2xhc3Nlcykge1xyXG4gICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHN0eWxlQ2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIGNsYXNzQWRkIChzdHlsZSkge1xyXG4gICAgICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChzdHlsZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZGl2LmlubmVySFRNTCA9IHRleHQ7XHJcbiAgICAgICAgcmV0dXJuIGRpdjtcclxuICAgIH07XHJcblxyXG4gICAgLy8gV09SSyBXSVRIIE1FU1NBR0UgRUxFTUVOVCAvL1xyXG5cclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUuY3JlYXRlTWVzc2FnZUxpc3QgPSBmdW5jdGlvbiBjcmVhdGVNZXNzYWdlTGlzdCAobWVzc2FnZU9iamVjdHMpICB7XHJcbiAgICAgICAgdmFyIG5ld01lc3NhZ2VMaXN0ID0gW107XHJcbiAgICAgICAgaWYobWVzc2FnZU9iamVjdHMpIHtcclxuICAgICAgICAgICAgbWVzc2FnZU9iamVjdHMuZm9yRWFjaChmdW5jdGlvbiBhZGRFbGVtZW50VG9NZXNzYWdlTGlzdCAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgbmV3TWVzc2FnZUxpc3QucHVzaChlbGVtZW50KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXdNZXNzYWdlTGlzdDtcclxuICAgIH07XHJcblxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS51cGRhdGVNZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIHVwZGF0ZU1lc3NhZ2VMaXN0IChuZXdNZXNzYWdlTGlzdCkge1xyXG4gICAgICAgIGlmKHRoaXMuZ2V0TWVzc2FnZU9iamVjdHNGb3JNYXJrQXNSZWFkKCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5yZWFkTGFzdE1lc3NhZ2UgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlTGlzdCA9IG5ld01lc3NhZ2VMaXN0O1xyXG4gICAgICAgIHRoaXMuZGlzcGxheU1lc3NhZ2VzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUuYWRkTWVzc2FnZVRvTWVzc2FnZUxpc3QgPSBmdW5jdGlvbiBhZGRNZXNzYWdlVG9NZXNzYWdlTGlzdCAoXHJcbiAgICAgICAgbWVzc2FnZU9ialxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlTGlzdC5wdXNoKG1lc3NhZ2VPYmopO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyDQn9C10YDQtdCx0LjRgNCw0LXRgiDRgdC/0LjRgdC+0Log0YHQvtC+0LHRidC10L3QuNC5LCDRgdC+0LfQtNCw0LXRgiDRgdC+0L7RgtCy0LXRgtGB0LLRg9GO0YnQuNC1INC40LwgRE9NINGN0LvQtdC80LXQvdGC0Ysg0Lgg0LLRgdGC0LDQstC70Y/QtdGCINC40YUg0LIg0YfQsNGCXHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLmRpc3BsYXlNZXNzYWdlcyA9IGZ1bmN0aW9uIGRpc3BsYXlNZXNzYWdlcygpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5jbGVhckNoYXQoKTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VMaXN0LmZvckVhY2goZnVuY3Rpb24gY3JlYXRlTWVzc2FnZSAobWVzc2FnZU9iamVjdCkge1xyXG4gICAgICAgICAgICBlbGVtZW50ID0gdGhhdC5jcmVhdGVNZXNzYWdlRWxlbWVudChcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VPYmplY3QubWVzc2FnZSxcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VPYmplY3QuZGF0ZSxcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VPYmplY3Quc2VuZGVyLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU9iamVjdC5yZWFkXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHRoYXQuY0RPTS5tZXNzYWdlc0Jsb2NrLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyDQntGH0LjRgdGC0LjRgtGMIERPTSDRjdC70LXQvNC10L3RgiDQsiDQutC+0YLQvtGA0L7QvCDQvtGC0L7QsdGA0LDQttCw0Y7RgtGB0Y8g0YHQvtC+0LHRidC10L3QuNGPICjQvdCw0L/RgNC40LzQtdGAINGH0YLQvtCx0Ysg0LLRgdGC0LDQstC40YLRjCDQvdCy0L7Ri9C5INGB0L/QuNGB0L7QuiDRgdC+0L7QsdGJ0LXQvdC40LkpXHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLmNsZWFyQ2hhdCA9IGZ1bmN0aW9uIGNsZWFyQ2hhdCgpIHtcclxuICAgICAgICB3aGlsZSAodGhpcy5jRE9NLm1lc3NhZ2VzQmxvY2suZmlyc3RDaGlsZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNET00ubWVzc2FnZXNCbG9jay5yZW1vdmVDaGlsZCh0aGlzLmNET00ubWVzc2FnZXNCbG9jay5maXJzdENoaWxkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgTWVzc2FnZUxpc3RNYW5hZ2VyKCk7XHJcblxyXG59KShtYWluQ29uZmlnKTtcclxuLyogZXhwb3J0ZWQgdXNlckRhdGFNYW5hZ2VyICovXHJcbi8qIGdsb2JhbCBkYXRhU291cmNlICovXHJcbi8qIGdsb2JhbCBtZXNzYWdlTGlzdE1hbmFnZXIgKi9cclxuLyogZ2xvYmFsIGNyZWF0ZU1lc3NhZ2VPYmplY3QgKi9cclxuLyogZ2xvYmFsIGdldEN1cnJlbnREYXRlICovXHJcbi8qIGdsb2JhbCBnZXRFbGVtZW50ICovXHJcbi8qIGdsb2JhbCBldmVudEVtaXR0ZXIgKi9cclxuLyogZ2xvYmFsIG1haW5Db25maWcgKi9cclxuLyogZ2xvYmFsIGxvbmdQb2xsUmVzcG9uc2VQYXJzZXIgKi9cclxudmFyIHVzZXJEYXRhTWFuYWdlciA9ICAoZnVuY3Rpb24gY3JlYXRlVXNlckRhdGFNYW5hZ2VyIChjb25maWcsIGV2ZW50RW1pdHRlciwgbG9uZ1BvbGxSZXNwb25zZVBhcnNlcikge1xyXG5cclxuICAgIC8vIElOQ0xVREVcclxuXHJcbiAgICAvKiBleHBvcnRlZCBnZXRDdXJyZW50RGF0ZSAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0Q3VycmVudERhdGUoKSB7XHJcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIHZhciBtaW51dGVzID0gKGRhdGUuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkubGVuZ3RoID09PSAxKSA/IFwiMFwiICsgZGF0ZS5nZXRNaW51dGVzKCkgOiBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICByZXR1cm4gZGF0ZVxyXG4gICAgICAgICAgICAuZ2V0SG91cnMoKVxyXG4gICAgICAgICAgICAudG9TdHJpbmcoKVxyXG4gICAgICAgICAgICAuY29uY2F0KFwiOlwiLCBtaW51dGVzKTtcclxuICAgIH1cclxuICAgIC8qIGV4cG9ydGVkIGNyZWF0ZU1lc3NhZ2VPYmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZU1lc3NhZ2VPYmplY3QgKFxyXG4gICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgZGF0ZSxcclxuICAgICAgICBzZW5kZXIsXHJcbiAgICAgICAgaXNSZWFkLFxyXG4gICAgICAgIGlkXHJcbiAgICApIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZW5kZXI6IHNlbmRlcixcclxuICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcclxuICAgICAgICAgICAgcmVhZDogaXNSZWFkLFxyXG4gICAgICAgICAgICBkYXRlOiBkYXRlLFxyXG4gICAgICAgICAgICBpZDogaWRcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIElOQ0xVREVcclxuXHJcbiAgICAvLyBiYXNpY1xyXG4gICAgZnVuY3Rpb24gZ2V0VXNlckRhdGFCYXNpYyAodXNlcklkKSB7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiBnZXRDb3JyZXNwb25kZW5jZSAocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhhdC5nZXRVc2VyQ29ycmVzcG9uZGVuY2UodXNlcklkKS50aGVuKCBmdW5jdGlvbiBnZXRSZXNvbHZlICgpIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZU1lc3NhZ2VMaXN0QmFzaWMgKGRhdGEpIHtcclxuICAgICAgICB2YXIgbmV3TWVzc2FnZUxpc3Q7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2VzT2JqZWN0ID0gW107XHJcbiAgICAgICAgaWYoZGF0YSkge1xyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhkYXRhKS5tYXAoZnVuY3Rpb24gcHVzaERhdGEgKGtleSkge1xyXG4gICAgICAgICAgICAgICAgZGF0YVtrZXldLmlkID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZXNPYmplY3QucHVzaChkYXRhW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIuZGlzcGxheU1lc3NhZ2VzKCk7XHJcbiAgICAgICAgbmV3TWVzc2FnZUxpc3QgPSBtZXNzYWdlTGlzdE1hbmFnZXIuY3JlYXRlTWVzc2FnZUxpc3QobWVzc2FnZXNPYmplY3QpO1xyXG4gICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci51cGRhdGVNZXNzYWdlTGlzdChuZXdNZXNzYWdlTGlzdCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0VXNlckNvcnJlc3BvbmRlbmNlQmFzaWMgKHVzZXJJZCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICByZXR1cm4gZGF0YVNvdXJjZS51c2Vyc0FQSS5nZXRVc2VyTWVzc2FnZXModXNlcklkKSgpLnRoZW4oZnVuY3Rpb24gdXBkYXRlTWVzc2FnZXNMaXN0IChkYXRhKSB7XHJcbiAgICAgICAgICAgIHRoYXQudXBkYXRlTWVzc2FnZUxpc3QoZGF0YSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRVc2VyRGF0YUZyb21Mb25nUG9sbENvbm5lY3Rpb24odXNlcklkKSB7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiBnZXRMb25nUG9sbENvcnJlc3BvbmRlbmNlKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgdGhhdC5nZXRVc2VyQ29ycmVzcG9uZGVuY2UodXNlcklkKTtcclxuICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFVzZXJDb3JyZXNwb25kZW5jZUZyb21Mb25nUG9sbENvbm5lY3Rpb24odXNlcklkKSB7XHJcbiAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgaWYoY29uZmlnLmN1cnJlbnRNZXNzYWdlQ29ubmVjdGlvbikge1xyXG4gICAgICAgICAgICBjb25maWcuY3VycmVudE1lc3NhZ2VDb25uZWN0aW9uLmFib3J0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbmZpZy5jdXJyZW50TWVzc2FnZUNvbm5lY3Rpb24gPSBkYXRhU291cmNlLnVzZXJzQVBJLmdldFVzZXJNZXNzYWdlcyh1c2VySWQpO1xyXG4gICAgICAgIGNvbmZpZy5jdXJyZW50TWVzc2FnZUNvbm5lY3Rpb24ub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gc2V0dXBDb25uZWN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gMyAmJiB0aGlzLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhID0gbG9uZ1BvbGxSZXNwb25zZVBhcnNlci5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50RW1pdHRlci5lbWl0KGRhdGEudHlwZSwgZGF0YS5vYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25maWcuY3VycmVudE1lc3NhZ2VDb25uZWN0aW9uLnNlbmQoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB1cGRhdGVNZXNzYWdlTGlzdEFmdGVyTG9uZ1BvbGwgKGRhdGEpIHtcclxuICAgICAgICBpZihkYXRhKSB7XHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGRhdGEpLm1hcChmdW5jdGlvbiBhZGRUb01lc3NhZ2VMaXN0TG9uZ1BvbGwgKGtleSkge1xyXG4gICAgICAgICAgICAgICAgZGF0YVtrZXldLmlkID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLmFkZE1lc3NhZ2VUb01lc3NhZ2VMaXN0KGRhdGFba2V5XSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5kaXNwbGF5TWVzc2FnZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBVc2VyRGF0YU1hbmFnZXIgKCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICBpZihjb25maWcuY2hhdFNldHRpbmdzLnR5cGVPZlJlcXVlc3QgPT09IFwibG9uZ1BvbGxcIikge1xyXG4gICAgICAgICAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLmdldFVzZXJEYXRhID0gZ2V0VXNlckRhdGFGcm9tTG9uZ1BvbGxDb25uZWN0aW9uLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuZ2V0VXNlckNvcnJlc3BvbmRlbmNlID0gZ2V0VXNlckNvcnJlc3BvbmRlbmNlRnJvbUxvbmdQb2xsQ29ubmVjdGlvbi5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZU1lc3NhZ2VMaXN0ID0gdXBkYXRlTWVzc2FnZUxpc3RBZnRlckxvbmdQb2xsLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIGV2ZW50RW1pdHRlci5hZGRTdWJzY3JpYmUoXCJtZXNzYWdlXCIsIGZ1bmN0aW9uIHN1YnNjcmliZU1lc3NhZ2UgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHRoYXQudXBkYXRlTWVzc2FnZUxpc3QoZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBldmVudEVtaXR0ZXIuYWRkU3Vic2NyaWJlKFwicmVhZFwiLCBmdW5jdGlvbiBzdWJzY3JpYmVSZWFkIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLm1lc3NhZ2VMaXN0LmZvckVhY2goZnVuY3Rpb24gZGlzcGxheU1lc3NhZ2VzIChtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1lc3NhZ2UuaWQgPT09IGRhdGEuaWQpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5yZWFkID0gZGF0YS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5kaXNwbGF5TWVzc2FnZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuZ2V0VXNlckRhdGEgPSBnZXRVc2VyRGF0YUJhc2ljLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuZ2V0VXNlckNvcnJlc3BvbmRlbmNlID0gZ2V0VXNlckNvcnJlc3BvbmRlbmNlQmFzaWMuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS51cGRhdGVNZXNzYWdlTGlzdCA9IHVwZGF0ZU1lc3NhZ2VMaXN0QmFzaWMuYmluZCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5zZXR1cCA9IGZ1bmN0aW9uIHNldHVwICgpIHtcclxuICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIuc2V0dXAoKTtcclxuICAgIH07XHJcblxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5jbGVhck1lc3NhZ2VMaXN0ID0gZnVuY3Rpb24gY2xlYXJNZXNzYWdlTGlzdCAoKSB7XHJcbiAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLm1lc3NhZ2VMaXN0ID0gW107XHJcbiAgICB9O1xyXG5cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuY3JlYXRlTmV3VXNlclByb2ZpbGVUb0RhdGFCYXNlID0gZnVuY3Rpb24gY3JlYXRlTmV3VXNlclByb2ZpbGVUb0RhdGFCYXNlICh1c2VySWQsIHVzZXJOYW1lKSB7XHJcbiAgICAgICAgZGF0YVNvdXJjZS51c2Vyc0FQSS5hZGROZXdVc2VyVG9EYXRhU291cmNlKHVzZXJJZCwgdXNlck5hbWUpO1xyXG4gICAgfTtcclxuXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLnNhdmVTZXR0aW5nRmllbGQgPSBmdW5jdGlvbiBzZXRGaWVsZCAoZmllbGROYW1lKSB7XHJcbiAgICAgICAgZGF0YVNvdXJjZS51c2Vyc0FQSS5zZXRTZXR0aW5nRmllbGQoXHJcbiAgICAgICAgICAgIGZpZWxkTmFtZSxcclxuICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkLFxyXG4gICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5nc1tmaWVsZE5hbWVdXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcblxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS51cGRhdGVVc2VyT25saW5lID0gZnVuY3Rpb24gdXBkYXRlVXNlck9ubGluZSAodXNlcklkKSB7XHJcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZTtcclxuICAgICAgICBkYXRhU291cmNlLnVzZXJzQVBJLnVwZGF0ZUxhc3RPbmxpbmUodXNlcklkLCBkYXRlLmdldFRpbWUoKSlcclxuICAgIH07XHJcblxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uIHNlbmRNZXNzYWdlICgpIHtcclxuICAgICAgICB2YXIgbWVzc2FnZSA9IHRoaXMuZ2V0TWVzc2FnZUZyb21JbnB1dEVsZW1lbnQoKTtcclxuICAgICAgICB2YXIgZGF0ZSA9IGdldEN1cnJlbnREYXRlKCk7XHJcbiAgICAgICAgdmFyIHVzZXJOYW1lID0gY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWUgfHwgY29uZmlnLkFETUlOX05BTUU7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2VPYmplY3QgPSBjcmVhdGVNZXNzYWdlT2JqZWN0KFxyXG4gICAgICAgICAgICBtZXNzYWdlLFxyXG4gICAgICAgICAgICBkYXRlLFxyXG4gICAgICAgICAgICB1c2VyTmFtZSxcclxuICAgICAgICAgICAgZmFsc2VcclxuICAgICAgICApO1xyXG4gICAgICAgIGlmKGNvbmZpZy5jaGF0U2V0dGluZ3MudHlwZU9mUmVxdWVzdCAhPT0gXCJsb25nUG9sbFwiKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5hZGRNZXNzYWdlVG9NZXNzYWdlTGlzdChtZXNzYWdlT2JqZWN0KTtcclxuICAgICAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLmRpc3BsYXlNZXNzYWdlcygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNhdmVNZXNzYWdlVG9EYXRhU291cmNlKG1lc3NhZ2VPYmplY3QpO1xyXG4gICAgfTtcclxuXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLmdldE1lc3NhZ2VGcm9tSW5wdXRFbGVtZW50ID0gZnVuY3Rpb24gZ2V0TWVzc2FnZUZyb21JbnB1dEVsZW1lbnQgKCkge1xyXG4gICAgICAgIHZhciBlbGVtZW50ID0gZ2V0RWxlbWVudChjb25maWcuQ1NTX0NVUlJFTlRfSU5QVVRfQ0xBU1MpO1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQudmFsdWU7XHJcbiAgICAgICAgZWxlbWVudC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfTtcclxuXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLnNldE1lc3NhZ2VBc1JlYWQgPSBmdW5jdGlvbiBzZXRNZXNzYWdlQXNSZWFkICgpIHtcclxuICAgICAgICB2YXIgbWVzc2FnZU9iamVjdHMgPSBtZXNzYWdlTGlzdE1hbmFnZXIuZ2V0TWVzc2FnZU9iamVjdHNGb3JNYXJrQXNSZWFkKCk7XHJcbiAgICAgICAgaWYobWVzc2FnZU9iamVjdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBtZXNzYWdlT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uIHNldFJlYWQgKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2UudXNlcnNBUEkudXBkYXRlTWVzc2FnZUlzUmVhZEZpZWxkKFxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZmllbGROYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZmllbGRWYWx1ZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnJlYWRMYXN0TWVzc2FnZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5kaXNwbGF5TWVzc2FnZXMoKTtcclxuICAgIH07XHJcblxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5zYXZlTWVzc2FnZVRvRGF0YVNvdXJjZSA9IGZ1bmN0aW9uIHNhdmVNZXNzYWdlVG9EYXRhU291cmNlIChtZXNzYWdlT2JqZWN0KSB7XHJcbiAgICAgICAgaWYobWVzc2FnZU9iamVjdC5zZW5kZXIgPT09IGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lKSB7XHJcbiAgICAgICAgICAgIGRhdGFTb3VyY2UudXNlcnNBUEkudXBkYXRlU2VuZE5ld01lc3NhZ2VGbGFnKGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZCx0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGF0YVNvdXJjZS51c2Vyc0FQSS5zZW5kTWVzc2FnZShcclxuICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkLFxyXG4gICAgICAgICAgICBtZXNzYWdlT2JqZWN0XHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gU2V0dGluZ3MgPSBbe3VzZXJJZCwgZmllbGROYW1lLCBmaWVsZFZhbHVlfSx7fS4uLl1cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuc2F2ZVVzZXJTZXR0aW5nc1RvRGF0YVNvdXJjZSA9IGZ1bmN0aW9uIHNhdmVVc2VyU2V0dGluZ3NUb0RhdGFTb3VyY2UgKHNldHRpbmdzKSB7XHJcbiAgICAgICAgc2V0dGluZ3MuZm9yRWFjaChmdW5jdGlvbiBzYXZlU2V0dGluZyAobmV3RmllbGRTZXR0aW5nKSB7XHJcbiAgICAgICAgICAgIGRhdGFTb3VyY2UudXNlcnNBUEkuc2V0U2V0dGluZ0ZpZWxkKFxyXG4gICAgICAgICAgICAgICAgbmV3RmllbGRTZXR0aW5nLmZpZWxkTmFtZSxcclxuICAgICAgICAgICAgICAgIG5ld0ZpZWxkU2V0dGluZy51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBuZXdGaWVsZFNldHRpbmcuZmllbGRWYWx1ZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgcmV0dXJuIG5ldyBVc2VyRGF0YU1hbmFnZXIoKTtcclxuXHJcbn0pKG1haW5Db25maWcsIGV2ZW50RW1pdHRlciwgbG9uZ1BvbGxSZXNwb25zZVBhcnNlcik7XHJcblxyXG4vLyB2aWV3XHJcblxyXG4vKiBleHBvcnRlZCB2aWV3RmFjdG9yeSAqL1xyXG4vKiBnbG9iYWwgZ2V0RWxlbWVudCAqL1xyXG4vKiBnbG9iYWwgZGF0YVNvdXJjZSAqL1xyXG52YXIgdmlld0ZhY3RvcnkgPSAoZnVuY3Rpb24gY3JlYXRlVmlld0ZhY3RvcnkgKGRhdGFTb3VyY2UpIHtcclxuXHJcbiAgICBmdW5jdGlvbiBWaWV3RmFjdG9yeSAoKSB7fVxyXG5cclxuICAgIFZpZXdGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVWaWV3ID0gZnVuY3Rpb24gY3JlYXRlQ2hhdFZpZXcgKGh0bWxQYXRoLCBjc3NQYXRoLCBjb250YWluZXJDbGFzcykge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gY3JlYXRlVmlld1Byb21pc2UgKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBpZihodG1sUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgaWYoY3NzUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaW5jbHVkZVZpZXdDc3NUb1BhZ2UodGhhdC5jcmVhdGVDU1NMaW5rKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3NQYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN0eWxlc2hlZXRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0ZXh0L2Nzc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRvdWNoLXNvZnQtY2hhdC1jc3NcIlxyXG4gICAgICAgICAgICAgICAgICAgICkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGF0LmluY2x1ZGVWaWV3SFRNTFRvUGFnZShodG1sUGF0aCwgY29udGFpbmVyQ2xhc3MpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJodG1sUGF0aCBpcyBudWxsLiBQbGVhc2UgYWRkIGh0bWxQYXRoXCIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBWaWV3RmFjdG9yeS5wcm90b3R5cGUuaW5jbHVkZVZpZXdIVE1MVG9QYWdlID0gZnVuY3Rpb24gaW5jbHVkZUNoYXRIVE1MVG9QYWdlIChodG1sUGF0aCwgY29udGFpbmVyQ2xhc3MpIHtcclxuICAgICAgICB2YXIgY29udGFpbmVyRGl2ID0gKGNvbnRhaW5lckNsYXNzKSA/IGdldEVsZW1lbnQoY29udGFpbmVyQ2xhc3MpIDogZG9jdW1lbnQuYm9keTtcclxuICAgICAgICByZXR1cm4gZGF0YVNvdXJjZS5jb21tb25BUEkuZ2V0SFRNTChodG1sUGF0aCkudGhlbihmdW5jdGlvbiBzZXRIdG1sIChodG1sKSB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lckRpdi5pbm5lckhUTUwgPSBodG1sO1xyXG4gICAgICAgIH0pXHJcbiAgICB9O1xyXG5cclxuICAgIFZpZXdGYWN0b3J5LnByb3RvdHlwZS5pbmNsdWRlVmlld0Nzc1RvUGFnZSA9IGZ1bmN0aW9uIGluY2x1ZGVDaGF0Q3NzVG9QYWdlIChsaW5rKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChsaW5rKTtcclxuICAgIH07XHJcblxyXG4gICAgVmlld0ZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZUNTU0xpbmsgPSBmdW5jdGlvbiBjcmVhdGVDU1NMaW5rKFxyXG4gICAgICAgIGZpbGVQYXRoLFxyXG4gICAgICAgIHJlbCxcclxuICAgICAgICB0eXBlLFxyXG4gICAgICAgIGlkXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xyXG4gICAgICAgIGlmIChpZCkge1xyXG4gICAgICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZShcImlkXCIsIGlkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJlbCkge1xyXG4gICAgICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZShcInJlbFwiLCByZWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgdHlwZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKFwiaHJlZlwiLCBmaWxlUGF0aCk7XHJcbiAgICAgICAgcmV0dXJuIGxpbms7XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgVmlld0ZhY3RvcnkoKVxyXG5cclxufSkoZGF0YVNvdXJjZSk7XHJcblxyXG4vLyBjaGF0TWFpblxyXG5cclxuLyogZXhwb3J0ZWQgY2hhdEN1c3RvbWl6ZXIgKi9cclxuLyogZ2xvYmFsIGNoYXRDdXN0b21pemVyICovXHJcbi8qIGdsb2JhbCBnZXRFbGVtZW50ICovXHJcbi8qIGdsb2JhbCBtYWluQ29uZmlnICovXHJcbnZhciBjaGF0Q3VzdG9taXplciA9IChmdW5jdGlvbiBjcmVhdGVDaGF0Q3VzdG9taXplciAoY29uZmlnKSB7XHJcblxyXG4gICAgZnVuY3Rpb24gQ2hhdEN1c3RvbWl6ZXIoKSB7fVxyXG5cclxuICAgIENoYXRDdXN0b21pemVyLnByb3RvdHlwZS5zZXR1cE91dGVyQ2hhdFNldHRpbmdzID0gZnVuY3Rpb24gc2V0dXBPdXRlckNoYXRTZXR0aW5ncygpIHtcclxuICAgICAgICB0aGlzLmFsbG93TWluaW1pemUoKTtcclxuICAgICAgICB0aGlzLnNldFBvc2l0aW9uT2ZNYWluQmxvY2soKTtcclxuICAgICAgICB0aGlzLnNldFRpdGxlKCk7XHJcbiAgICAgICAgdGhpcy5zZXRNYWluQ3NzQ2xhc3MoKTtcclxuICAgICAgICB0aGlzLmFsbG93RHJhZ05Ecm9wKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDdXN0b21pemVyLnByb3RvdHlwZS5hbGxvd0RyYWdORHJvcCA9IGZ1bmN0aW9uIGFsbG93RHJhZ05Ecm9wKCkge1xyXG4gICAgICAgIHZhciBjbGlja0Jsb2NrID0gZ2V0RWxlbWVudChjb25maWcuRE9NLlRJVExFX0JMT0NLX0NMQVNTKTtcclxuICAgICAgICB2YXIgZHJhZ0Jsb2NrID0gZ2V0RWxlbWVudChjb25maWcuRE9NLk1BSU5fU1RZTEVfQ0hBVF9CTE9DS19DTEFTUyk7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5jaGF0U2V0dGluZ3MuYWxsb3dEcmFnID09PSBcImZhbHNlXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjbGlja0Jsb2NrLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gZHJhZ0FuZERyb3AoZSkge1xyXG4gICAgICAgICAgICB2YXIgY29yZHM7XHJcbiAgICAgICAgICAgIHZhciBzaGlmdFg7XHJcbiAgICAgICAgICAgIHZhciBzaGlmdFk7XHJcbiAgICAgICAgICAgIHZhciBtb3ZlT2JqO1xyXG4gICAgICAgICAgICB2YXIgc2V0TnVsbDtcclxuICAgICAgICAgICAgdmFyIGVuZERyYWc7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRDb29yZHMoZWxlbSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJveCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcDogYm94LnRvcCArIHdpbmRvdy5wYWdlWU9mZnNldCxcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiBib3gubGVmdCArIHdpbmRvdy5wYWdlWE9mZnNldFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29yZHMgPSBnZXRDb29yZHMoZHJhZ0Jsb2NrKTtcclxuICAgICAgICAgICAgc2hpZnRYID0gZS5wYWdlWCAtIGNvcmRzLmxlZnQ7XHJcbiAgICAgICAgICAgIHNoaWZ0WSA9IGUucGFnZVkgLSBjb3Jkcy50b3A7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBtb3ZlQXQoZWxlbSkge1xyXG4gICAgICAgICAgICAgICAgZHJhZ0Jsb2NrLnN0eWxlLmxlZnQgPSBlbGVtLnBhZ2VYIC0gc2hpZnRYICsgXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgZHJhZ0Jsb2NrLnN0eWxlLnRvcCA9IGVsZW0ucGFnZVkgLSBzaGlmdFkgKyBcInB4XCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG1vdmVPYmogPSBmdW5jdGlvbiBtb3ZlT2JqRHJhZ0FuZERyb3AoZWxlbSkge1xyXG4gICAgICAgICAgICAgICAgbW92ZUF0KGVsZW0pO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgc2V0TnVsbCA9IGZ1bmN0aW9uIHNldE51bGxEcmFnQW5kRHJvcCAoKSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsbW92ZU9iaiApO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIixzZXROdWxsICk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBlbmREcmFnID0gZnVuY3Rpb24gZW5kRHJhZ0FuZERyb3AoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBtb3ZlQXQoZSk7XHJcbiAgICAgICAgICAgIGRyYWdCbG9jay5zdHlsZS56SW5kZXggPSAxMDAwO1xyXG5cclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBtb3ZlT2JqKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgc2V0TnVsbCk7XHJcbiAgICAgICAgICAgIGRyYWdCbG9jay5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIGVuZERyYWcpO1xyXG5cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdEN1c3RvbWl6ZXIucHJvdG90eXBlLnNldFBvc2l0aW9uT2ZNYWluQmxvY2sgPSBmdW5jdGlvbiBzZXRQb3NpdGlvbk9mTWFpbkJsb2NrKCkge1xyXG4gICAgICAgIGlmIChjb25maWcuY2hhdFNldHRpbmdzLnBvc2l0aW9uID09PSBcInJpZ2h0XCIpIHtcclxuICAgICAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLk1BSU5fU1RZTEVfQ0hBVF9CTE9DS19DTEFTUykuY2xhc3NMaXN0LmFkZChcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5DSEFUX1BPU0lUSU9OX1JJR0hUXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLk1BSU5fU1RZTEVfQ0hBVF9CTE9DS19DTEFTUykuY2xhc3NMaXN0LmFkZChcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5DSEFUX1BPU0lUSU9OX0xFRlRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDdXN0b21pemVyLnByb3RvdHlwZS5zZXRUaXRsZSA9IGZ1bmN0aW9uIHNldFRpdGxlKCkge1xyXG4gICAgICAgIGlmKGNvbmZpZy5jaGF0U2V0dGluZ3MuY2hhdFRpdGxlLmxlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgY29uZmlnLmNoYXRTZXR0aW5ncy5jaGF0VGl0bGUgPSBjb25maWcuREVGQVVMVF9DSEFUX1RJVExFO1xyXG4gICAgICAgIH1cclxuICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uVElUTEVfQkxPQ0tfQ0xBU1MpLmlubmVySFRNTCA9IGNvbmZpZy5jaGF0U2V0dGluZ3MuY2hhdFRpdGxlO1xyXG4gICAgfTtcclxuXHJcbiAgICBDaGF0Q3VzdG9taXplci5wcm90b3R5cGUuYWxsb3dNaW5pbWl6ZSA9IGZ1bmN0aW9uIGFsbG93TWluaW1pemUoKSB7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5jaGF0U2V0dGluZ3MuYWxsb3dNaW5pbWl6ZSA9PT0gXCJmYWxzZVwiKSB7XHJcbiAgICAgICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5DSEFOR0VfU1RZTEVfQlVUVE9OX01BWF9TSVpFKS5jbGFzc0xpc3QuYWRkKFxyXG4gICAgICAgICAgICAgICAgY29uZmlnLklOVklTSUJMRV9DTEFTU1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgQ2hhdEN1c3RvbWl6ZXIucHJvdG90eXBlLnNldE1haW5Dc3NDbGFzcyA9IGZ1bmN0aW9uIHNldE1haW5Dc3NDbGFzcygpIHtcclxuICAgICAgICBpZihjb25maWcuY2hhdFNldHRpbmdzLm91dGVyQ3NzQ2xhc3MubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgICAgICBjb25maWcuY2hhdFNldHRpbmdzLm91dGVyQ3NzQ2xhc3MgPSBjb25maWcuREVGQVVMVF9DU1NfQ0xBU1NfRk9SX0NIQVQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5NQUlOX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZChcclxuICAgICAgICAgICAgY29uZmlnLmNoYXRTZXR0aW5ncy5vdXRlckNzc0NsYXNzXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBDaGF0Q3VzdG9taXplcigpO1xyXG59KShtYWluQ29uZmlnKTtcclxuLyogZ2xvYmFsIHVzZXJEYXRhTWFuYWdlciAqL1xyXG4vKiBnbG9iYWwgY2hhdEN1c3RvbWl6ZXIgKi9cclxuLyogZ2xvYmFsIGdldEhhc2ggKi9cclxuLyogZ2xvYmFsIGdldEVsZW1lbnQgKi9cclxuLyogZ2xvYmFsIG1haW5Db25maWcgKi9cclxuLyogZ2xvYmFsIHZpZXdGYWN0b3J5ICovXHJcbi8qIGdsb2JhbCBldmVudEVtaXR0ZXIgKi9cclxudmFyIGNoYXRDb250cm9sbGVyID0gKGZ1bmN0aW9uIGNyZWF0ZUNoYXRDb250cm9sbGVyIChjb25maWcsIGluc3RydWN0aW9uUGVyZm9ybWVyLCB1c2VyRGF0YU1hbmFnZXIpIHtcclxuXHJcbiAgICB2YXIgZGF0YUZvckdldFVzZXJOYW1lQ2FsbGJhY2sgPSBbXHJcbiAgICAgICAgXCJhdXRob3JpemF0aW9uXCIsXHJcbiAgICAgICAgXCJlbnRlciB5b3VyIG5hbWUsIHBsZWFzZVwiLFxyXG4gICAgICAgIFwiXCJcclxuICAgIF07XHJcblxyXG4gICAgLy8gSU5DTFVERSAvL1xyXG5cclxuICAgIC8qIGV4cG9ydGVkIGdldEhhc2ggKi9cclxuICAgIGZ1bmN0aW9uIGdldEhhc2goc3RyKSB7XHJcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIHJldHVybiBzdHIgKyBkYXRlLmdldFRpbWUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJTkNMVURFIC8vXHJcblxyXG4gICAgZnVuY3Rpb24gQ2hhdENvbnRyb2xsZXIoKSB7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVOZXdVc2VyID0gdXNlckRhdGFNYW5hZ2VyLmNyZWF0ZU5ld1VzZXJQcm9maWxlVG9EYXRhQmFzZVxyXG4gICAgfVxyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5zdGFydEFwcCA9IGZ1bmN0aW9uIHN0YXJ0QXBwQmFzaWMgKCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICAvLyBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShjb25maWcuTE9DQUxfU1RPUkFHRV9OQU1FKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXR1cENoYXRWaWV3KCkudGhlbiggZnVuY3Rpb24gc3RhcnRBdXRob3JpemF0aW9uQW5kQmFzaWNMaXN0ZW5lcnMgKCkge1xyXG4gICAgICAgICAgICB0aGF0LmF1dGhvcml6YXRpb24oY29uZmlnLmNoYXRTZXR0aW5ncy5yZXF1aXJlTmFtZSk7XHJcbiAgICAgICAgICAgIHRoYXQuc2V0dXBDaGF0QmFzaWNMaXN0ZW5lcnMoKTtcclxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIGFmdGVyU2V0dXBWaWV3Q29uZmlndXJhdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHVzZXJEYXRhTWFuYWdlci5nZXRVc2VyRGF0YShjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQpLnRoZW4oZnVuY3Rpb24gYWZ0ZXJVc2VyRGF0YVNldHVwICgpIHtcclxuICAgICAgICAgICAgICAgIHRoYXQuc2V0dXBDaGF0U3R5bGUoKTtcclxuICAgICAgICAgICAgICAgIHRoYXQuc2V0dXBDaGF0U2VuZExpc3RlbmVycygpO1xyXG4gICAgICAgICAgICAgICAgY2hhdEN1c3RvbWl6ZXIuc2V0dXBPdXRlckNoYXRTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgaWYoY29uZmlnLmNoYXRTZXR0aW5ncy50eXBlT2ZSZXF1ZXN0ID09PSBcImxvbmdQb2xsXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0cnVjdGlvblBlcmZvcm1lci5zZXR1cExvbmdQb2xsQ29ubmVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0cnVjdGlvblBlcmZvcm1lci5zZXR1cCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBhdXRob3JpemF0aW9uIGJsb2NrIC8vXHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb24gPSBmdW5jdGlvbiBhdXRob3JpemF0aW9uICh1c2VyTmFtZUlzUmVxdWlyZSkge1xyXG4gICAgICAgIHVzZXJEYXRhTWFuYWdlci5zZXR1cCgpO1xyXG4gICAgICAgIGlmKCF0aGlzLmdldENvbmRpdGlvbkZyb21Mb2NhbFN0b3JhZ2UoKSkge1xyXG4gICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQgPSBnZXRIYXNoKFxyXG4gICAgICAgICAgICAgICAgY29uZmlnLkRFRkFVTFRfVVNFUl9OQU1FXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmKHVzZXJOYW1lSXNSZXF1aXJlID09PSBcImZhbHNlXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lID0gY29uZmlnLkRFRkFVTFRfVVNFUl9OQU1FO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlQ29uZGl0aW9uVG9Mb2NhbFN0b3JhZ2UoKTtcclxuICAgICAgICAgICAgICAgIHVzZXJEYXRhTWFuYWdlci5jcmVhdGVOZXdVc2VyUHJvZmlsZVRvRGF0YUJhc2UoY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkLCBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHVwSW50ZXJ2YWxGdW5jdGlvbnMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uUGVyZm9ybWVyLmV4ZWN1dGUoXHJcbiAgICAgICAgICAgICAgICAgICAgXCJhc2tRdWVzdGlvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFGb3JHZXRVc2VyTmFtZUNhbGxiYWNrLFxyXG4gICAgICAgICAgICAgICAgICAgIFwicGVuZGluZ1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VXNlck5hbWVGcm9tSW5wdXQsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZXR1cENoYXRDb25kaXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy5zZXR1cEludGVydmFsRnVuY3Rpb25zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUudG9nZ2xlQXV0aG9yaXphdGlvbk1lbnVWaXNpYmxlID0gZnVuY3Rpb24gdG9nZ2xlQXV0aG9yaXphdGlvbk1lbnVWaXNpYmxlICgpIHtcclxuICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uQVVUSE9SSVpBVElPTl9NRU5VX0NMQVNTKS5jbGFzc0xpc3QudG9nZ2xlKFxyXG4gICAgICAgICAgICBjb25maWcuSU5WSVNJQkxFX0NMQVNTXHJcbiAgICAgICAgKVxyXG4gICAgfTtcclxuXHJcblxyXG4gICAgLy8g0JXRgdC70Lgg0YLRgNC10LHRg9C10YLRgdGPINCy0LLQtdGB0YLQuCDQuNC80Y8sINC/0L7Qu9GD0YfQsNC10Lwg0LXQs9C+INC4INC30LDQvdC+0YHQuNC8INGO0LfQtdGA0LAg0LIg0LHQtFxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLmdldFVzZXJOYW1lRnJvbUlucHV0ID0gZnVuY3Rpb24gZ2V0VXNlck5hbWVGcm9tSW5wdXQgKCkge1xyXG4gICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lID0gZ2V0RWxlbWVudChcclxuICAgICAgICAgICAgY29uZmlnLkRPTS5VU0VSX05BTUVfSU5QVVRfQ0xBU1NcclxuICAgICAgICApLnZhbHVlO1xyXG4gICAgICAgIGNvbmZpZy5jaGF0U2V0dGluZ3MuaXNNaW5pbWl6ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlTmV3VXNlcihjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQsIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lKTtcclxuICAgICAgICB0aGlzLnNldHVwSW50ZXJ2YWxGdW5jdGlvbnMoKTtcclxuICAgICAgICB0aGlzLnNhdmVDb25kaXRpb25Ub0xvY2FsU3RvcmFnZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBTZXR1cCBDaGF0IC8vXHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwQ2hhdFNlbmRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBzZXR1cENoYXRTZW5kTGlzdGVuZXJzICgpIHtcclxuICAgICAgICAvLyBzZXR1cCBjaGF0IGxpc3RlbmVyc1xyXG4gICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5TRU5EX01FU1NBR0VfRlVMTF9TSVpFX0JVVFRPTikuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAgICAgJ2NsaWNrJyxcclxuICAgICAgICAgICAgdXNlckRhdGFNYW5hZ2VyLnNlbmRNZXNzYWdlLmJpbmQodXNlckRhdGFNYW5hZ2VyLFxyXG4gICAgICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWVcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5TRU5EX01FU1NBR0VfTUlOX1NJWkVfQlVUVE9OKS5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAnY2xpY2snLFxyXG4gICAgICAgICAgICB1c2VyRGF0YU1hbmFnZXIuc2VuZE1lc3NhZ2UuYmluZCh1c2VyRGF0YU1hbmFnZXIsXHJcbiAgICAgICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHVzZXJEYXRhTWFuYWdlci5zZXRNZXNzYWdlQXNSZWFkLmJpbmQodXNlckRhdGFNYW5hZ2VyKSk7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5zZXR1cENoYXRCYXNpY0xpc3RlbmVycyA9IGZ1bmN0aW9uIHNldHVwQ2hhdEJhc2ljTGlzdGVuZXJzICgpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFVF9NQVhfU1RZTEVfQlVUVE9OKS5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAnY2xpY2snLFxyXG4gICAgICAgICAgICB0aGF0Lm1pbk1heFN0eWxlVG9nZ2xlLmJpbmQodGhhdClcclxuICAgICAgICApO1xyXG4gICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5TRVRfTUlOX1NUWUxFX0JVVFRPTikuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAgICAgJ2NsaWNrJyxcclxuICAgICAgICAgICAgdGhhdC5taW5NYXhTdHlsZVRvZ2dsZS5iaW5kKHRoYXQpXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcblxyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5zZXR1cENoYXRWaWV3ID0gZnVuY3Rpb24gc2V0dXBDaGF0VmlldyAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHZpZXdGYWN0b3J5LmNyZWF0ZVZpZXcoY29uZmlnLkhUTUxfRklMRV9QQVRILCBjb25maWcuQ1NTX0ZJTEVfUEFUSCwgbnVsbCk7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5zZXR1cENoYXRTdHlsZSA9IGZ1bmN0aW9uIHNldHVwQ2hhdFN0eWxlKCkge1xyXG4gICAgICAgIGlmICghY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MuaXNNaW5pbWl6ZSkge1xyXG4gICAgICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uTUFJTl9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTKS5jbGFzc0xpc3QudG9nZ2xlKFxyXG4gICAgICAgICAgICAgICAgY29uZmlnLklOVklTSUJMRV9DTEFTU1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5NSU5JTUlaRV9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTKS5jbGFzc0xpc3QudG9nZ2xlKFxyXG4gICAgICAgICAgICAgICAgY29uZmlnLklOVklTSUJMRV9DTEFTU1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoYW5nZUlucHV0QW5kU2VuZEJ1dHRvbkNsYXNzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5taW5NYXhTdHlsZVRvZ2dsZSA9IGZ1bmN0aW9uIG1pbk1heFN0eWxlVG9nZ2xlKCkge1xyXG4gICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5NQUlOX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgIGNvbmZpZy5JTlZJU0lCTEVfQ0xBU1NcclxuICAgICAgICApO1xyXG4gICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5NSU5JTUlaRV9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTKS5jbGFzc0xpc3QudG9nZ2xlKFxyXG4gICAgICAgICAgICBjb25maWcuSU5WSVNJQkxFX0NMQVNTXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5pc01pbmltaXplID0gY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MuaXNNaW5pbWl6ZSA9PT0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VJbnB1dEFuZFNlbmRCdXR0b25DbGFzcygpO1xyXG4gICAgICAgIHRoaXMuc2F2ZUNvbmRpdGlvblRvTG9jYWxTdG9yYWdlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5hY3Rpdml0eU5vdGlmeSA9IGZ1bmN0aW9uIGFjdGl2aXR5Tm90aWZ5ICgpIHtcclxuICAgICAgICB1c2VyRGF0YU1hbmFnZXIudXBkYXRlVXNlck9ubGluZShjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQpO1xyXG4gICAgfTtcclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuY2hhbmdlSW5wdXRBbmRTZW5kQnV0dG9uQ2xhc3MgPSBmdW5jdGlvbiBjaGFuZ2VJbnB1dEFuZFNlbmRCdXR0b25DbGFzcyAoKSB7XHJcbiAgICAgICAgaWYoY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MuaXNNaW5pbWl6ZSkge1xyXG4gICAgICAgICAgICBjb25maWcuQ1NTX0NVUlJFTlRfSU5QVVRfQ0xBU1MgPSBjb25maWcuRE9NLkNTU19NSU5fU0laRV9JTlBVVF9NRVNTQUdFX0JMT0NLX0NMQVNTXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uZmlnLkNTU19DVVJSRU5UX0lOUFVUX0NMQVNTID0gY29uZmlnLkRPTS5DU1NfTUFYX1NJWkVfSU5QVVRfTUVTU0FHRV9CTE9DS19DTEFTU1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gV09SSyBXSVRIIExPQ0FMIFNUT1JBR0UgLy9cclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuc2V0dXBDaGF0Q29uZGl0aW9uID0gZnVuY3Rpb24gc2V0dXBDaGF0Q29uZGl0aW9uICgpIHtcclxuICAgICAgICB2YXIgY29uZGl0aW9uID0gdGhpcy5nZXRDb25kaXRpb25Gcm9tTG9jYWxTdG9yYWdlKCk7XHJcbiAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkID0gdGhpcy5nZXRDb25kaXRpb25Gcm9tTG9jYWxTdG9yYWdlKCkudXNlcklkO1xyXG4gICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lID0gdGhpcy5nZXRDb25kaXRpb25Gcm9tTG9jYWxTdG9yYWdlKCkudXNlck5hbWU7XHJcbiAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MuaXNNaW5pbWl6ZSA9IGNvbmRpdGlvbi5pc01pbmltaXplO1xyXG4gICAgfTtcclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuc2F2ZUNvbmRpdGlvblRvTG9jYWxTdG9yYWdlID0gZnVuY3Rpb24gc2F2ZUNvbmRpdGlvblRvTG9jYWxTdG9yYWdlKCkge1xyXG4gICAgICAgIHZhciBkYXRhID0gSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICB1c2VySWQ6IGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZCxcclxuICAgICAgICAgICAgaXNNaW5pbWl6ZTogY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MuaXNNaW5pbWl6ZSxcclxuICAgICAgICAgICAgdXNlck5hbWU6IGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY29uZmlnLkxPQ0FMX1NUT1JBR0VfTkFNRSwgZGF0YSk7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5nZXRDb25kaXRpb25Gcm9tTG9jYWxTdG9yYWdlID0gZnVuY3Rpb24gZ2V0Q29uZGl0aW9uRnJvbUxvY2FsU3RvcmFnZSAoKSB7XHJcbiAgICAgICAgdmFyIGNvbmRpdGlvbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGNvbmZpZy5MT0NBTF9TVE9SQUdFX05BTUUpO1xyXG4gICAgICAgIGlmKGNvbmRpdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShjb25kaXRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFdPUksgV0lUSCBMT0NBTCBTVE9SQUdFIC8vXHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwSW50ZXJ2YWxGdW5jdGlvbnMgPSBmdW5jdGlvbiBzZXR1cEludGVydmFsRnVuY3Rpb25zICgpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgc2V0SW50ZXJ2YWwoIGZ1bmN0aW9uIGludGVydmFsRnVuY3Rpb25zICgpIHtcclxuICAgICAgICAgICAgaWYoY29uZmlnLmNoYXRTZXR0aW5ncy50eXBlT2ZSZXF1ZXN0ICE9PSBcImxvbmdQb2xsXCIpIHtcclxuICAgICAgICAgICAgICAgIHVzZXJEYXRhTWFuYWdlci5nZXRVc2VyRGF0YShjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoYXQuYWN0aXZpdHlOb3RpZnkoKTtcclxuICAgICAgICB9LCBjb25maWcuVVBEQVRFX1VTRVJfREFUQV9USU1FKVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IENoYXRDb250cm9sbGVyKCk7XHJcblxyXG59KShtYWluQ29uZmlnLCBpbnN0cnVjdGlvblBlcmZvcm1lciwgdXNlckRhdGFNYW5hZ2VyKTtcclxuXHJcblxyXG5jaGF0Q29udHJvbGxlci5zdGFydEFwcCgpOyJdfQ==
