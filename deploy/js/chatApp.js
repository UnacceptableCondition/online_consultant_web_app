var mainConfig={DOM:{MAIN_STYLE_CHAT_BLOCK_CLASS:"root_chat_for_touchsoft",AUTHORIZATION_MENU_CLASS:"root_chat_for_touchsoft_input-name-block",USER_NAME_INPUT_CLASS:"root_chat_for_touchsoft_input-name",SEND_USER_NAME_BUTTON:"root_chat_for_touchsoft_input-name-button",SEND_MESSAGE_MIN_SIZE_BUTTON:"root_chat_for_touchsoft_minimize-style__send-button",SEND_MESSAGE_FULL_SIZE_BUTTON:"root_chat_for_touchsoft__bottom_send-button",CSS_MAX_SIZE_INPUT_MESSAGE_BLOCK_CLASS:"root_chat_for_touchsoft__textarea",CSS_MIN_SIZE_INPUT_MESSAGE_BLOCK_CLASS:"root_chat_for_touchsoft_minimize-style__message-input",TITLE_BLOCK_CLASS:"root_chat_for_touchsoft-title",CHANGE_STYLE_BUTTON_MAX_SIZE:"root_chat_for_touchsoft__top_minimize-button",MINIMIZE_STYLE_CHAT_BLOCK_CLASS:"root_chat_for_touchsoft_minimize-style",SET_MIN_STYLE_BUTTON:"root_chat_for_touchsoft_minimize-style__max-button",SET_MAX_STYLE_BUTTON:"root_chat_for_touchsoft__top_minimize-button",CHAT_QUESTION_CSS:"root_chat_for_touchsoft_information-enter-name"},DATA_BASE_URL:"https://onlineconsultantwebapp.firebaseio.com",CSS_CURRENT_INPUT_CLASS:"root_chat_for_touchsoft__textarea",currentUserSettings:{userId:null,userName:null,isMinimize:!1,readLastMessage:!1,sendNewMessage:!1,lastOnline:(new Date).getTime()},chatSettings:{allowDrag:!1,position:"right",chatTitle:"TouchSoft Chat",allowMinimize:!0,outerCssClass:"touchsoft-chat_main-block",typeOfRequest:"fetch",requireName:!0},INVISIBLE_CLASS:"invisible",CHAT_POSITION_RIGHT:"root_chat_for_touchsoft_right-position",CHAT_POSITION_LEFT:"root_chat_for_touchsoft_left-position",LOCAL_STORAGE_NAME:"userID_touchsoft_chat_new",DEFAULT_USER_NAME:"guest",DEFAULT_CSS_CLASS_FOR_CHAT:"touchsoft-chat_main-block",DEFAULT_CHAT_TITLE:"TouchSoft Chat",HTML_FILE_PATH:"https://rawgit.com/UnacceptableCondition/online_consultant_web_app/master/app/html/chatApplication/chat.html",CSS_FILE_PATH:"https://rawgit.com/UnacceptableCondition/online_consultant_web_app/master/app/css/chat.css",messages:{CSS_USER_NOT_READ_MESSAGES:"root-touchsoft-dashboard_message-not-read",CSS_CHAT_MESSAGES_CONTAINER:"root_chat_for_touchsoft__top_messages",CSS_MESSAGE_CONTAINER:"root-touchsoft-dashboard_chat-message-elements",CSS_CHAT_MESSAGE_SENDER_NAME:"root-touchsoft-dashboard_chat-message-sender",CSS_CHAT_MESSAGE_DATE:"root-touchsoft-dashboard_chat-message-date",CSS_CHAT_MESSAGE:"root-touchsoft-dashboard_chat-message"},DISPLAY_MESSAGE_DATE:!0,DISPLAY_SENDER_NAME:!0,DISPLAY_MESSAGE:!0,UPDATE_USER_DATA_TIME:5e3,COMMAND_PATH_PREFIX:"https://onlineconsultantwebapp.firebaseio.com/usersSettings/"};function parseSrcForParameters(e){var s={};return e.substr(e.indexOf("?")+1).split("&").forEach(function(e){var t=e.split("=");t[1]=t[1].replace(/'/g,""),s[t[0]]=t[1]}),s}function setOuterChatSettingToConfig(t,s){Object.keys(t).map(function(e){return s.chatSettings[e]=t[e],!0})}setOuterChatSettingToConfig(parseSrcForParameters(document.currentScript.getAttribute("src")),mainConfig);var dataBaseUrl=mainConfig.DATA_BASE_URL,getElement=function(e,t,s){var n=s?"#":".";return t?document.querySelectorAll(n+e):document.querySelector(n+e)},dataConnectorConfig={typeOfRequest:mainConfig.chatSettings.typeOfRequest},dataConnector=function(e){var t;function s(){}return s.prototype.setupDataBaseAPI=function(e){return"fetch"===e?{request:t.requestFetch,getNewConnectorAPI:t.setupDataBaseAPI}:"XHR"===e?{request:t.requestXMR,getNewConnectorAPI:t.setupDataBaseAPI}:{request:t.requestXMR,createLongPollConnection:t.longPoll,getNewConnectorAPI:t.setupDataBaseAPI}},s.prototype.requestFetch=function(e,t,s,n){return fetch(e,{headers:{Accept:n,"Content-Type":n},method:s,body:t}).then(function(e){return"application/json"===n?e.json():e.text()})},s.prototype.requestXMR=function(n,a,r,o){return new Promise(function(e,t){var s=new XMLHttpRequest;s.open(r,n,!0),s.setRequestHeader("Content-Type",o),s.onload=function(){e("application/json"===o?JSON.parse(s.response):s.response)},s.onerror=function(){t(s.statusText)},a?s.send(a):s.send()})},s.prototype.longPoll=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!0),t.setRequestHeader("Accept","text/event-stream"),t},(t=new s).setupDataBaseAPI(e.typeOfRequest)}(dataConnectorConfig),dataSource=function(o,t){var s,a="userList",n="usersMessages",r="usersSettings",i={isMinimize:!1,readLastMessage:!0};function u(){}function c(e,t){var s=this.createRequestPath(dataBaseUrl,t,null,e);return o.createLongPollConnection(s)}function p(e,t){var s=this.createRequestPath(dataBaseUrl,t,null,e);return o.request.bind(null,s,null,"GET","application/json")}return u.prototype.createRequestPath=function(e,t,s,n){var a=e;return null!==n&&(a+="/"+n),null!==t&&(a+="/"+t),null!==s&&(a+="/"+s),a+=".json"},u.prototype.getHTML=function(e){return o.request(e,null,"GET","application/x-www-form-urlencoded; charset=UTF-8")},u.prototype.setData=function(e,t,s,n,a){var r;return r="PUT"===t?this.createRequestPath(dataBaseUrl,n,s,e):this.createRequestPath(dataBaseUrl,n,null,e),o.request(r,JSON.stringify(a),t,"application/json")},u.prototype.addNewUserToDataSource=function(t,e){var s=new Date,n=this;i.userName=e,Object.keys(i).map(function(e){return n.setData(r,"PUT",e,t,i[e]),!0}),this.setData(a,"PUT",null,t,{lastOnline:s.getTime(),sendNewMessage:!1})},u.prototype.getDataSourceAPI=function(e){return e&&(t.chatSettings.typeOfRequest=e),u.prototype.getData="longPoll"===t.chatSettings.typeOfRequest?c:p,{usersAPI:{getUserList:s.getData.bind(s,a),getUserSettings:s.getData.bind(s,r),getUserMessages:s.getData.bind(s,n),getSettingField:s.getData.bind(s,r),sendMessage:s.setData.bind(s,n,"POST"),setSettingField:s.setData.bind(s,r,"PUT"),addNewUserToDataSource:s.addNewUserToDataSource.bind(s),updateLastOnline:s.setData.bind(s,a,"PUT","lastOnline"),updateSendNewMessageFlag:s.setData.bind(s,a,"PUT","sendNewMessage"),updateMessageIsReadField:s.setData.bind(s,n,"PUT")},commonAPI:{getHTML:s.getHTML.bind(s),getDataSourceAPI:s.getDataSourceAPI.bind(s)}}},(s=new u).getDataSourceAPI()}(dataConnector,mainConfig),eventEmitter=function(){function e(){this.events={}}return e.prototype.addSubscribe=function(e,t){var s=this;return this.events[e]||(this.events[e]=[]),this.events[e].push(t),function(){s.events[e]=s.events[e].filter(function(e){return e!==t})}},e.prototype.emit=function(e,t){var s=this.events[e];s&&s.forEach(function(e){e.call(null,t)})},new e}(),longPollResponseParser=function(){var s={message:/message/,userList:/lastOnline.{1,}sendNewMessage/,lastOnline:/"path":"\/\w{1,}\/lastOnline/,sendNewMessage:/"path":"\/\w{1,}\/sendNewMessage/,setting:/readLastMessage/,read:/read/,getIp:/getIp/,askQuestion:/askQuestion/},a=/event: put/,t=/data: null/,r=/","data":/,o=/"path":"\/-/,n=/"data":{"lastOnline":\d+,"sendNewMessage":/,i=/data: {"path":"\/","data":{"getIp":/,u=/data: {"path":"\/","data":{"askQuestion":/,c=/data: {"path":"\/askQuestion","data":/,p=!0;function e(){}return e.prototype.getTypeOfChanges=function(t){return Object.keys(s).filter(function(e){return!!s[e].test(t)&&e})[0]},e.prototype.prepareDataBeforeJsonParse=function(e){return e[e.length-1].split(r)[1].trim().slice(0,-1)},e.prototype.parseUsersMessages=function(e,t){var s,n={},a={};return"read"===t?(n.id=e[e.length-1].split('data: {"path":"/').pop().split('/read","').shift(),n.value=e[e.length-1].split('/read","data":').pop().trim().slice(0,-1),n):o.test(e[e.length-1])?(s=e[e.length-1].split('data: {"path":"/').pop().split(r).shift(),n=JSON.parse(this.prepareDataBeforeJsonParse(e)),a[s]=n,a):this.getFirstData(e)},e.prototype.hasNewData=function(e){return!t.test(e[e.length-1])&&1<e.length},e.prototype.parseUserList=function(e,t){var s={};return p?(p=!1,this.getFirstData(e)):n.test(e[e.length-1])?(s[this.getUserId(e[e.length-1],null)]=this.getFirstData(e),s):(s=JSON.parse(e[e.length-1].split(r)[1].trim().slice(0,-1)),[this.getUserId(e[e.length-1],t),s])},e.prototype.getFirstData=function(e){try{return JSON.parse(this.prepareDataBeforeJsonParse(e))}catch(e){return null}},e.prototype.getUserId=function(e,t){return t?e.split(t).shift().split('data: {"path":"/').pop().slice(0,-1):e.split('data: {"path":"/').pop().split(",")[0].trim().slice(0,-1)},e.prototype.parseCommandAnswer=function(e){var t,s=/getIp/.test(e[e.length-1]),n=/askQuestion/.test(e[e.length-1]);return s&&n?(t=e[e.length-1].split(/data: {"path":"\/","data":/).pop().split("},"),[JSON.parse(t[0]+"}}"),JSON.parse("{"+t[1].trim().slice(0,-1))]):s?this.parseUserIpData(e):n?this.parseQuestionsData(e):void 0},e.prototype.parseUserIpData=function(e){return i.test(e)?JSON.parse('{"getIp":'+e[e.length-1].split(i).pop().trim().slice(0,-1)):JSON.parse(e[e.length-1].split(a).pop().split('data: {"path":"/getIp","data":').pop().trim().slice(0,-1))},e.prototype.parseQuestionsData=function(e){return u.test(e[e.length-1])?JSON.parse('{"askQuestion":'+e[e.length-1].split(u).pop().trim().slice(0,-1)):c.test(e[e.length-1])?JSON.parse(e[e.length-1].split(c).pop().trim().slice(0,-1)):JSON.parse('{"askQuestion":{"'+e[e.length-1].split('data: {"path":"/askQuestion/').pop().replace('","data"','"')+"}")},e.prototype.parse=function(e){var t=e.split(a),s=this.getTypeOfChanges(t[t.length-1]),n={type:s};return!!this.hasNewData(t)&&("message"===s||"read"===s?(n.object=this.parseUsersMessages(t,s),n):"sendNewMessage"===s||"lastOnline"===s||"userList"===s?(n.object=this.parseUserList(t,s),n):("getIp"===s||"askQuestion"===s)&&(n.object=this.parseCommandAnswer(t,s),n))},new e}(),instructionPerformer=function(e,a,t){var n=!1,s=null,r=!1,o=function(){var e,n=[];function t(e){var t;e instanceof Array?e.forEach(function(e){s(e)||n.push(e)}):s(e)||((t=Object.create(null))[e.commandName]=e,n.push(t))}function s(t){var s=!0;return Object.keys(t).map(function(e){s=t[e].isExecute}),s}function a(){var e,t,s;if(0<n.length)return e=n.shift(),t=e,s={},Object.keys(t).map(function(e){s.parameters=function(e){var t,s=[];for(t=0;t<e.parametersNumber;t++)s.push(e["parameter"+t]);return s}(t[e]),s.instuctionName=e,s.typeOfCommand=t[e].typeOfCommand}),s}return(e={}).next=a,e.add=t,Object.defineProperty(e,"length",{get:function(){return n.length},set:function(e){n.length=e},enumerable:!0,configurable:!0}),e}(),i=function(u){var c=null;function p(e,t){var s=u.currentUserSettings.userId;return a.request("https://onlineconsultantwebapp.firebaseio.com/usersSettings/"+s+"/"+t+".json",e,"PUT","application/json")}function e(t,s){return a.request("https://geoip-db.com/json/",null,"GET","multipart/form-data").then(function(e){return p(e,"commandsResponse/getIp").then(function(){return l(t).then(function(){s()})})})}function l(e){return a.request(u.COMMAND_PATH_PREFIX+u.currentUserSettings.userId+"/commands/"+e+"/isExecute.json",!0,"PUT","application/json")}function g(){getElement(u.DOM.AUTHORIZATION_MENU_CLASS).classList.toggle(u.INVISIBLE_CLASS)}function t(e,t,s,n,a,r){var o,i;o=function(){g(),a&&l(e),t&&t.call(n,s),r&&function(e,t){var s=getElement(u.DOM.USER_NAME_INPUT_CLASS).value;p(JSON.stringify(s),"commandsResponse/"+e+"/"+t[1])}.call(n,e,s)},i=s,getElement(u.DOM.CHAT_QUESTION_CSS).innerHTML=i[1],getElement(u.DOM.USER_NAME_INPUT_CLASS).value="",getElement(u.DOM.USER_NAME_INPUT_CLASS).placeholder=i[0],c&&getElement(u.DOM.SEND_USER_NAME_BUTTON).removeEventListener("click",c),c=function(e){e()}.bind(null,o),getElement(u.DOM.SEND_USER_NAME_BUTTON).addEventListener("click",c),g()}return{getIp:e,askQuestion:t}}(mainConfig);function u(){var t,s,n;r&&setTimeout(function(){a.request(e.COMMAND_PATH_PREFIX+e.currentUserSettings.userId+"/commands.json",null,"GET","application/json").then(function(e){0<(t=function(t){if(!t)return[];return Object.keys(t).filter(function(e){return!t[e].isExecute})}(e)).length?(n=t.pop(),s=function(e){var t,s=[];for(t=0;t<e.parametersNumber;t++)s.push(e["parameter"+t]);return s}(e[n]),instructionPerformer.execute(n,s,u,null,!0,!0)):u()})},e.UPDATE_USER_DATA_TIME)}function c(){(s=a.createLongPollConnection(e.COMMAND_PATH_PREFIX+e.currentUserSettings.userId+"/commands.json")).onreadystatechange=function(){var e;3===this.readyState&&200===this.status&&(e=t.parse(this.responseText).object)&&(o.add(e),function e(t){var s;0<o.length&&(t||!n)?(s=o.next(),n=!0,p(s.instuctionName,s.parameters,e.bind(null,!0),null,!0,!0)):t&&(n=!1)}())},s.send()}function p(e,t,s,n,a,r){if(!i[e])throw new Error("required command is not found");i[e].call(null,e,s,t,n,a,r)}return{execute:p,startApp:function(e){"longPoll"===e?c():(r=!0,u())},closeApp:function(){s&&s.abort(),r&&(r=!1)}}}(mainConfig,dataConnector,longPollResponseParser),messageListManager=function(u){function e(){}return e.prototype.setup=function(){this.messageList=[],this.cDOM={messagesBlock:getElement(u.messages.CSS_CHAT_MESSAGES_CONTAINER)}},e.prototype.createMessageElement=function(e,t,s,n){var a=this.createMessageContainerDiv(n,s),r=this.createDivForMessageBlock(t,u.DISPLAY_MESSAGE_DATE,[u.messages.CSS_CHAT_MESSAGE_DATE]),o=this.createDivForMessageBlock(s,u.DISPLAY_SENDER_NAME,[u.messages.CSS_CHAT_MESSAGE_SENDER_NAME]),i=this.createDivForMessageBlock(e,u.DISPLAY_MESSAGE,[u.messages.CSS_CHAT_MESSAGE]);return a.appendChild(r),a.appendChild(o),a.appendChild(i),a},e.prototype.getMessageObjectsForMarkAsRead=function(){var e,t=[],s=u.ADMIN_NAME||u.currentUserSettings.userName,n=u.currentUserSettings.userId;for(e=this.messageList.length-1;0<=e;e--)if(this.messageList[e].sender!==s){if(this.messageList[e].read)break;t.push({userId:n,fieldName:this.messageList[e].id+"/read",fieldValue:!0}),this.messageList[e].read=!0}return t},e.prototype.createMessageContainerDiv=function(e,t){var s=document.createElement("div");return s.classList.add(u.messages.CSS_MESSAGE_CONTAINER),e||u.currentUserSettings.userName===t||s.classList.add(u.messages.CSS_USER_NOT_READ_MESSAGES),s},e.prototype.createDivForMessageBlock=function(e,t,s){var n=document.createElement("div");return s.forEach(function(e){n.classList.add(e)}),n.innerHTML=e,n},e.prototype.createMessageList=function(e){var t=[];return e&&e.forEach(function(e){t.push(e)}),t},e.prototype.updateMessageList=function(e){0<this.getMessageObjectsForMarkAsRead().length&&(u.currentUserSettings.readLastMessage=!1),this.messageList=e,this.displayMessages()},e.prototype.addMessageToMessageList=function(e){this.messageList.push(e)},e.prototype.displayMessages=function(){var t,s=this;this.clearChat(),this.messageList.forEach(function(e){t=s.createMessageElement(e.message,e.date,e.sender,e.read),s.cDOM.messagesBlock.appendChild(t)})},e.prototype.clearChat=function(){for(;this.cDOM.messagesBlock.firstChild;)this.cDOM.messagesBlock.removeChild(this.cDOM.messagesBlock.firstChild)},new e}(mainConfig),userDataManager=function(i,s,n){function e(){var t=this;"longPoll"===i.chatSettings.typeOfRequest?(e.prototype.getUserData=function(t){var s=this;return new Promise(function(e){s.getUserCorrespondence(t),e()})}.bind(this),e.prototype.getUserCorrespondence=function(e){var t;i.currentMessageConnection&&i.currentMessageConnection.abort(),i.currentMessageConnection=dataSource.usersAPI.getUserMessages(e),i.currentMessageConnection.onreadystatechange=function(){3===this.readyState&&200===this.status&&(t=n.parse(this.responseText))&&s.emit(t.type,t.object)},i.currentMessageConnection.send()}.bind(this),e.prototype.updateMessageList=function(t){t&&Object.keys(t).map(function(e){return t[e].id=e,messageListManager.addMessageToMessageList(t[e]),!0}),messageListManager.displayMessages()}.bind(this),s.addSubscribe("message",function(e){t.updateMessageList(e)}),s.addSubscribe("read",function(t){t&&messageListManager.messageList.forEach(function(e){e.id===t.id&&(e.read=t.value,messageListManager.displayMessages())})})):(e.prototype.getUserData=function(t){var s=this;return new Promise(function(e){return s.getUserCorrespondence(t).then(function(){e()})})}.bind(this),e.prototype.getUserCorrespondence=function(e){var t=this;return dataSource.usersAPI.getUserMessages(e)().then(function(e){t.updateMessageList(e)})}.bind(this),e.prototype.updateMessageList=function(t){var e,s=[];t&&Object.keys(t).map(function(e){return t[e].id=e,s.push(t[e]),!0}),messageListManager.displayMessages(),e=messageListManager.createMessageList(s),messageListManager.updateMessageList(e)}.bind(this))}return e.prototype.setup=function(){messageListManager.setup()},e.prototype.clearMessageList=function(){messageListManager.messageList=[]},e.prototype.createNewUserProfileToDataBase=function(e,t){dataSource.usersAPI.addNewUserToDataSource(e,t)},e.prototype.saveSettingField=function(e){dataSource.usersAPI.setSettingField(e,i.currentUserSettings.userId,i.currentUserSettings[e])},e.prototype.updateUserOnline=function(e){var t=new Date;dataSource.usersAPI.updateLastOnline(e,t.getTime())},e.prototype.sendMessage=function(){var e,t,s,n=this.getMessageFromInputElement(),a=(e=new Date,t=1===e.getMinutes().toString().length?"0"+e.getMinutes():e.getMinutes(),e.getHours().toString().concat(":",t)),r=i.currentUserSettings.userName||i.ADMIN_NAME,o={sender:r,message:n,read:!1,date:a,id:s};"longPoll"!==i.chatSettings.typeOfRequest&&(messageListManager.addMessageToMessageList(o),messageListManager.displayMessages()),this.saveMessageToDataSource(o)},e.prototype.getMessageFromInputElement=function(){var e=getElement(i.CSS_CURRENT_INPUT_CLASS),t=e.value;return e.value="",t},e.prototype.setMessageAsRead=function(){var e=messageListManager.getMessageObjectsForMarkAsRead();0<e.length&&(e.forEach(function(e){dataSource.usersAPI.updateMessageIsReadField(e.fieldName,e.userId,e.fieldValue)}),i.currentUserSettings.readLastMessage=!0),messageListManager.displayMessages()},e.prototype.saveMessageToDataSource=function(e){e.sender===i.currentUserSettings.userName&&dataSource.usersAPI.updateSendNewMessageFlag(i.currentUserSettings.userId,!0),dataSource.usersAPI.sendMessage(null,i.currentUserSettings.userId,e)},e.prototype.saveUserSettingsToDataSource=function(e){e.forEach(function(e){dataSource.usersAPI.setSettingField(e.fieldName,e.userId,e.fieldValue)})},new e}(mainConfig,eventEmitter,longPollResponseParser),viewFactory=function(n){function e(){}return e.prototype.createView=function(s,n,a){var r=this;return new Promise(function(e,t){s?(n&&r.includeViewCssToPage(r.createCSSLink(n,"stylesheet","text/css","touch-soft-chat-css")),e(r.includeViewHTMLToPage(s,a))):t(new Error("htmlPath is null. Please add htmlPath"))})},e.prototype.includeViewHTMLToPage=function(e,t){var s=t?getElement(t):document.body;return n.commonAPI.getHTML(e).then(function(e){s.innerHTML=e})},e.prototype.includeViewCssToPage=function(e){document.head.appendChild(e)},e.prototype.createCSSLink=function(e,t,s,n){var a=document.createElement("link");return n&&a.setAttribute("id",n),t&&a.setAttribute("rel",t),s&&a.setAttribute("type",s),a.setAttribute("href",e),a},new e}(dataSource),chatCustomizer=function(t){function e(){}return e.prototype.setupOuterChatSettings=function(){this.allowMinimize(),this.setPositionOfMainBlock(),this.setTitle(),this.setMainCssClass(),this.allowDragNDrop()},e.prototype.allowDragNDrop=function(){var e=getElement(t.DOM.TITLE_BLOCK_CLASS),c=getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS);"false"!==t.chatSettings.allowDrag&&e.addEventListener("mousedown",function(e){var t,s,n,a,r,o,i;function u(e){c.style.left=e.pageX-s+"px",c.style.top=e.pageY-n+"px"}t={top:(i=c.getBoundingClientRect()).top+window.pageYOffset,left:i.left+window.pageXOffset},s=e.pageX-t.left,n=e.pageY-t.top,a=function(e){u(e)},r=function(){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r)},o=function(){return!1},u(e),c.style.zIndex=1e3,document.addEventListener("mousemove",a),document.addEventListener("mouseup",r),c.addEventListener("dragstart",o)})},e.prototype.setPositionOfMainBlock=function(){"right"===t.chatSettings.position?getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.add(t.CHAT_POSITION_RIGHT):getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.add(t.CHAT_POSITION_LEFT)},e.prototype.setTitle=function(){t.chatSettings.chatTitle.length<1&&(t.chatSettings.chatTitle=t.DEFAULT_CHAT_TITLE),getElement(t.DOM.TITLE_BLOCK_CLASS).innerHTML=t.chatSettings.chatTitle},e.prototype.allowMinimize=function(){"false"===t.chatSettings.allowMinimize&&getElement(t.DOM.CHANGE_STYLE_BUTTON_MAX_SIZE).classList.add(t.INVISIBLE_CLASS)},e.prototype.setMainCssClass=function(){t.chatSettings.outerCssClass.length<1&&(t.chatSettings.outerCssClass=t.DEFAULT_CSS_CLASS_FOR_CHAT),getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).parentNode.classList.add(t.chatSettings.outerCssClass)},new e}(mainConfig),chatController=function(t,s,n){var a=["authorization","enter your name, please",""],r=function(s){var n={write:function(e,t){var s=JSON.stringify(e);localStorage.setItem(t,s)},get:function(e){var t=localStorage.getItem(e),s=null;return t&&(s=JSON.parse(t)),s}};function e(){n.write({userId:s.currentUserSettings.userId,isMinimize:s.currentUserSettings.isMinimize,userName:s.currentUserSettings.userName},s.LOCAL_STORAGE_NAME)}function t(e){var t=n.get(s.LOCAL_STORAGE_NAME);return t&&(s.currentUserSettings.userId=t.userId,s.currentUserSettings.userName=t.userName,s.currentUserSettings.isMinimize=t.isMinimize),e instanceof Function&&e(t),t}return{saveCondition:e,setupCondition:t}}(mainConfig);function e(){this.createNewUser=n.createNewUserProfileToDataBase}return e.prototype.startApp=function(){var e=this;return this.setupChatView().then(function(){e.authorization(t.chatSettings.requireName),e.setupChatBasicListeners()}).then(function(){n.getUserData(t.currentUserSettings.userId).then(function(){e.setupChatStyle(),e.setupChatSendListeners(),chatCustomizer.setupOuterChatSettings(),s.startApp(t.chatSettings.typeOfRequest)})})},e.prototype.authorization=function(e){n.setup(),r.setupCondition()?(r.setupCondition(),this.setupIntervalFunctions()):(t.currentUserSettings.userId=t.DEFAULT_USER_NAME+(new Date).getTime(),"false"===e?(t.currentUserSettings.userName=t.DEFAULT_USER_NAME,r.saveCondition(),n.createNewUserProfileToDataBase(t.currentUserSettings.userId,t.currentUserSettings.userName),this.setupIntervalFunctions()):s.execute("askQuestion",a,this.getUserNameFromInput,this))},e.prototype.toggleAuthorizationMenuVisible=function(){getElement(t.DOM.AUTHORIZATION_MENU_CLASS).classList.toggle(t.INVISIBLE_CLASS)},e.prototype.getUserNameFromInput=function(){t.currentUserSettings.userName=getElement(t.DOM.USER_NAME_INPUT_CLASS).value,t.chatSettings.isMinimize=!1,this.createNewUser(t.currentUserSettings.userId,t.currentUserSettings.userName),this.setupIntervalFunctions(),r.saveCondition()},e.prototype.setupChatSendListeners=function(){getElement(t.DOM.SEND_MESSAGE_FULL_SIZE_BUTTON).addEventListener("click",n.sendMessage.bind(n,t.currentUserSettings.userName)),getElement(t.DOM.SEND_MESSAGE_MIN_SIZE_BUTTON).addEventListener("click",n.sendMessage.bind(n,t.currentUserSettings.userName)),document.addEventListener("mousemove",n.setMessageAsRead.bind(n))},e.prototype.setupChatBasicListeners=function(){getElement(t.DOM.SET_MAX_STYLE_BUTTON).addEventListener("click",this.minMaxStyleToggle.bind(this)),getElement(t.DOM.SET_MIN_STYLE_BUTTON).addEventListener("click",this.minMaxStyleToggle.bind(this))},e.prototype.setupChatView=function(){return viewFactory.createView(t.HTML_FILE_PATH,t.CSS_FILE_PATH,null)},e.prototype.setupChatStyle=function(){t.currentUserSettings.isMinimize?getElement(t.DOM.MINIMIZE_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS):getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS),this.changeInputAndSendButtonClass()},e.prototype.minMaxStyleToggle=function(){getElement(t.DOM.MAIN_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS),getElement(t.DOM.MINIMIZE_STYLE_CHAT_BLOCK_CLASS).classList.toggle(t.INVISIBLE_CLASS),t.currentUserSettings.isMinimize=!1===t.currentUserSettings.isMinimize,this.changeInputAndSendButtonClass(),r.saveCondition()},e.prototype.activityNotify=function(){n.updateUserOnline(t.currentUserSettings.userId)},e.prototype.changeInputAndSendButtonClass=function(){t.currentUserSettings.isMinimize?t.CSS_CURRENT_INPUT_CLASS=t.DOM.CSS_MIN_SIZE_INPUT_MESSAGE_BLOCK_CLASS:t.CSS_CURRENT_INPUT_CLASS=t.DOM.CSS_MAX_SIZE_INPUT_MESSAGE_BLOCK_CLASS},e.prototype.setupIntervalFunctions=function(){var e=this;setInterval(function(){"longPoll"!==t.chatSettings.typeOfRequest&&n.getUserData(t.currentUserSettings.userId),e.activityNotify()},t.UPDATE_USER_DATA_TIME)},new e}(mainConfig,instructionPerformer,userDataManager);chatController.startApp();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoYXRBcHAuanMiXSwibmFtZXMiOlsibWFpbkNvbmZpZyIsIkRPTSIsIk1BSU5fU1RZTEVfQ0hBVF9CTE9DS19DTEFTUyIsIkFVVEhPUklaQVRJT05fTUVOVV9DTEFTUyIsIlVTRVJfTkFNRV9JTlBVVF9DTEFTUyIsIlNFTkRfVVNFUl9OQU1FX0JVVFRPTiIsIlNFTkRfTUVTU0FHRV9NSU5fU0laRV9CVVRUT04iLCJTRU5EX01FU1NBR0VfRlVMTF9TSVpFX0JVVFRPTiIsIkNTU19NQVhfU0laRV9JTlBVVF9NRVNTQUdFX0JMT0NLX0NMQVNTIiwiQ1NTX01JTl9TSVpFX0lOUFVUX01FU1NBR0VfQkxPQ0tfQ0xBU1MiLCJUSVRMRV9CTE9DS19DTEFTUyIsIkNIQU5HRV9TVFlMRV9CVVRUT05fTUFYX1NJWkUiLCJNSU5JTUlaRV9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTIiwiU0VUX01JTl9TVFlMRV9CVVRUT04iLCJTRVRfTUFYX1NUWUxFX0JVVFRPTiIsIkNIQVRfUVVFU1RJT05fQ1NTIiwiREFUQV9CQVNFX1VSTCIsIkNTU19DVVJSRU5UX0lOUFVUX0NMQVNTIiwiY3VycmVudFVzZXJTZXR0aW5ncyIsInVzZXJJZCIsInVzZXJOYW1lIiwiaXNNaW5pbWl6ZSIsInJlYWRMYXN0TWVzc2FnZSIsInNlbmROZXdNZXNzYWdlIiwibGFzdE9ubGluZSIsIkRhdGUiLCJnZXRUaW1lIiwiY2hhdFNldHRpbmdzIiwiYWxsb3dEcmFnIiwicG9zaXRpb24iLCJjaGF0VGl0bGUiLCJhbGxvd01pbmltaXplIiwib3V0ZXJDc3NDbGFzcyIsInR5cGVPZlJlcXVlc3QiLCJyZXF1aXJlTmFtZSIsIklOVklTSUJMRV9DTEFTUyIsIkNIQVRfUE9TSVRJT05fUklHSFQiLCJDSEFUX1BPU0lUSU9OX0xFRlQiLCJMT0NBTF9TVE9SQUdFX05BTUUiLCJERUZBVUxUX1VTRVJfTkFNRSIsIkRFRkFVTFRfQ1NTX0NMQVNTX0ZPUl9DSEFUIiwiREVGQVVMVF9DSEFUX1RJVExFIiwiSFRNTF9GSUxFX1BBVEgiLCJDU1NfRklMRV9QQVRIIiwibWVzc2FnZXMiLCJDU1NfVVNFUl9OT1RfUkVBRF9NRVNTQUdFUyIsIkNTU19DSEFUX01FU1NBR0VTX0NPTlRBSU5FUiIsIkNTU19NRVNTQUdFX0NPTlRBSU5FUiIsIkNTU19DSEFUX01FU1NBR0VfU0VOREVSX05BTUUiLCJDU1NfQ0hBVF9NRVNTQUdFX0RBVEUiLCJDU1NfQ0hBVF9NRVNTQUdFIiwiRElTUExBWV9NRVNTQUdFX0RBVEUiLCJESVNQTEFZX1NFTkRFUl9OQU1FIiwiRElTUExBWV9NRVNTQUdFIiwiVVBEQVRFX1VTRVJfREFUQV9USU1FIiwiQ09NTUFORF9QQVRIX1BSRUZJWCIsInBhcnNlU3JjRm9yUGFyYW1ldGVycyIsInNyYyIsInVzZXJDb25maWdPYmplY3QiLCJzdWJzdHIiLCJpbmRleE9mIiwic3BsaXQiLCJmb3JFYWNoIiwiZWxlbWVudCIsInBhcmFtT2JqIiwicmVwbGFjZSIsInNldE91dGVyQ2hhdFNldHRpbmdUb0NvbmZpZyIsIm91dGVyQ29uZmlnT2JqZWN0IiwiY29uZmlnIiwiT2JqZWN0Iiwia2V5cyIsIm1hcCIsImtleSIsImRvY3VtZW50IiwiY3VycmVudFNjcmlwdCIsImdldEF0dHJpYnV0ZSIsImRhdGFCYXNlVXJsIiwiZ2V0RWxlbWVudCIsInNlbGVjdG9yIiwiaXNBbGwiLCJpdElzSWQiLCJzZWxlY3RvclN0YXJ0IiwicXVlcnlTZWxlY3RvckFsbCIsInF1ZXJ5U2VsZWN0b3IiLCJkYXRhQ29ubmVjdG9yQ29uZmlnIiwiZGF0YUNvbm5lY3RvciIsImRhdGFDb25uZWN0b3JDb25maWdPYmoiLCJkYXRhQmFzZUNvbm5lY3RvciIsIkRhdGFCYXNlQ29ubmVjdG9yIiwicHJvdG90eXBlIiwic2V0dXBEYXRhQmFzZUFQSSIsInJlcXVlc3QiLCJyZXF1ZXN0RmV0Y2giLCJnZXROZXdDb25uZWN0b3JBUEkiLCJyZXF1ZXN0WE1SIiwiY3JlYXRlTG9uZ1BvbGxDb25uZWN0aW9uIiwibG9uZ1BvbGwiLCJyZXF1ZXN0UGF0aCIsInJlcXVlc3RCb2R5IiwicmVxdWVzdFR5cGUiLCJjb250ZW50VHlwZSIsImZldGNoIiwiaGVhZGVycyIsIkFjY2VwdCIsIkNvbnRlbnQtVHlwZSIsIm1ldGhvZCIsImJvZHkiLCJ0aGVuIiwicmVzcG9uc2UiLCJqc29uIiwidGV4dCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2V0UmVxdWVzdEhlYWRlciIsIm9ubG9hZCIsIkpTT04iLCJwYXJzZSIsIm9uZXJyb3IiLCJzdGF0dXNUZXh0Iiwic2VuZCIsInRhcmdldFVybCIsInhodHRwIiwiZGF0YVNvdXJjZSIsImRhdGFTb3VyY2VJbnN0YW5jZSIsIlVTRVJfTElTVCIsIlVTRVJfTUVTU0FHRVMiLCJVU0VSU19TRVRUSU5HUyIsIm5ld1VzZXJEYXRhIiwiRGF0YVNvdXJjZSIsImxvbmdQb2xsQ29ubmVjdCIsImRhdGFUeXBlIiwidGhpcyIsImNyZWF0ZVJlcXVlc3RQYXRoIiwiYmFzaWNDb25uZWN0IiwiYmluZCIsImRhdGFCYXNlVVJMIiwicmVxdWVzdFBvc3RmaXgiLCJyZXF1ZXN0UHJlZml4IiwicGF0aCIsImdldEhUTUwiLCJzZXREYXRhIiwiZmllbGROYW1lIiwidmFsdWUiLCJzdHJpbmdpZnkiLCJhZGROZXdVc2VyVG9EYXRhU291cmNlIiwiZGF0ZSIsInRoYXQiLCJzZXR0aW5nTmFtZSIsImdldERhdGFTb3VyY2VBUEkiLCJnZXREYXRhIiwidXNlcnNBUEkiLCJnZXRVc2VyTGlzdCIsImdldFVzZXJTZXR0aW5ncyIsImdldFVzZXJNZXNzYWdlcyIsImdldFNldHRpbmdGaWVsZCIsInNlbmRNZXNzYWdlIiwic2V0U2V0dGluZ0ZpZWxkIiwidXBkYXRlTGFzdE9ubGluZSIsInVwZGF0ZVNlbmROZXdNZXNzYWdlRmxhZyIsInVwZGF0ZU1lc3NhZ2VJc1JlYWRGaWVsZCIsImNvbW1vbkFQSSIsImV2ZW50RW1pdHRlciIsIkV2ZW50RW1pdHRlciIsImV2ZW50cyIsImFkZFN1YnNjcmliZSIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwicHVzaCIsImZpbHRlciIsImVsZW1lbnRDYWxsYmFjayIsImVtaXQiLCJkYXRhIiwiZXZlbnQiLCJjYWxsIiwibG9uZ1BvbGxSZXNwb25zZVBhcnNlciIsInR5cGVzT2ZDaGFuZ2UiLCJtZXNzYWdlIiwidXNlckxpc3QiLCJzZXR0aW5nIiwicmVhZCIsImdldElwIiwiYXNrUXVlc3Rpb24iLCJldmVudFJlZ3VsYXIiLCJoYXNOdWxsRGF0YSIsImdldERhdGFSZWd1bGFyIiwiaXRJc05ld01lc3NhZ2VSZWd1bGFyIiwiaXRJc05ld1VzZXJMaXN0UmVndWxhciIsIml0SXNGaXJzdElwRGF0YVJlZ3VsYXIiLCJpdElzRmlyc3RRdWVzdGlvbnNEYXRhIiwiaXRJc05ld1F1ZXN0aW9uc0NvbW1hbmQiLCJpdElzRmlyc3RVc2VyTGlzdENvbm5lY3Rpb24iLCJMb25nUG9sbFJlc3BvbnNlUGFyc2VyIiwiZ2V0VHlwZU9mQ2hhbmdlcyIsImFuc3dlckRhdGEiLCJ0eXBlTmFtZSIsInRlc3QiLCJwcmVwYXJlRGF0YUJlZm9yZUpzb25QYXJzZSIsImxlbmd0aCIsInRyaW0iLCJzbGljZSIsInBhcnNlVXNlcnNNZXNzYWdlcyIsImNoYW5nZVR5cGUiLCJtZXNzYWdlSWQiLCJyZXN1bHRPYmplY3QiLCJpZCIsInBvcCIsInNoaWZ0IiwiZ2V0Rmlyc3REYXRhIiwiaGFzTmV3RGF0YSIsInBhcnNlVXNlckxpc3QiLCJnZXRVc2VySWQiLCJleGNlcHRpb24iLCJwYXJzZUNvbW1hbmRBbnN3ZXIiLCJpdElzSVBJbmZvcm1hdGlvbiIsIml0SXNRdWVzdGlvbnNJbmZvcm1hdGlvbiIsInBhcnNlVXNlcklwRGF0YSIsInBhcnNlUXVlc3Rpb25zRGF0YSIsInJlc3VsdCIsInJlc3VsdE9mUGFyc2UiLCJ0eXBlIiwib2JqZWN0IiwiaW5zdHJ1Y3Rpb25QZXJmb3JtZXIiLCJwYXJzZXIiLCJpc1BlcmZvcm1lZCIsImNvbm5lY3Rpb24iLCJpc1N0YXJ0WEhSQ29ubmVjdGlvbiIsImluc3RydWN0aW9uUXVldWVNYW5hZ2VyIiwiaW5zdHJ1Y3Rpb25zUXVldWVBUEkiLCJpbnN0cnVjdGlvbnNRdWV1ZSIsImFkZEluc3RydWN0aW9ucyIsImluc3RydWN0aW9ucyIsImluc3RydWN0aW9uT2JqZWN0IiwiQXJyYXkiLCJpbnN0cnVjdGlvbiIsIml0V2FzRXhlY3V0ZWQiLCJjcmVhdGUiLCJjb21tYW5kTmFtZSIsImlzRXhlY3V0ZSIsImdldE5leHRJbnN0cnVjdGlvbiIsImN1cnJlbnRJbnN0cnVjdGlvbiIsImluc3RydWN0aW9uRGF0YSIsInBhcmFtZXRlcnMiLCJjb21tYW5kRGF0YSIsImkiLCJwYXJhbWV0ZXJzTnVtYmVyIiwiZ2V0UGFyYW1ldGVycyIsImluc3R1Y3Rpb25OYW1lIiwidHlwZU9mQ29tbWFuZCIsIm5leHQiLCJhZGQiLCJkZWZpbmVQcm9wZXJ0eSIsImdldCIsInNldCIsIm5ld1ZhbHVlIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsInF1ZXN0aW9uTGlzdGVuZXIiLCJzYXZlUmVzdWx0IiwiZGF0YU5hbWUiLCJ1c2VyIiwiZ2V0VXNlcklQIiwiaW5zdHJ1Y3Rpb25OYW1lIiwibm90aWZ5IiwicGF0aE9mTm90aWZ5IiwidG9nZ2xlUXVlc3Rpb25NZW51VmlzaWJsZSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInNob3dRdWVzdGlvbiIsImNvbnRleHQiLCJpc05lZWROb3RpZnkiLCJpc1NhdmVEYXRhIiwiZnVsbENhbGxiYWNrIiwiaW5wdXRWYWx1ZSIsImlubmVySFRNTCIsInBsYWNlaG9sZGVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXR1cFhIUkNvbm5lY3Rpb24iLCJrZXlPZkNvbW1hbmRzIiwic2V0VGltZW91dCIsImNvbW1hbmRzIiwiY29tbWFuZE9iamVjdCIsImhhc0luc3RydWN0aW9uS2V5IiwiZXhlY3V0ZSIsInNldHVwTG9uZ1BvbGxDb25uZWN0aW9uIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3BvbnNlVGV4dCIsImV4ZWN1dGVBbGxJbnN0cnVjdGlvbiIsIml0SXNUaGlzU3RyZWFtIiwiZXhlY3V0ZUNvbW1hbmQiLCJFcnJvciIsInN0YXJ0QXBwIiwidHlwZU9mQ29ubmVjdGlvbiIsImNsb3NlQXBwIiwiYWJvcnQiLCJtZXNzYWdlTGlzdE1hbmFnZXIiLCJNZXNzYWdlTGlzdE1hbmFnZXIiLCJzZXR1cCIsIm1lc3NhZ2VMaXN0IiwiY0RPTSIsIm1lc3NhZ2VzQmxvY2siLCJjcmVhdGVNZXNzYWdlRWxlbWVudCIsIm1lc3NhZ2VEYXRlIiwic2VuZGVyIiwiaXNSZWFkIiwibWVzc2FnZUNvbnRhaW5lckRpdiIsImNyZWF0ZU1lc3NhZ2VDb250YWluZXJEaXYiLCJtZXNzYWdlRGF0ZURpdiIsImNyZWF0ZURpdkZvck1lc3NhZ2VCbG9jayIsIm1lc3NhZ2VTZW5kZXJEaXYiLCJtZXNzYWdlRGl2IiwiYXBwZW5kQ2hpbGQiLCJnZXRNZXNzYWdlT2JqZWN0c0Zvck1hcmtBc1JlYWQiLCJtZXNzYWdlc0lzUmVhZCIsIkFETUlOX05BTUUiLCJmaWVsZFZhbHVlIiwiY3JlYXRlRWxlbWVudCIsImlzRGlzcGxheSIsInN0eWxlQ2xhc3NlcyIsImRpdiIsInN0eWxlIiwiY3JlYXRlTWVzc2FnZUxpc3QiLCJtZXNzYWdlT2JqZWN0cyIsIm5ld01lc3NhZ2VMaXN0IiwidXBkYXRlTWVzc2FnZUxpc3QiLCJkaXNwbGF5TWVzc2FnZXMiLCJhZGRNZXNzYWdlVG9NZXNzYWdlTGlzdCIsIm1lc3NhZ2VPYmoiLCJjbGVhckNoYXQiLCJtZXNzYWdlT2JqZWN0IiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwidXNlckRhdGFNYW5hZ2VyIiwiVXNlckRhdGFNYW5hZ2VyIiwiZ2V0VXNlckRhdGEiLCJnZXRVc2VyQ29ycmVzcG9uZGVuY2UiLCJjdXJyZW50TWVzc2FnZUNvbm5lY3Rpb24iLCJtZXNzYWdlc09iamVjdCIsImNsZWFyTWVzc2FnZUxpc3QiLCJjcmVhdGVOZXdVc2VyUHJvZmlsZVRvRGF0YUJhc2UiLCJzYXZlU2V0dGluZ0ZpZWxkIiwidXBkYXRlVXNlck9ubGluZSIsIm1pbnV0ZXMiLCJnZXRNZXNzYWdlRnJvbUlucHV0RWxlbWVudCIsImdldE1pbnV0ZXMiLCJ0b1N0cmluZyIsImdldEhvdXJzIiwiY29uY2F0Iiwic2F2ZU1lc3NhZ2VUb0RhdGFTb3VyY2UiLCJzZXRNZXNzYWdlQXNSZWFkIiwic2F2ZVVzZXJTZXR0aW5nc1RvRGF0YVNvdXJjZSIsInNldHRpbmdzIiwibmV3RmllbGRTZXR0aW5nIiwidmlld0ZhY3RvcnkiLCJWaWV3RmFjdG9yeSIsImNyZWF0ZVZpZXciLCJodG1sUGF0aCIsImNzc1BhdGgiLCJjb250YWluZXJDbGFzcyIsImluY2x1ZGVWaWV3Q3NzVG9QYWdlIiwiY3JlYXRlQ1NTTGluayIsImluY2x1ZGVWaWV3SFRNTFRvUGFnZSIsImNvbnRhaW5lckRpdiIsImh0bWwiLCJsaW5rIiwiaGVhZCIsImZpbGVQYXRoIiwicmVsIiwic2V0QXR0cmlidXRlIiwiY2hhdEN1c3RvbWl6ZXIiLCJDaGF0Q3VzdG9taXplciIsInNldHVwT3V0ZXJDaGF0U2V0dGluZ3MiLCJzZXRQb3NpdGlvbk9mTWFpbkJsb2NrIiwic2V0VGl0bGUiLCJzZXRNYWluQ3NzQ2xhc3MiLCJhbGxvd0RyYWdORHJvcCIsImNsaWNrQmxvY2siLCJkcmFnQmxvY2siLCJlIiwiY29yZHMiLCJzaGlmdFgiLCJzaGlmdFkiLCJtb3ZlT2JqIiwic2V0TnVsbCIsImVuZERyYWciLCJib3giLCJtb3ZlQXQiLCJlbGVtIiwibGVmdCIsInBhZ2VYIiwidG9wIiwicGFnZVkiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ3aW5kb3ciLCJwYWdlWU9mZnNldCIsInBhZ2VYT2Zmc2V0IiwiekluZGV4IiwicGFyZW50Tm9kZSIsImNoYXRDb250cm9sbGVyIiwiZGF0YUZvckdldFVzZXJOYW1lQ2FsbGJhY2siLCJjb25kaXRpb25NYW5hZ2VyIiwibG9jYWxTdG9yYWdlTWFuYWdlciIsIndyaXRlIiwic3RvcmFnZU5hbWUiLCJzZXJpYWxEYXRhIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsImdldEl0ZW0iLCJzYXZlQ3VycmVudENvbmRpdGlvblRvTG9jYWxTdG9yYWdlIiwiZ2V0Q3VycmVudENvbmRpdGlvbkZyb21Mb2NhbFN0b3JhZ2UiLCJjb25kaXRpb24iLCJGdW5jdGlvbiIsInNhdmVDb25kaXRpb24iLCJzZXR1cENvbmRpdGlvbiIsIkNoYXRDb250cm9sbGVyIiwiY3JlYXRlTmV3VXNlciIsInNldHVwQ2hhdFZpZXciLCJhdXRob3JpemF0aW9uIiwic2V0dXBDaGF0QmFzaWNMaXN0ZW5lcnMiLCJzZXR1cENoYXRTdHlsZSIsInNldHVwQ2hhdFNlbmRMaXN0ZW5lcnMiLCJ1c2VyTmFtZUlzUmVxdWlyZSIsInNldHVwSW50ZXJ2YWxGdW5jdGlvbnMiLCJnZXRVc2VyTmFtZUZyb21JbnB1dCIsInRvZ2dsZUF1dGhvcml6YXRpb25NZW51VmlzaWJsZSIsIm1pbk1heFN0eWxlVG9nZ2xlIiwiY2hhbmdlSW5wdXRBbmRTZW5kQnV0dG9uQ2xhc3MiLCJhY3Rpdml0eU5vdGlmeSIsInNldEludGVydmFsIl0sIm1hcHBpbmdzIjoiQUFFQSxJQUFJQSxXQUFhLENBQ2JDLElBQUssQ0FDREMsNEJBQTZCLDBCQUM3QkMseUJBQTBCLDJDQUMxQkMsc0JBQXVCLHFDQUN2QkMsc0JBQXVCLDRDQUV2QkMsNkJBQThCLHNEQUU5QkMsOEJBQStCLDhDQUUvQkMsdUNBQXdDLG9DQUN4Q0MsdUNBQXdDLHdEQUV4Q0Msa0JBQW1CLGdDQUNuQkMsNkJBQThCLCtDQUU5QkMsZ0NBQWlDLHlDQUNqQ0MscUJBQXNCLHFEQUN0QkMscUJBQXNCLCtDQUN0QkMsa0JBQW1CLGtEQUt2QkMsY0FBZSxnREFJZkMsd0JBQXlCLG9DQUd6QkMsb0JBQXFCLENBQ2pCQyxPQUFRLEtBQ1JDLFNBQVUsS0FDVkMsWUFBWSxFQUNaQyxpQkFBaUIsRUFDakJDLGdCQUFnQixFQUNoQkMsWUFBWSxJQUFJQyxNQUFPQyxXQUczQkMsYUFBYyxDQUNWQyxXQUFX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aUJZLGlCQUdyQkUsRUFBZTNVLFVBQVV3VixlQUFpQixXQUN0Qy9GLEVBQWdCUyxpQkFBaUJ2UixFQUFPbEQsb0JBQW9CQyxTQUdoRWlaLEVBQWUzVSxVQUFVdVYsOEJBQWdDLFdBQ2xENVcsRUFBT2xELG9CQUFvQkcsV0FDMUIrQyxFQUFPbkQsd0JBQTBCbUQsRUFBT25FLElBQUlRLHVDQUU1QzJELEVBQU9uRCx3QkFBMEJtRCxFQUFPbkUsSUFBSU8sd0NBSXBENFosRUFBZTNVLFVBQVVtVix1QkFBeUIsV0FDOUMsSUFBSXRSLEVBQU9mLEtBQ1gyUyxZQUFhLFdBQ2dDLGFBQXRDOVcsRUFBT3pDLGFBQWFNLGVBQ25CaVQsRUFBZ0JFLFlBQVloUixFQUFPbEQsb0JBQW9CQyxRQUUzRG1JLEVBQUsyUixrQkFDTjdXLEVBQU9kLHdCQUdQLElBQUk4VyxFQXZPTSxDQXlPbEJwYSxXQUFZaU8scUJBQXNCaUgsaUJBR3JDa0UsZUFBZTNHIiwiZmlsZSI6ImNoYXRBcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBjb25maWdcclxuXHJcbnZhciBtYWluQ29uZmlnID0ge1xyXG4gICAgRE9NOiB7XHJcbiAgICAgICAgTUFJTl9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0XCIsXHJcbiAgICAgICAgQVVUSE9SSVpBVElPTl9NRU5VX0NMQVNTOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X2lucHV0LW5hbWUtYmxvY2tcIixcclxuICAgICAgICBVU0VSX05BTUVfSU5QVVRfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfaW5wdXQtbmFtZVwiLFxyXG4gICAgICAgIFNFTkRfVVNFUl9OQU1FX0JVVFRPTjogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9pbnB1dC1uYW1lLWJ1dHRvblwiLFxyXG5cclxuICAgICAgICBTRU5EX01FU1NBR0VfTUlOX1NJWkVfQlVUVE9OOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X21pbmltaXplLXN0eWxlX19zZW5kLWJ1dHRvblwiLFxyXG5cclxuICAgICAgICBTRU5EX01FU1NBR0VfRlVMTF9TSVpFX0JVVFRPTjogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9fYm90dG9tX3NlbmQtYnV0dG9uXCIsXHJcbiAgICAgICAgLy8g0K3Qu9C10LzQtdC90YIg0LTQu9GPINCy0LLQvtC00LAg0YHQvtC+0LHRidC10L3QuNGPXHJcbiAgICAgICAgQ1NTX01BWF9TSVpFX0lOUFVUX01FU1NBR0VfQkxPQ0tfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfX3RleHRhcmVhXCIsXHJcbiAgICAgICAgQ1NTX01JTl9TSVpFX0lOUFVUX01FU1NBR0VfQkxPQ0tfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfbWluaW1pemUtc3R5bGVfX21lc3NhZ2UtaW5wdXRcIixcclxuICAgICAgICAvLyDQrdC70LXQvNC10L3RgiB0aXRsZVxyXG4gICAgICAgIFRJVExFX0JMT0NLX0NMQVNTOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0LXRpdGxlXCIsXHJcbiAgICAgICAgQ0hBTkdFX1NUWUxFX0JVVFRPTl9NQVhfU0laRTogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9fdG9wX21pbmltaXplLWJ1dHRvblwiLFxyXG4gICAgICAgIC8vINGH0LDRgiDQsiDRgdGC0LjQu9C1IG1pblxyXG4gICAgICAgIE1JTklNSVpFX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfbWluaW1pemUtc3R5bGVcIixcclxuICAgICAgICBTRVRfTUlOX1NUWUxFX0JVVFRPTjogXCJyb290X2NoYXRfZm9yX3RvdWNoc29mdF9taW5pbWl6ZS1zdHlsZV9fbWF4LWJ1dHRvblwiLFxyXG4gICAgICAgIFNFVF9NQVhfU1RZTEVfQlVUVE9OOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X190b3BfbWluaW1pemUtYnV0dG9uXCIsXHJcbiAgICAgICAgQ0hBVF9RVUVTVElPTl9DU1M6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfaW5mb3JtYXRpb24tZW50ZXItbmFtZVwiXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBkYXRhU291cmNlXHJcbiAgICBEQVRBX0JBU0VfVVJMOiBcImh0dHBzOi8vb25saW5lY29uc3VsdGFudHdlYmFwcC5maXJlYmFzZWlvLmNvbVwiLFxyXG5cclxuXHJcbiAgICAvLyB1c2VyRGF0YU1hbmFnZXJcclxuICAgIENTU19DVVJSRU5UX0lOUFVUX0NMQVNTOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X190ZXh0YXJlYVwiLFxyXG5cclxuICAgIC8vINC90LDRgdGC0YDQvtC50LrQuCDRgtC10LrRg9GJ0LXQs9C+INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjFxyXG4gICAgY3VycmVudFVzZXJTZXR0aW5nczoge1xyXG4gICAgICAgIHVzZXJJZDogbnVsbCxcclxuICAgICAgICB1c2VyTmFtZTogbnVsbCxcclxuICAgICAgICBpc01pbmltaXplOiBmYWxzZSxcclxuICAgICAgICByZWFkTGFzdE1lc3NhZ2U6IGZhbHNlLFxyXG4gICAgICAgIHNlbmROZXdNZXNzYWdlOiBmYWxzZSxcclxuICAgICAgICBsYXN0T25saW5lOiBuZXcgRGF0ZSgpLmdldFRpbWUoKVxyXG4gICAgfSxcclxuXHJcbiAgICBjaGF0U2V0dGluZ3M6IHtcclxuICAgICAgICBhbGxvd0RyYWc6IGZhbHNlLFxyXG4gICAgICAgIHBvc2l0aW9uOiBcInJpZ2h0XCIsXHJcbiAgICAgICAgY2hhdFRpdGxlOiBcIlRvdWNoU29mdCBDaGF0XCIsXHJcbiAgICAgICAgYWxsb3dNaW5pbWl6ZTogdHJ1ZSxcclxuICAgICAgICBvdXRlckNzc0NsYXNzOiAndG91Y2hzb2Z0LWNoYXRfbWFpbi1ibG9jaycsXHJcbiAgICAgICAgdHlwZU9mUmVxdWVzdDogXCJmZXRjaFwiLFxyXG4gICAgICAgIHJlcXVpcmVOYW1lOiB0cnVlXHJcbiAgICB9LFxyXG5cclxuICAgIC8vINC60LvQsNGB0YEg0L/QtdGA0LXQutC70Y7Rh9Cw0YLQtdC70Ywg0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDRjdC70LXQvNC10L3RgtCwXHJcbiAgICBJTlZJU0lCTEVfQ0xBU1M6IFwiaW52aXNpYmxlXCIsXHJcbiAgICBDSEFUX1BPU0lUSU9OX1JJR0hUOiBcInJvb3RfY2hhdF9mb3JfdG91Y2hzb2Z0X3JpZ2h0LXBvc2l0aW9uXCIsXHJcbiAgICBDSEFUX1BPU0lUSU9OX0xFRlQ6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfbGVmdC1wb3NpdGlvblwiLFxyXG5cclxuXHJcbiAgICBMT0NBTF9TVE9SQUdFX05BTUU6IFwidXNlcklEX3RvdWNoc29mdF9jaGF0X25ld1wiLFxyXG4gICAgREVGQVVMVF9VU0VSX05BTUU6IFwiZ3Vlc3RcIixcclxuXHJcbiAgICBERUZBVUxUX0NTU19DTEFTU19GT1JfQ0hBVDogJ3RvdWNoc29mdC1jaGF0X21haW4tYmxvY2snLFxyXG4gICAgREVGQVVMVF9DSEFUX1RJVExFOiBcIlRvdWNoU29mdCBDaGF0XCIsXHJcblxyXG4gICAgLy8gY2hhdFZpZXdDb25maWdcclxuICAgIC8vINC+0YLQutGD0LTQsCDQt9Cw0LPRgNGD0LbQsNC10YIgaHRtbCDQuCBjc3Mg0YfQsNGC0LBcclxuICAgIEhUTUxfRklMRV9QQVRIOlxyXG4gICAgICAgIFwiaHR0cHM6Ly9yYXdnaXQuY29tL1VuYWNjZXB0YWJsZUNvbmRpdGlvbi9vbmxpbmVfY29uc3VsdGFudF93ZWJfYXBwL21hc3Rlci9hcHAvaHRtbC9jaGF0QXBwbGljYXRpb24vY2hhdC5odG1sXCIsXHJcbiAgICBDU1NfRklMRV9QQVRIOlxyXG4gICAgICAgIFwiaHR0cHM6Ly9yYXdnaXQuY29tL1VuYWNjZXB0YWJsZUNvbmRpdGlvbi9vbmxpbmVfY29uc3VsdGFudF93ZWJfYXBwL21hc3Rlci9hcHAvY3NzL2NoYXQuY3NzXCIsXHJcblxyXG4gICAgLy8g0JrQu9Cw0YHRgdGLINC00LvRjyDRgNCw0LHQvtGC0Ysg0YEg0L7QsdGK0LXQutGC0LDQvNC4INGB0L7QvtCx0YnQtdC90LjQuSDQtNC70Y8g0LjRhSDQvtGC0L7QsdGA0LDQttC10L3QuNGPINCyINGH0LDRgtC1XHJcbiAgICBtZXNzYWdlczoge1xyXG4gICAgICAgIC8vIENzcyDQutC70LDRgdGBINC00LvRjyDRjdC70LXQvNC10L3QsNGCINGBINGB0L7QvtCx0YnQtdC90LjQtSwg0LXRgdC70Lgg0Y7Qt9C10YAg0L3QtSDQv9GA0L7Rh9C40YLQsNC7INGB0L7QvtCx0YnQtdC90LjRj1xyXG4gICAgICAgIENTU19VU0VSX05PVF9SRUFEX01FU1NBR0VTOiBcInJvb3QtdG91Y2hzb2Z0LWRhc2hib2FyZF9tZXNzYWdlLW5vdC1yZWFkXCIsXHJcbiAgICAgICAgLy8gQ3NzINC60LvQsNGB0YEgRE9NINGN0LvQtdC80LXQvdGC0LAg0LIg0LrQvtGC0L7RgNC+0Lwg0LHRg9C00LXQvCDQvtGC0L7QsdGA0LDQttCw0YLRjCDRgdC+0L7QsdGJ0LXQvdC40Y9cclxuICAgICAgICBDU1NfQ0hBVF9NRVNTQUdFU19DT05UQUlORVI6IFwicm9vdF9jaGF0X2Zvcl90b3VjaHNvZnRfX3RvcF9tZXNzYWdlc1wiLFxyXG5cclxuICAgICAgICAvLyBtZXNzYWdlXHJcbiAgICAgICAgLy8gQ3NzINC60LvQsNGB0YEg0Y3Qu9C10LzQtdC90YLQsCDQsiDQutC+0YLQvtGA0L7QvCDQvdCw0YXQvtC00LjRgtGB0Y8g0YHQvtC+0LHRidC10L3QuNGPLNC00LDRgtCwINC4INC40LzRjyDQvtGC0L/RgNCw0LLQuNGC0LXQu9GPXHJcbiAgICAgICAgQ1NTX01FU1NBR0VfQ09OVEFJTkVSOiBcInJvb3QtdG91Y2hzb2Z0LWRhc2hib2FyZF9jaGF0LW1lc3NhZ2UtZWxlbWVudHNcIixcclxuICAgICAgICAvLyBDc3Mg0LrQu9Cw0YHRgSBET00g0Y3Qu9C10LzQtdC90YLQsCDQsiDQutC+0YLQvtGA0L7QvCDQsdGD0LTQtdC8INC+0YLQvtCx0YDQsNC20LDRgtGMINC40LzRjyDQvtGC0L/RgNCw0LLQuNGC0LXQu9GPXHJcbiAgICAgICAgQ1NTX0NIQVRfTUVTU0FHRV9TRU5ERVJfTkFNRTogXCJyb290LXRvdWNoc29mdC1kYXNoYm9hcmRfY2hhdC1tZXNzYWdlLXNlbmRlclwiLFxyXG4gICAgICAgIC8vIENzcyDQutC70LDRgdGBIERPTSDRjdC70LXQvNC10L3RgtCwINCyINC60L7RgtC+0YDQvtC8INCx0YPQtNC10Lwg0L7RgtC+0LHRgNCw0LbQsNGC0Ywg0LTQsNGC0YMg0YHQvtC+0LHRidC10L3QuNGPXHJcbiAgICAgICAgQ1NTX0NIQVRfTUVTU0FHRV9EQVRFOiBcInJvb3QtdG91Y2hzb2Z0LWRhc2hib2FyZF9jaGF0LW1lc3NhZ2UtZGF0ZVwiLFxyXG4gICAgICAgIC8vIENzcyDQutC70LDRgdGBIERPTSDRjdC70LXQvNC10L3RgtCwINCyINC60L7RgtC+0YDQvtC8INCx0YPQtNC10Lwg0L7RgtC+0LHRgNCw0LbQsNGC0Ywg0YHQvtC+0LHRidC10L3QuNC1XHJcbiAgICAgICAgQ1NTX0NIQVRfTUVTU0FHRTogXCJyb290LXRvdWNoc29mdC1kYXNoYm9hcmRfY2hhdC1tZXNzYWdlXCJcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIERJU1BMQVlfTUVTU0FHRV9EQVRFOiB0cnVlLFxyXG4gICAgRElTUExBWV9TRU5ERVJfTkFNRTogdHJ1ZSxcclxuICAgIERJU1BMQVlfTUVTU0FHRTogdHJ1ZSxcclxuXHJcbiAgICBVUERBVEVfVVNFUl9EQVRBX1RJTUU6IDUwMDAsXHJcblxyXG4gICAgQ09NTUFORF9QQVRIX1BSRUZJWDogXCJodHRwczovL29ubGluZWNvbnN1bHRhbnR3ZWJhcHAuZmlyZWJhc2Vpby5jb20vdXNlcnNTZXR0aW5ncy9cIlxyXG5cclxufTtcclxuXHJcbi8vIElOQ0xVREVcclxuZnVuY3Rpb24gcGFyc2VTcmNGb3JQYXJhbWV0ZXJzKFxyXG4gICAgc3JjXHJcbikge1xyXG4gICAgdmFyIHVzZXJDb25maWdPYmplY3QgPSB7fTtcclxuICAgIHZhciBhcnJQYXJhbSA9IHNyYy5zdWJzdHIoc3JjLmluZGV4T2YoXCI/XCIpICsgMSkuc3BsaXQoXCImXCIpO1xyXG4gICAgYXJyUGFyYW0uZm9yRWFjaChmdW5jdGlvbiBjcmVhdGVDb25maWdPYmogKGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIgcGFyYW1PYmogPSBlbGVtZW50LnNwbGl0KFwiPVwiKTtcclxuICAgICAgICBwYXJhbU9ialsxXSA9IHBhcmFtT2JqWzFdLnJlcGxhY2UoLycvZywgXCJcIik7XHJcbiAgICAgICAgdXNlckNvbmZpZ09iamVjdFtwYXJhbU9ialswXV0gPSBwYXJhbU9ialsxXTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHVzZXJDb25maWdPYmplY3Q7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldE91dGVyQ2hhdFNldHRpbmdUb0NvbmZpZyAob3V0ZXJDb25maWdPYmplY3QsIGNvbmZpZykge1xyXG4gICAgT2JqZWN0LmtleXMob3V0ZXJDb25maWdPYmplY3QpLm1hcChmdW5jdGlvbiBnZXRPdXRlclNldHRpbmdzIChrZXkpIHtcclxuICAgICAgICBjb25maWcuY2hhdFNldHRpbmdzW2tleV0gPSBvdXRlckNvbmZpZ09iamVjdFtrZXldO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSlcclxufVxyXG5cclxuLy8gSU5DTFVERVxyXG5cclxuc2V0T3V0ZXJDaGF0U2V0dGluZ1RvQ29uZmlnKHBhcnNlU3JjRm9yUGFyYW1ldGVycyhkb2N1bWVudC5jdXJyZW50U2NyaXB0LmdldEF0dHJpYnV0ZShcInNyY1wiKSksIG1haW5Db25maWcpO1xyXG4vKiBleHBvcnRlZCBkYXRhQ29ubmVjdG9yQ29uZmlnICovXHJcbi8qIGV4cG9ydGVkIGRhdGFCYXNlVXJsICovXHJcbi8qIGV4cG9ydGVkIGdldEVsZW1lbnQgKi9cclxuLyogZ2xvYmFsIG1haW5Db25maWcgKi9cclxudmFyIGRhdGFCYXNlVXJsID0gbWFpbkNvbmZpZy5EQVRBX0JBU0VfVVJMO1xyXG5cclxudmFyIGdldEVsZW1lbnQgPSBmdW5jdGlvbiBnZXRFbGVtZW50RnJvbURPTSAoc2VsZWN0b3IsIGlzQWxsLCBpdElzSWQpIHtcclxuICAgIHZhciBzZWxlY3RvclN0YXJ0ID0gKGl0SXNJZCkgPyBcIiNcIiA6IFwiLlwiO1xyXG4gICAgaWYoaXNBbGwpIHtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvclN0YXJ0ICsgc2VsZWN0b3IpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JTdGFydCArIHNlbGVjdG9yKTtcclxufTtcclxuXHJcblxyXG52YXIgZGF0YUNvbm5lY3RvckNvbmZpZyA9IHtcclxuICAgIHR5cGVPZlJlcXVlc3Q6IG1haW5Db25maWcuY2hhdFNldHRpbmdzLnR5cGVPZlJlcXVlc3RcclxufTtcclxuXHJcbi8vIGRhdGFiYXNlXHJcblxyXG4vKiBleHBvcnRlZCBkYXRhQ29ubmVjdG9yICovXHJcbi8qIGdsb2JhbCBkYXRhQ29ubmVjdG9yQ29uZmlnICovXHJcbi8vINCc0L7QtNGD0LvRjCDQv9GA0LXQtNC+0YHRgtCw0LLQu9GP0LXRgiDRgdC/0L7RgdC+0LEg0L7RgtC/0YDQsNCy0LrQuCDQt9Cw0L/RgNC+0YHQsCDQuiDQuNGB0YLQvtGH0L3QuNC60YMg0LTQsNC90L3Ri9GFXHJcbi8vINCU0LvRjyDRgNC10LrQstC10YHRgtCwINC90LXQvtCx0YXQvtC00LjQvCDQv9GD0YLRjCwg0YLQtdC70L4g0LfQsNC/0YDQvtGB0LAsINGC0LjQvyDQt9Cw0L/RgNC+0YHQsFxyXG4vLyByZXF1ZXN0INCy0L7Qt9Cy0YDQsNGJ0LDQtdGCIFByb21pc2VcclxudmFyIGRhdGFDb25uZWN0b3IgPSAoZnVuY3Rpb24gZ2V0RGF0YVNvdXJjZUFQSShkYXRhQ29ubmVjdG9yQ29uZmlnT2JqKSB7XHJcbiAgICB2YXIgZGF0YUJhc2VDb25uZWN0b3I7XHJcblxyXG4gICAgZnVuY3Rpb24gRGF0YUJhc2VDb25uZWN0b3IoKSB7fVxyXG5cclxuICAgIERhdGFCYXNlQ29ubmVjdG9yLnByb3RvdHlwZS5zZXR1cERhdGFCYXNlQVBJID0gZnVuY3Rpb24gc2V0dXBEYXRhQmFzZUFQSSAodHlwZU9mUmVxdWVzdCkge1xyXG4gICAgICAgIHZhciBkYXRhQmFzZUFQSTtcclxuICAgICAgICBpZiAodHlwZU9mUmVxdWVzdCA9PT0gXCJmZXRjaFwiKSB7XHJcbiAgICAgICAgICAgIGRhdGFCYXNlQVBJID0ge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdDogZGF0YUJhc2VDb25uZWN0b3IucmVxdWVzdEZldGNoLFxyXG4gICAgICAgICAgICAgICAgZ2V0TmV3Q29ubmVjdG9yQVBJOiBkYXRhQmFzZUNvbm5lY3Rvci5zZXR1cERhdGFCYXNlQVBJXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlT2ZSZXF1ZXN0ID09PSBcIlhIUlwiKSB7XHJcbiAgICAgICAgICAgIGRhdGFCYXNlQVBJID0ge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdDogZGF0YUJhc2VDb25uZWN0b3IucmVxdWVzdFhNUixcclxuICAgICAgICAgICAgICAgIGdldE5ld0Nvbm5lY3RvckFQSTogZGF0YUJhc2VDb25uZWN0b3Iuc2V0dXBEYXRhQmFzZUFQSVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRhdGFCYXNlQVBJID0ge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdDogZGF0YUJhc2VDb25uZWN0b3IucmVxdWVzdFhNUixcclxuICAgICAgICAgICAgICAgIGNyZWF0ZUxvbmdQb2xsQ29ubmVjdGlvbjogZGF0YUJhc2VDb25uZWN0b3IubG9uZ1BvbGwsXHJcbiAgICAgICAgICAgICAgICBnZXROZXdDb25uZWN0b3JBUEk6IGRhdGFCYXNlQ29ubmVjdG9yLnNldHVwRGF0YUJhc2VBUElcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGFCYXNlQVBJO1xyXG4gICAgfTtcclxuXHJcbiAgICBEYXRhQmFzZUNvbm5lY3Rvci5wcm90b3R5cGUucmVxdWVzdEZldGNoID0gZnVuY3Rpb24gcmVxdWVzdEZldGNoKFxyXG4gICAgICAgIHJlcXVlc3RQYXRoLFxyXG4gICAgICAgIHJlcXVlc3RCb2R5LFxyXG4gICAgICAgIHJlcXVlc3RUeXBlLFxyXG4gICAgICAgIGNvbnRlbnRUeXBlXHJcbiAgICApIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2gocmVxdWVzdFBhdGgsIHtcclxuICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgQWNjZXB0OiBjb250ZW50VHlwZSxcclxuICAgICAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IGNvbnRlbnRUeXBlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1ldGhvZDogcmVxdWVzdFR5cGUsXHJcbiAgICAgICAgICAgIGJvZHk6IHJlcXVlc3RCb2R5XHJcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiBnZXRSZXNwb25zZUpTT04ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgaWYoY29udGVudFR5cGUgPT09IFwiYXBwbGljYXRpb24vanNvblwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIERhdGFCYXNlQ29ubmVjdG9yLnByb3RvdHlwZS5yZXF1ZXN0WE1SID0gZnVuY3Rpb24gcmVxdWVzdFhNUihcclxuICAgICAgICByZXF1ZXN0UGF0aCxcclxuICAgICAgICByZXF1ZXN0Qm9keSxcclxuICAgICAgICByZXF1ZXN0VHlwZSxcclxuICAgICAgICBjb250ZW50VHlwZVxyXG4gICAgKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIHJlcXVlc3QocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICAgICAgeGhyLm9wZW4ocmVxdWVzdFR5cGUsIHJlcXVlc3RQYXRoLCB0cnVlKTtcclxuICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIiwgY29udGVudFR5cGUpO1xyXG4gICAgICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24gbG9hZENhc2UoKSB7XHJcbiAgICAgICAgICAgICAgICBpZihjb250ZW50VHlwZSA9PT0gXCJhcHBsaWNhdGlvbi9qc29uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlKSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoeGhyLnJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiBlcnJvckNhc2UoKSB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoeGhyLnN0YXR1c1RleHQpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAocmVxdWVzdEJvZHkpIHtcclxuICAgICAgICAgICAgICAgIHhoci5zZW5kKHJlcXVlc3RCb2R5KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHhoci5zZW5kKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgRGF0YUJhc2VDb25uZWN0b3IucHJvdG90eXBlLmxvbmdQb2xsID0gZnVuY3Rpb24gbG9uZ1BvbGwgKHRhcmdldFVybCkge1xyXG4gICAgICAgIHZhciB4aHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgIHhodHRwLm9wZW4oJ0dFVCcsIHRhcmdldFVybCwgdHJ1ZSk7XHJcbiAgICAgICAgeGh0dHAuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJ3RleHQvZXZlbnQtc3RyZWFtJyk7XHJcbiAgICAgICAgcmV0dXJuIHhodHRwO1xyXG4gICAgfTtcclxuXHJcbiAgICBkYXRhQmFzZUNvbm5lY3RvciA9IG5ldyBEYXRhQmFzZUNvbm5lY3RvcigpO1xyXG4gICAgcmV0dXJuIGRhdGFCYXNlQ29ubmVjdG9yLnNldHVwRGF0YUJhc2VBUEkoZGF0YUNvbm5lY3RvckNvbmZpZ09iai50eXBlT2ZSZXF1ZXN0KTtcclxuXHJcbn0pKGRhdGFDb25uZWN0b3JDb25maWcpO1xyXG4vKiBleHBvcnRlZCBkYXRhU291cmNlICovXHJcbi8qIGdsb2JhbCBtYWluQ29uZmlnICovXHJcbi8qIGdsb2JhbCBkYXRhQmFzZVVybCAqL1xyXG4vKiBnbG9iYWwgZGF0YUNvbm5lY3RvciAqL1xyXG4vLyDQnNC+0LTRg9C70Ywg0LTQu9GPINC/0L7Qu9GD0YfQtdC90LjRjyDQtNCw0L3QvdGL0YVcclxuLy8g0JLRgdC1IEFQSSDRhNGD0L3QutGG0LjQuCDQstC+0LfQstGA0LDRidCw0Y7RgiDQv9GA0L7QvNC40YHRi1xyXG52YXIgZGF0YVNvdXJjZSA9IChmdW5jdGlvbiBjcmVhdGVEYXRhU291cmNlIChkYXRhQ29ubmVjdG9yLCBjb25maWcpIHtcclxuICAgIHZhciBkYXRhU291cmNlSW5zdGFuY2U7XHJcbiAgICB2YXIgVVNFUl9MSVNUID0gXCJ1c2VyTGlzdFwiO1xyXG4gICAgdmFyIFVTRVJfTUVTU0FHRVMgPSBcInVzZXJzTWVzc2FnZXNcIjtcclxuICAgIHZhciBVU0VSU19TRVRUSU5HUyA9IFwidXNlcnNTZXR0aW5nc1wiO1xyXG4gICAgdmFyIG5ld1VzZXJEYXRhID0ge1xyXG4gICAgICAgIGlzTWluaW1pemU6IGZhbHNlLFxyXG4gICAgICAgIHJlYWRMYXN0TWVzc2FnZTogdHJ1ZVxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBEYXRhU291cmNlKCkge31cclxuXHJcbiAgICBmdW5jdGlvbiBsb25nUG9sbENvbm5lY3QgKGRhdGFUeXBlLCB1c2VySWQpIHtcclxuICAgICAgICB2YXIgcmVxdWVzdFBhdGggPSB0aGlzLmNyZWF0ZVJlcXVlc3RQYXRoKGRhdGFCYXNlVXJsLCB1c2VySWQsIG51bGwsIGRhdGFUeXBlKTtcclxuICAgICAgICByZXR1cm4gZGF0YUNvbm5lY3Rvci5jcmVhdGVMb25nUG9sbENvbm5lY3Rpb24ocmVxdWVzdFBhdGgpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGJhc2ljQ29ubmVjdCAoZGF0YVR5cGUsIHVzZXJJZCkge1xyXG4gICAgICAgIHZhciByZXF1ZXN0UGF0aCA9IHRoaXMuY3JlYXRlUmVxdWVzdFBhdGgoZGF0YUJhc2VVcmwsIHVzZXJJZCwgbnVsbCwgZGF0YVR5cGUpO1xyXG4gICAgICAgIHJldHVybiBkYXRhQ29ubmVjdG9yLnJlcXVlc3QuYmluZChudWxsLCByZXF1ZXN0UGF0aCwgbnVsbCwgXCJHRVRcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpXHJcbiAgICB9XHJcblxyXG4gICAgRGF0YVNvdXJjZS5wcm90b3R5cGUuY3JlYXRlUmVxdWVzdFBhdGggPSBmdW5jdGlvbiBjcmVhdGVSZXF1ZXN0UGF0aChcclxuICAgICAgICBkYXRhQmFzZVVSTCxcclxuICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgcmVxdWVzdFBvc3RmaXgsXHJcbiAgICAgICAgcmVxdWVzdFByZWZpeFxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSBkYXRhQmFzZVVSTDtcclxuICAgICAgICBpZihyZXF1ZXN0UHJlZml4ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gXCIvXCIgKyByZXF1ZXN0UHJlZml4XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh1c2VySWQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgcGF0aCArPSBcIi9cIiArIHVzZXJJZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJlcXVlc3RQb3N0Zml4ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHBhdGggKz0gXCIvXCIgKyByZXF1ZXN0UG9zdGZpeDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGF0aCArPSBcIi5qc29uXCI7XHJcbiAgICAgICAgcmV0dXJuIHBhdGg7XHJcbiAgICB9O1xyXG5cclxuICAgIERhdGFTb3VyY2UucHJvdG90eXBlLmdldEhUTUwgPSBmdW5jdGlvbiBnZXRIVE1MIChyZXF1ZXN0UGF0aCkge1xyXG4gICAgICAgIHJldHVybiBkYXRhQ29ubmVjdG9yLnJlcXVlc3QoXHJcbiAgICAgICAgICAgIHJlcXVlc3RQYXRoLFxyXG4gICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICBcIkdFVFwiLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04J1xyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICBEYXRhU291cmNlLnByb3RvdHlwZS5zZXREYXRhID0gZnVuY3Rpb24gc2V0RGF0YSAoZGF0YVR5cGUsIHJlcXVlc3RUeXBlLCBmaWVsZE5hbWUsIHVzZXJJZCwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgcmVxdWVzdFBhdGg7XHJcbiAgICAgICAgaWYocmVxdWVzdFR5cGUgPT09IFwiUFVUXCIpIHtcclxuICAgICAgICAgICAgcmVxdWVzdFBhdGggPSB0aGlzLmNyZWF0ZVJlcXVlc3RQYXRoKGRhdGFCYXNlVXJsLCB1c2VySWQsIGZpZWxkTmFtZSwgZGF0YVR5cGUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RQYXRoID0gdGhpcy5jcmVhdGVSZXF1ZXN0UGF0aChkYXRhQmFzZVVybCwgdXNlcklkLCBudWxsLCBkYXRhVHlwZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhQ29ubmVjdG9yLnJlcXVlc3QoXHJcbiAgICAgICAgICAgIHJlcXVlc3RQYXRoLFxyXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh2YWx1ZSksXHJcbiAgICAgICAgICAgIHJlcXVlc3RUeXBlLFxyXG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgIERhdGFTb3VyY2UucHJvdG90eXBlLmFkZE5ld1VzZXJUb0RhdGFTb3VyY2UgPSBmdW5jdGlvbiBhZGROZXdVc2VyVG9EYXRhU291cmNlICh1c2VySWQsIHVzZXJOYW1lKSB7XHJcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZTtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgbmV3VXNlckRhdGEudXNlck5hbWUgPSB1c2VyTmFtZTtcclxuICAgICAgICBPYmplY3Qua2V5cyhuZXdVc2VyRGF0YSkubWFwKGZ1bmN0aW9uIGFkZE5ld1NldHRpbmdzIChzZXR0aW5nTmFtZSkge1xyXG4gICAgICAgICAgICB0aGF0LnNldERhdGEoVVNFUlNfU0VUVElOR1MsIFwiUFVUXCIsIHNldHRpbmdOYW1lLCB1c2VySWQsIG5ld1VzZXJEYXRhW3NldHRpbmdOYW1lXSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2V0RGF0YShVU0VSX0xJU1QsIFwiUFVUXCIsIG51bGwsIHVzZXJJZCwge1wibGFzdE9ubGluZVwiOiBkYXRlLmdldFRpbWUoKSwgXCJzZW5kTmV3TWVzc2FnZVwiOiBmYWxzZX0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBEYXRhU291cmNlLnByb3RvdHlwZS5nZXREYXRhU291cmNlQVBJID0gZnVuY3Rpb24gZ2V0RGF0YVNvdXJjZUFQSSAodHlwZU9mUmVxdWVzdCkge1xyXG4gICAgICAgIGlmKHR5cGVPZlJlcXVlc3QpIHtcclxuICAgICAgICAgICAgY29uZmlnLmNoYXRTZXR0aW5ncy50eXBlT2ZSZXF1ZXN0ID0gdHlwZU9mUmVxdWVzdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoY29uZmlnLmNoYXRTZXR0aW5ncy50eXBlT2ZSZXF1ZXN0ID09PSBcImxvbmdQb2xsXCIpIHtcclxuICAgICAgICAgICAgRGF0YVNvdXJjZS5wcm90b3R5cGUuZ2V0RGF0YSA9IGxvbmdQb2xsQ29ubmVjdFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIERhdGFTb3VyY2UucHJvdG90eXBlLmdldERhdGEgPSBiYXNpY0Nvbm5lY3RcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdXNlcnNBUEk6IHtcclxuICAgICAgICAgICAgICAgIGdldFVzZXJMaXN0OiBkYXRhU291cmNlSW5zdGFuY2UuZ2V0RGF0YS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZSxcclxuICAgICAgICAgICAgICAgICAgICBVU0VSX0xJU1RcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBnZXRVc2VyU2V0dGluZ3M6IGRhdGFTb3VyY2VJbnN0YW5jZS5nZXREYXRhLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZUluc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIFVTRVJTX1NFVFRJTkdTXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgZ2V0VXNlck1lc3NhZ2VzOiBkYXRhU291cmNlSW5zdGFuY2UuZ2V0RGF0YS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZSxcclxuICAgICAgICAgICAgICAgICAgICBVU0VSX01FU1NBR0VTXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgZ2V0U2V0dGluZ0ZpZWxkOiBkYXRhU291cmNlSW5zdGFuY2UuZ2V0RGF0YS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZSxcclxuICAgICAgICAgICAgICAgICAgICBVU0VSU19TRVRUSU5HU1xyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlOiBkYXRhU291cmNlSW5zdGFuY2Uuc2V0RGF0YS5iaW5kKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2VJbnN0YW5jZSxcclxuICAgICAgICAgICAgICAgICAgICBVU0VSX01FU1NBR0VTLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiUE9TVFwiXHJcblxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIHNldFNldHRpbmdGaWVsZDogZGF0YVNvdXJjZUluc3RhbmNlLnNldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUlNfU0VUVElOR1MsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJQVVRcIlxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIGFkZE5ld1VzZXJUb0RhdGFTb3VyY2U6IGRhdGFTb3VyY2VJbnN0YW5jZS5hZGROZXdVc2VyVG9EYXRhU291cmNlLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZUluc3RhbmNlXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlTGFzdE9ubGluZTogZGF0YVNvdXJjZUluc3RhbmNlLnNldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUl9MSVNULFxyXG4gICAgICAgICAgICAgICAgICAgIFwiUFVUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJsYXN0T25saW5lXCJcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVTZW5kTmV3TWVzc2FnZUZsYWc6IGRhdGFTb3VyY2VJbnN0YW5jZS5zZXREYXRhLmJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZUluc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIFVTRVJfTElTVCxcclxuICAgICAgICAgICAgICAgICAgICBcIlBVVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwic2VuZE5ld01lc3NhZ2VcIlxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZU1lc3NhZ2VJc1JlYWRGaWVsZDogZGF0YVNvdXJjZUluc3RhbmNlLnNldERhdGEuYmluZChcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgVVNFUl9NRVNTQUdFUyxcclxuICAgICAgICAgICAgICAgICAgICBcIlBVVFwiXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbW1vbkFQSToge1xyXG4gICAgICAgICAgICAgICAgZ2V0SFRNTDogZGF0YVNvdXJjZUluc3RhbmNlLmdldEhUTUwuYmluZChkYXRhU291cmNlSW5zdGFuY2UpLFxyXG4gICAgICAgICAgICAgICAgZ2V0RGF0YVNvdXJjZUFQSTogZGF0YVNvdXJjZUluc3RhbmNlLmdldERhdGFTb3VyY2VBUEkuYmluZChkYXRhU291cmNlSW5zdGFuY2UpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyDQodC+0LfQtNCw0LXQvCBpbnN0YW5jZSDQvtCx0YrQtdC60YLQsCwg0LfQsNC00LDQtdC8IEFQSVxyXG4gICAgZGF0YVNvdXJjZUluc3RhbmNlID0gbmV3IERhdGFTb3VyY2UoKTtcclxuXHJcblxyXG5cclxuICAgIHJldHVybiBkYXRhU291cmNlSW5zdGFuY2UuZ2V0RGF0YVNvdXJjZUFQSSgpO1xyXG59KShkYXRhQ29ubmVjdG9yLCBtYWluQ29uZmlnKTtcclxuXHJcbi8vIGV2ZW50RW1pdHRlclxyXG5cclxuLyogZXhwb3J0ZWQgZXZlbnRFbWl0dGVyICovXHJcbnZhciBldmVudEVtaXR0ZXIgPSAoZnVuY3Rpb24gY3JlYXRlRXZlbnRFbWl0dGVyICgpIHtcclxuICAgIGZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHtcclxuICAgICAgICB0aGlzLmV2ZW50cyA9IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkU3Vic2NyaWJlID0gZnVuY3Rpb24gYWRkU3Vic2NyaWJlKGV2ZW50TmFtZSwgY2FsbGJhY2sgKSB7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIGlmKCAhdGhpcy5ldmVudHNbZXZlbnROYW1lXSApIHtcclxuICAgICAgICAgICAgdGhpcy5ldmVudHNbZXZlbnROYW1lXSA9IFtdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5ldmVudHNbZXZlbnROYW1lXS5wdXNoKGNhbGxiYWNrKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlU3Vic2NyaWJlICgpIHtcclxuICAgICAgICAgICAgdGhhdC5ldmVudHNbZXZlbnROYW1lXSA9IHRoYXQuZXZlbnRzW2V2ZW50TmFtZV0uZmlsdGVyKGZ1bmN0aW9uIHJlbW92ZSAoZWxlbWVudENhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudENhbGxiYWNrICE9PSBjYWxsYmFja1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlbW92ZVN1YnNjcmliZVxyXG4gICAgfTtcclxuXHJcbiAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiBlbWl0IChldmVudE5hbWUsIGRhdGEpIHtcclxuICAgICAgICB2YXIgZXZlbnQgPSB0aGlzLmV2ZW50c1tldmVudE5hbWVdO1xyXG4gICAgICAgIGlmKCBldmVudCApIHtcclxuICAgICAgICAgICAgZXZlbnQuZm9yRWFjaChmdW5jdGlvbiBpbnZva2UgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKG51bGwsIGRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbn0pKCk7XHJcbi8qIGV4cG9ydGVkIGxvbmdQb2xsUmVzcG9uc2VQYXJzZXIgKi9cclxudmFyIGxvbmdQb2xsUmVzcG9uc2VQYXJzZXIgPSAoZnVuY3Rpb24gY3JlYXRlTG9uZ1BvbGxSZXNwb25zZVBhcnNlcigpIHtcclxuICAgIHZhciB0eXBlc09mQ2hhbmdlID0ge1xyXG4gICAgICAgIG1lc3NhZ2U6IC9tZXNzYWdlLyxcclxuICAgICAgICB1c2VyTGlzdDogL2xhc3RPbmxpbmUuezEsfXNlbmROZXdNZXNzYWdlLyxcclxuICAgICAgICBsYXN0T25saW5lOiAvXCJwYXRoXCI6XCJcXC9cXHd7MSx9XFwvbGFzdE9ubGluZS8sXHJcbiAgICAgICAgc2VuZE5ld01lc3NhZ2U6IC9cInBhdGhcIjpcIlxcL1xcd3sxLH1cXC9zZW5kTmV3TWVzc2FnZS8sXHJcbiAgICAgICAgc2V0dGluZzogL3JlYWRMYXN0TWVzc2FnZS8sXHJcbiAgICAgICAgcmVhZDogL3JlYWQvLFxyXG4gICAgICAgIGdldElwOiAvZ2V0SXAvLFxyXG4gICAgICAgIGFza1F1ZXN0aW9uOiAvYXNrUXVlc3Rpb24vXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBldmVudFJlZ3VsYXIgPSAvZXZlbnQ6IHB1dC87XHJcbiAgICB2YXIgaGFzTnVsbERhdGEgPSAvZGF0YTogbnVsbC87XHJcbiAgICB2YXIgZ2V0RGF0YVJlZ3VsYXIgPSAvXCIsXCJkYXRhXCI6LztcclxuICAgIHZhciBpdElzTmV3TWVzc2FnZVJlZ3VsYXIgPSAvXCJwYXRoXCI6XCJcXC8tLztcclxuICAgIHZhciBpdElzTmV3VXNlckxpc3RSZWd1bGFyID0gL1wiZGF0YVwiOntcImxhc3RPbmxpbmVcIjpcXGQrLFwic2VuZE5ld01lc3NhZ2VcIjovO1xyXG4gICAgdmFyIGl0SXNGaXJzdElwRGF0YVJlZ3VsYXIgPSAvZGF0YToge1wicGF0aFwiOlwiXFwvXCIsXCJkYXRhXCI6e1wiZ2V0SXBcIjovO1xyXG4gICAgdmFyIGl0SXNGaXJzdFF1ZXN0aW9uc0RhdGEgPSAvZGF0YToge1wicGF0aFwiOlwiXFwvXCIsXCJkYXRhXCI6e1wiYXNrUXVlc3Rpb25cIjovO1xyXG4gICAgdmFyIGl0SXNOZXdRdWVzdGlvbnNDb21tYW5kID0gL2RhdGE6IHtcInBhdGhcIjpcIlxcL2Fza1F1ZXN0aW9uXCIsXCJkYXRhXCI6LztcclxuICAgIHZhciBpdElzRmlyc3RVc2VyTGlzdENvbm5lY3Rpb24gPSB0cnVlO1xyXG5cclxuICAgIGZ1bmN0aW9uIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIoKSB7fVxyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLmdldFR5cGVPZkNoYW5nZXMgPSBmdW5jdGlvbiBnZXRUeXBlT2ZDaGFuZ2VzKFxyXG4gICAgICAgIGFuc3dlckRhdGFcclxuICAgICkge1xyXG4gICAgICAgIHZhciB0eXBlID0gT2JqZWN0LmtleXModHlwZXNPZkNoYW5nZSkuZmlsdGVyKFxyXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRDdXJyZW50VHlwZU9mQ2hhbmdlKHR5cGVOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZXNPZkNoYW5nZVt0eXBlTmFtZV0udGVzdChhbnN3ZXJEYXRhKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0eXBlTmFtZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiB0eXBlWzBdO1xyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5wcmVwYXJlRGF0YUJlZm9yZUpzb25QYXJzZSA9IGZ1bmN0aW9uIHByZXBhcmVEYXRhQmVmb3JlSnNvblBhcnNlKFxyXG4gICAgICAgIHJlc3BvbnNlXHJcbiAgICApIHtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV1cclxuICAgICAgICAgICAgLnNwbGl0KGdldERhdGFSZWd1bGFyKVsxXVxyXG4gICAgICAgICAgICAudHJpbSgpXHJcbiAgICAgICAgICAgIC5zbGljZSgwLCAtMSk7XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLnBhcnNlVXNlcnNNZXNzYWdlcyA9IGZ1bmN0aW9uIHBhcnNlVXNlcnNNZXNzYWdlcyhcclxuICAgICAgICByZXNwb25zZSxcclxuICAgICAgICBjaGFuZ2VUeXBlXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHt9O1xyXG4gICAgICAgIHZhciBtZXNzYWdlSWQ7XHJcbiAgICAgICAgdmFyIHJlc3VsdE9iamVjdCA9IHt9O1xyXG4gICAgICAgIGlmIChjaGFuZ2VUeXBlID09PSBcInJlYWRcIikge1xyXG4gICAgICAgICAgICBkYXRhLmlkID0gcmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV1cclxuICAgICAgICAgICAgICAgIC5zcGxpdCgnZGF0YToge1wicGF0aFwiOlwiLycpXHJcbiAgICAgICAgICAgICAgICAucG9wKClcclxuICAgICAgICAgICAgICAgIC5zcGxpdCgnL3JlYWRcIixcIicpXHJcbiAgICAgICAgICAgICAgICAuc2hpZnQoKTtcclxuICAgICAgICAgICAgZGF0YS52YWx1ZSA9IHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoJy9yZWFkXCIsXCJkYXRhXCI6JylcclxuICAgICAgICAgICAgICAgIC5wb3AoKVxyXG4gICAgICAgICAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgICAgICAgICAgLnNsaWNlKDAsIC0xKTtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaXRJc05ld01lc3NhZ2VSZWd1bGFyLnRlc3QocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZpcnN0RGF0YShyZXNwb25zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1lc3NhZ2VJZCA9IHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdXHJcbiAgICAgICAgICAgIC5zcGxpdCgnZGF0YToge1wicGF0aFwiOlwiLycpXHJcbiAgICAgICAgICAgIC5wb3AoKVxyXG4gICAgICAgICAgICAuc3BsaXQoZ2V0RGF0YVJlZ3VsYXIpXHJcbiAgICAgICAgICAgIC5zaGlmdCgpO1xyXG4gICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHRoaXMucHJlcGFyZURhdGFCZWZvcmVKc29uUGFyc2UocmVzcG9uc2UpKTtcclxuICAgICAgICByZXN1bHRPYmplY3RbbWVzc2FnZUlkXSA9IGRhdGE7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdE9iamVjdDtcclxuICAgIH07XHJcblxyXG4gICAgTG9uZ1BvbGxSZXNwb25zZVBhcnNlci5wcm90b3R5cGUuaGFzTmV3RGF0YSA9IGZ1bmN0aW9uIGhhc05ld0RhdGEocmVzcG9uc2UpIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAhaGFzTnVsbERhdGEudGVzdChyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXSkgJiYgcmVzcG9uc2UubGVuZ3RoID4gMVxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLnBhcnNlVXNlckxpc3QgPSBmdW5jdGlvbiBwYXJzZVVzZXJMaXN0KFxyXG4gICAgICAgIHJlc3BvbnNlLFxyXG4gICAgICAgIGNoYW5nZVR5cGVcclxuICAgICkge1xyXG4gICAgICAgIHZhciBkYXRhID0ge307XHJcbiAgICAgICAgdmFyIHVzZXJJZDtcclxuICAgICAgICBpZiAoaXRJc0ZpcnN0VXNlckxpc3RDb25uZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGl0SXNGaXJzdFVzZXJMaXN0Q29ubmVjdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGaXJzdERhdGEocmVzcG9uc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXRJc05ld1VzZXJMaXN0UmVndWxhci50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKSkge1xyXG4gICAgICAgICAgICB1c2VySWQgPSB0aGlzLmdldFVzZXJJZChyZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXSwgbnVsbCk7XHJcbiAgICAgICAgICAgIGRhdGFbdXNlcklkXSA9IHRoaXMuZ2V0Rmlyc3REYXRhKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKFxyXG4gICAgICAgICAgICByZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXVxyXG4gICAgICAgICAgICAgICAgLnNwbGl0KGdldERhdGFSZWd1bGFyKVsxXVxyXG4gICAgICAgICAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgICAgICAgICAgLnNsaWNlKDAsIC0xKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdXNlcklkID0gdGhpcy5nZXRVc2VySWQocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0sIGNoYW5nZVR5cGUpO1xyXG4gICAgICAgIHJldHVybiBbdXNlcklkLCBkYXRhXTtcclxuICAgIH07XHJcblxyXG4gICAgTG9uZ1BvbGxSZXNwb25zZVBhcnNlci5wcm90b3R5cGUuZ2V0Rmlyc3REYXRhID0gZnVuY3Rpb24gZ2V0Rmlyc3REYXRhKFxyXG4gICAgICAgIHJlc3BvbnNlXHJcbiAgICApIHtcclxuICAgICAgICB2YXIganNvbkRhdGE7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAganNvbkRhdGEgPSBKU09OLnBhcnNlKHRoaXMucHJlcGFyZURhdGFCZWZvcmVKc29uUGFyc2UocmVzcG9uc2UpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGpzb25EYXRhO1xyXG4gICAgICAgIH0gY2F0Y2ggKGV4Y2VwdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLmdldFVzZXJJZCA9IGZ1bmN0aW9uIGdldFVzZXJJZChcclxuICAgICAgICByZXNwb25zZSxcclxuICAgICAgICBjaGFuZ2VUeXBlXHJcbiAgICApIHtcclxuICAgICAgICBpZiAoY2hhbmdlVHlwZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VcclxuICAgICAgICAgICAgICAgIC5zcGxpdChjaGFuZ2VUeXBlKVxyXG4gICAgICAgICAgICAgICAgLnNoaWZ0KClcclxuICAgICAgICAgICAgICAgIC5zcGxpdCgnZGF0YToge1wicGF0aFwiOlwiLycpXHJcbiAgICAgICAgICAgICAgICAucG9wKClcclxuICAgICAgICAgICAgICAgIC5zbGljZSgwLCAtMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VcclxuICAgICAgICAgICAgICAgIC5zcGxpdCgnZGF0YToge1wicGF0aFwiOlwiLycpXHJcbiAgICAgICAgICAgICAgICAucG9wKClcclxuICAgICAgICAgICAgICAgIC5zcGxpdChcIixcIilbMF1cclxuICAgICAgICAgICAgICAgIC50cmltKClcclxuICAgICAgICAgICAgICAgIC5zbGljZSgwLCAtMSk7XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICBMb25nUG9sbFJlc3BvbnNlUGFyc2VyLnByb3RvdHlwZS5wYXJzZUNvbW1hbmRBbnN3ZXIgPSBmdW5jdGlvbiBwYXJzZUNvbW1hbmRBbnN3ZXIoXHJcbiAgICAgICAgcmVzcG9uc2VcclxuICAgICkge1xyXG4gICAgICAgIHZhciBkYXRhO1xyXG4gICAgICAgIHZhciBpcERhdGE7XHJcbiAgICAgICAgdmFyIGFza1F1ZXN0aW9uRGF0YTtcclxuICAgICAgICB2YXIgaXRJc0lQSW5mb3JtYXRpb24gPSAvZ2V0SXAvLnRlc3QocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgIHZhciBpdElzUXVlc3Rpb25zSW5mb3JtYXRpb24gPSAvYXNrUXVlc3Rpb24vLnRlc3QocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0pO1xyXG5cclxuICAgICAgICBpZihpdElzSVBJbmZvcm1hdGlvbiAmJiBpdElzUXVlc3Rpb25zSW5mb3JtYXRpb24pIHtcclxuICAgICAgICAgICAgZGF0YSA9IHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdLnNwbGl0KC9kYXRhOiB7XCJwYXRoXCI6XCJcXC9cIixcImRhdGFcIjovKS5wb3AoKS5zcGxpdChcIn0sXCIpO1xyXG4gICAgICAgICAgICBhc2tRdWVzdGlvbkRhdGEgPSBKU09OLnBhcnNlKGRhdGFbMF0rIFwifX1cIik7XHJcbiAgICAgICAgICAgIGlwRGF0YSA9IEpTT04ucGFyc2UoXCJ7XCIgKyBkYXRhWzFdLnRyaW0oKS5zbGljZSgwLC0xKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICBhc2tRdWVzdGlvbkRhdGEsXHJcbiAgICAgICAgICAgICAgICBpcERhdGFcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0gZWxzZSBpZiAoaXRJc0lQSW5mb3JtYXRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VVc2VySXBEYXRhKHJlc3BvbnNlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGl0SXNRdWVzdGlvbnNJbmZvcm1hdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZVF1ZXN0aW9uc0RhdGEocmVzcG9uc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgTG9uZ1BvbGxSZXNwb25zZVBhcnNlci5wcm90b3R5cGUucGFyc2VVc2VySXBEYXRhID0gZnVuY3Rpb24gcGFyc2VVc2VySXBEYXRhKFxyXG4gICAgICAgIHJlc3BvbnNlXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgZGF0YTtcclxuICAgICAgICBpZihpdElzRmlyc3RJcERhdGFSZWd1bGFyLnRlc3QocmVzcG9uc2UpKSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKFwie1xcXCJnZXRJcFxcXCI6XCIgKyByZXNwb25zZVtyZXNwb25zZS5sZW5ndGggLSAxXS5zcGxpdChpdElzRmlyc3RJcERhdGFSZWd1bGFyKS5wb3AoKS50cmltKCkuc2xpY2UoMCwtMSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdLnNwbGl0KGV2ZW50UmVndWxhcikucG9wKCkuc3BsaXQoXCJkYXRhOiB7XFxcInBhdGhcXFwiOlxcXCIvZ2V0SXBcXFwiLFxcXCJkYXRhXFxcIjpcIikucG9wKCkudHJpbSgpLnNsaWNlKDAsLTEpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9O1xyXG5cclxuICAgIExvbmdQb2xsUmVzcG9uc2VQYXJzZXIucHJvdG90eXBlLnBhcnNlUXVlc3Rpb25zRGF0YSA9IGZ1bmN0aW9uIHBhcnNlUXVlc3Rpb25zRGF0YShcclxuICAgICAgICByZXNwb25zZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgaWYoaXRJc0ZpcnN0UXVlc3Rpb25zRGF0YS50ZXN0KHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdKSkge1xyXG4gICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShcIntcXFwiYXNrUXVlc3Rpb25cXFwiOlwiICsgcmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0uc3BsaXQoaXRJc0ZpcnN0UXVlc3Rpb25zRGF0YSkucG9wKCkudHJpbSgpLnNsaWNlKDAsLTEpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGl0SXNOZXdRdWVzdGlvbnNDb21tYW5kLnRlc3QocmVzcG9uc2VbcmVzcG9uc2UubGVuZ3RoIC0gMV0pKSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdLnNwbGl0KGl0SXNOZXdRdWVzdGlvbnNDb21tYW5kKS5wb3AoKS50cmltKCkuc2xpY2UoMCwtMSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKFwie1xcXCJhc2tRdWVzdGlvblxcXCI6e1xcXCJcIiArIHJlc3BvbnNlW3Jlc3BvbnNlLmxlbmd0aCAtIDFdLnNwbGl0KFwiZGF0YToge1xcXCJwYXRoXFxcIjpcXFwiL2Fza1F1ZXN0aW9uL1wiKS5wb3AoKS5yZXBsYWNlKFwiXFxcIixcXFwiZGF0YVxcXCJcIiwgXCJcXFwiXCIpICsgXCJ9XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH07XHJcblxyXG4gICAgTG9uZ1BvbGxSZXNwb25zZVBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiBwYXJzZSh0ZXh0KSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRleHQuc3BsaXQoZXZlbnRSZWd1bGFyKTtcclxuICAgICAgICB2YXIgY2hhbmdlVHlwZSA9IHRoaXMuZ2V0VHlwZU9mQ2hhbmdlcyhyZXN1bHRbcmVzdWx0Lmxlbmd0aCAtIDFdKTtcclxuICAgICAgICB2YXIgcmVzdWx0T2ZQYXJzZSA9IHsgdHlwZTogY2hhbmdlVHlwZSB9O1xyXG4gICAgICAgIGlmICh0aGlzLmhhc05ld0RhdGEocmVzdWx0KSkge1xyXG4gICAgICAgICAgICBpZiAoY2hhbmdlVHlwZSA9PT0gXCJtZXNzYWdlXCIgfHwgY2hhbmdlVHlwZSA9PT0gXCJyZWFkXCIpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdE9mUGFyc2Uub2JqZWN0ID0gdGhpcy5wYXJzZVVzZXJzTWVzc2FnZXMocmVzdWx0LCBjaGFuZ2VUeXBlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRPZlBhcnNlO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgICAgICAgY2hhbmdlVHlwZSA9PT0gXCJzZW5kTmV3TWVzc2FnZVwiIHx8XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VUeXBlID09PSBcImxhc3RPbmxpbmVcIiB8fFxyXG4gICAgICAgICAgICAgICAgY2hhbmdlVHlwZSA9PT0gXCJ1c2VyTGlzdFwiXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0T2ZQYXJzZS5vYmplY3QgPSB0aGlzLnBhcnNlVXNlckxpc3QocmVzdWx0LCBjaGFuZ2VUeXBlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRPZlBhcnNlO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZVR5cGUgPT09IFwiZ2V0SXBcIiB8fCBjaGFuZ2VUeXBlID09PSBcImFza1F1ZXN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgcmVzdWx0T2ZQYXJzZS5vYmplY3QgPSB0aGlzLnBhcnNlQ29tbWFuZEFuc3dlcihyZXN1bHQsIGNoYW5nZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdE9mUGFyc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IExvbmdQb2xsUmVzcG9uc2VQYXJzZXIoKTtcclxufSkoKTtcclxuXHJcbi8vIGluc3RydWN0aW9uc1xyXG5cclxuLyogZ2xvYmFsIGluc3RydWN0aW9uUXVldWVNYW5hZ2VyICovXHJcbi8qIGdsb2JhbCBpbnN0cnVjdGlvbkxpc3QgKi9cclxuLyogZ2xvYmFsIGRhdGFDb25uZWN0b3IgKi9cclxuLyogZ2xvYmFsIGxvbmdQb2xsUmVzcG9uc2VQYXJzZXIgKi9cclxuLyogZ2xvYmFsIG1haW5Db25maWcgKi9cclxudmFyIGluc3RydWN0aW9uUGVyZm9ybWVyID0gKGZ1bmN0aW9uIChjb25maWcsIGRhdGFDb25uZWN0b3IsIHBhcnNlcikge1xyXG5cclxuICAgIHZhciBpc1BlcmZvcm1lZCA9IGZhbHNlO1xyXG4gICAgdmFyIGNvbm5lY3Rpb24gPSBudWxsO1xyXG4gICAgdmFyIGlzU3RhcnRYSFJDb25uZWN0aW9uID0gZmFsc2U7XHJcblxyXG4gICAgdmFyIGluc3RydWN0aW9uUXVldWVNYW5hZ2VyID0gKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdmFyIGluc3RydWN0aW9uc1F1ZXVlID0gW107XHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gYWRkSW5zdHJ1Y3Rpb25zKGluc3RydWN0aW9ucykge1xyXG4gICAgICAgICAgICB2YXIgaW5zdHJ1Y3Rpb25PYmplY3Q7XHJcbiAgICAgICAgICAgIGlmIChpbnN0cnVjdGlvbnMgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb25zLmZvckVhY2goZnVuY3Rpb24oaW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWl0V2FzRXhlY3V0ZWQoaW5zdHJ1Y3Rpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uc1F1ZXVlLnB1c2goaW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFpdFdhc0V4ZWN1dGVkKGluc3RydWN0aW9ucykpIHtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uT2JqZWN0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uT2JqZWN0W2luc3RydWN0aW9ucy5jb21tYW5kTmFtZV0gPSBpbnN0cnVjdGlvbnM7XHJcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbnNRdWV1ZS5wdXNoKGluc3RydWN0aW9uT2JqZWN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBmdW5jdGlvbiBwcmVwYXJlSW5zdHJ1Y3Rpb25CZWZvcmVFeGVjdXRlKGluc3RydWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciBpbnN0cnVjdGlvbkRhdGEgPSB7fTtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMoaW5zdHJ1Y3Rpb24pLm1hcChmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uRGF0YS5wYXJhbWV0ZXJzID0gZ2V0UGFyYW1ldGVycyhpbnN0cnVjdGlvbltrZXldKTtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uRGF0YS5pbnN0dWN0aW9uTmFtZSA9IGtleTtcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uRGF0YS50eXBlT2ZDb21tYW5kID0gaW5zdHJ1Y3Rpb25ba2V5XS50eXBlT2ZDb21tYW5kO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGluc3RydWN0aW9uRGF0YTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0UGFyYW1ldGVycyhjb21tYW5kRGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgcGFyYW1ldGVycyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgaTtcclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvbW1hbmREYXRhLnBhcmFtZXRlcnNOdW1iZXI7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1ldGVycy5wdXNoKGNvbW1hbmREYXRhW1wicGFyYW1ldGVyXCIgKyBpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHBhcmFtZXRlcnM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGl0V2FzRXhlY3V0ZWQoaW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICAgICAgdmFyIGlzRXhlY3V0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGluc3RydWN0aW9uKS5tYXAoZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgICAgICAgICBpc0V4ZWN1dGUgPSBpbnN0cnVjdGlvbltrZXldLmlzRXhlY3V0ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpc0V4ZWN1dGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGdldE5leHRJbnN0cnVjdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnRJbnN0cnVjdGlvbjtcclxuICAgICAgICAgICAgaWYgKGluc3RydWN0aW9uc1F1ZXVlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uc1F1ZXVlLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJlcGFyZUluc3RydWN0aW9uQmVmb3JlRXhlY3V0ZShjdXJyZW50SW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEFQSSgpIHtcclxuICAgICAgICAgICAgdmFyIGluc3RydWN0aW9uc1F1ZXVlQVBJID0ge307XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uc1F1ZXVlQVBJLm5leHQgPSBnZXROZXh0SW5zdHJ1Y3Rpb247XHJcbiAgICAgICAgICAgIGluc3RydWN0aW9uc1F1ZXVlQVBJLmFkZCA9IGFkZEluc3RydWN0aW9ucztcclxuICAgICAgICBcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGluc3RydWN0aW9uc1F1ZXVlQVBJLCBcImxlbmd0aFwiLCB7XHJcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnN0cnVjdGlvbnNRdWV1ZS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbihuZXdWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uc1F1ZXVlLmxlbmd0aCA9IG5ld1ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBpbnN0cnVjdGlvbnNRdWV1ZUFQSTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBnZXRBUEkoKTtcclxuXHJcbiAgICB9KSgpO1xyXG5cclxuICAgIHZhciBpbnN0cnVjdGlvbnMgPSAoZnVuY3Rpb24gKGNvbmZpZykge1xyXG5cclxuICAgICAgICB2YXIgcXVlc3Rpb25MaXN0ZW5lciA9IG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0SVAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhQ29ubmVjdG9yLnJlcXVlc3QoXHJcbiAgICAgICAgICAgICAgICBcImh0dHBzOi8vZ2VvaXAtZGIuY29tL2pzb24vXCIsXHJcbiAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgXCJHRVRcIixcclxuICAgICAgICAgICAgICAgIFwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVSZXN1bHQoZGF0YSwgZGF0YU5hbWUpIHtcclxuICAgICAgICAgICAgdmFyIHVzZXIgPSBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQ7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhQ29ubmVjdG9yLnJlcXVlc3QoXHJcbiAgICAgICAgICAgICAgICBcImh0dHBzOi8vb25saW5lY29uc3VsdGFudHdlYmFwcC5maXJlYmFzZWlvLmNvbS91c2Vyc1NldHRpbmdzL1wiICtcclxuICAgICAgICAgICAgICAgIHVzZXIgK1xyXG4gICAgICAgICAgICAgICAgXCIvXCIgK1xyXG4gICAgICAgICAgICAgICAgZGF0YU5hbWUgK1xyXG4gICAgICAgICAgICAgICAgXCIuanNvblwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YSxcclxuICAgICAgICAgICAgICAgIFwiUFVUXCIsXHJcbiAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBmdW5jdGlvbiBnZXRVc2VySVAoaW5zdHJ1Y3Rpb25OYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0SVAoKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzYXZlUmVzdWx0KGRhdGEsIFwiY29tbWFuZHNSZXNwb25zZS9nZXRJcFwiKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBub3RpZnkoaW5zdHJ1Y3Rpb25OYW1lKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBmdW5jdGlvbiBub3RpZnkocGF0aE9mTm90aWZ5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhQ29ubmVjdG9yLnJlcXVlc3QoXHJcbiAgICAgICAgICAgICAgICBjb25maWcuQ09NTUFORF9QQVRIX1BSRUZJWCArXHJcbiAgICAgICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQgK1xyXG4gICAgICAgICAgICAgICAgXCIvY29tbWFuZHMvXCIgK1xyXG4gICAgICAgICAgICAgICAgcGF0aE9mTm90aWZ5ICtcclxuICAgICAgICAgICAgICAgIFwiL2lzRXhlY3V0ZS5qc29uXCIsXHJcbiAgICAgICAgICAgICAgICB0cnVlLFxyXG4gICAgICAgICAgICAgICAgXCJQVVRcIixcclxuICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGJhc2ljUXVlc3Rpb25DYWxsYmFjayhpbnN0cnVjdGlvbk5hbWUsIGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGlucHV0VmFsdWUgPSBnZXRFbGVtZW50KGNvbmZpZy5ET00uVVNFUl9OQU1FX0lOUFVUX0NMQVNTKS52YWx1ZTtcclxuICAgICAgICAgICAgdmFyIGlucHV0RGF0YSA9IEpTT04uc3RyaW5naWZ5KGlucHV0VmFsdWUpO1xyXG4gICAgICAgICAgICBzYXZlUmVzdWx0KGlucHV0RGF0YSwgXCJjb21tYW5kc1Jlc3BvbnNlL1wiICsgaW5zdHJ1Y3Rpb25OYW1lICsgXCIvXCIgKyBkYXRhWzFdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlUXVlc3Rpb25NZW51VmlzaWJsZSgpIHtcclxuICAgICAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLkFVVEhPUklaQVRJT05fTUVOVV9DTEFTUykuY2xhc3NMaXN0LnRvZ2dsZShcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5JTlZJU0lCTEVfQ0xBU1NcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gc2hvd1F1ZXN0aW9uKFxyXG4gICAgICAgICAgICBpbnN0cnVjdGlvbk5hbWUsXHJcbiAgICAgICAgICAgIGNhbGxiYWNrLFxyXG4gICAgICAgICAgICBkYXRhLFxyXG4gICAgICAgICAgICBjb250ZXh0LFxyXG4gICAgICAgICAgICBpc05lZWROb3RpZnksXHJcbiAgICAgICAgICAgIGlzU2F2ZURhdGFcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgdmFyIGZ1bGxDYWxsYmFjaztcclxuICAgICAgICAgICAgZnVsbENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVRdWVzdGlvbk1lbnVWaXNpYmxlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNOZWVkTm90aWZ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZ5KGluc3RydWN0aW9uTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKGNvbnRleHQsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGlzU2F2ZURhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBiYXNpY1F1ZXN0aW9uQ2FsbGJhY2suY2FsbChjb250ZXh0LCBpbnN0cnVjdGlvbk5hbWUsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBzZXR1cFF1ZXN0aW9uTWVudShkYXRhKTtcclxuICAgICAgICAgICAgaWYgKHF1ZXN0aW9uTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZVByZXZpb3VzUXVlc3Rpb25MaXN0ZW5lcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHF1ZXN0aW9uTGlzdGVuZXIgPSBnZXRBbnN3ZXJPblF1ZXN0aW9uLmJpbmQobnVsbCwgZnVsbENhbGxiYWNrKTtcclxuICAgICAgICAgICAgc2V0dXBOZXdRdWVzdGlvbkxpc3RlbmVyKCk7XHJcbiAgICAgICAgICAgIHRvZ2dsZVF1ZXN0aW9uTWVudVZpc2libGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0dXBRdWVzdGlvbk1lbnUoZGF0YSkge1xyXG4gICAgICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uQ0hBVF9RVUVTVElPTl9DU1MpLmlubmVySFRNTCA9IGRhdGFbMV07XHJcbiAgICAgICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5VU0VSX05BTUVfSU5QVVRfQ0xBU1MpLnZhbHVlID0gXCJcIjtcclxuICAgICAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlVTRVJfTkFNRV9JTlBVVF9DTEFTUykucGxhY2Vob2xkZXIgPSBkYXRhWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBmdW5jdGlvbiBzZXR1cE5ld1F1ZXN0aW9uTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5TRU5EX1VTRVJfTkFNRV9CVVRUT04pLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICAgICBcImNsaWNrXCIsXHJcbiAgICAgICAgICAgICAgICBxdWVzdGlvbkxpc3RlbmVyXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZVByZXZpb3VzUXVlc3Rpb25MaXN0ZW5lcigpIHtcclxuICAgICAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFTkRfVVNFUl9OQU1FX0JVVFRPTikucmVtb3ZlRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAgICAgICAgIFwiY2xpY2tcIixcclxuICAgICAgICAgICAgICAgIHF1ZXN0aW9uTGlzdGVuZXJcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0QW5zd2VyT25RdWVzdGlvbihjYWxsYmFjaykge1xyXG4gICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICBmdW5jdGlvbiBnZXRBUEkgKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZ2V0SXA6IGdldFVzZXJJUCxcclxuICAgICAgICAgICAgICAgIGFza1F1ZXN0aW9uOiBzaG93UXVlc3Rpb25cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBnZXRBUEkoKTtcclxuXHJcbiAgICB9KShtYWluQ29uZmlnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBzZXR1cFhIUkNvbm5lY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBrZXlPZkNvbW1hbmRzO1xyXG4gICAgICAgIHZhciBwYXJhbWV0ZXJzO1xyXG4gICAgICAgIHZhciBrZXk7XHJcbiAgICAgICAgaWYoaXNTdGFydFhIUkNvbm5lY3Rpb24pIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhQ29ubmVjdG9yLnJlcXVlc3QoXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnLkNPTU1BTkRfUEFUSF9QUkVGSVggKyBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQgKyBcIi9jb21tYW5kcy5qc29uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBcIkdFVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgICAgICAgICApLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBrZXlPZkNvbW1hbmRzID0gaGFzSW5zdHJ1Y3Rpb25LZXkoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoa2V5T2ZDb21tYW5kcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IGtleU9mQ29tbWFuZHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMgPSBnZXRQYXJhbWV0ZXJzKGRhdGFba2V5XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RydWN0aW9uUGVyZm9ybWVyLmV4ZWN1dGUoa2V5LCBwYXJhbWV0ZXJzLCBzZXR1cFhIUkNvbm5lY3Rpb24sIG51bGwsIHRydWUsIHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0dXBYSFJDb25uZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSxjb25maWcuVVBEQVRFX1VTRVJfREFUQV9USU1FKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgZnVuY3Rpb24gZ2V0UGFyYW1ldGVycyhjb21tYW5kRGF0YSkge1xyXG4gICAgICAgIHZhciBwYXJhbWV0ZXJzID0gW107XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgZm9yKGkgPSAwOyBpIDwgY29tbWFuZERhdGEucGFyYW1ldGVyc051bWJlcjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHBhcmFtZXRlcnMucHVzaChjb21tYW5kRGF0YVtcInBhcmFtZXRlclwiICsgaV0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJhbWV0ZXJzO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBoYXNJbnN0cnVjdGlvbktleShjb21tYW5kcykge1xyXG4gICAgICAgIGlmKCFjb21tYW5kcykge1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhjb21tYW5kcykuZmlsdGVyKGZ1bmN0aW9uIChjb21tYW5kT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhY29tbWFuZHNbY29tbWFuZE9iamVjdF0uaXNFeGVjdXRlO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBzZXR1cExvbmdQb2xsQ29ubmVjdGlvbiAoKSB7XHJcbiAgICAgICAgY29ubmVjdGlvbiA9IGRhdGFDb25uZWN0b3IuY3JlYXRlTG9uZ1BvbGxDb25uZWN0aW9uKFxyXG4gICAgICAgICAgICBjb25maWcuQ09NTUFORF9QQVRIX1BSRUZJWCArIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZCArIFwiL2NvbW1hbmRzLmpzb25cIlxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29ubmVjdGlvbi5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiBjb21tYW5kQ2hhbmdlQ2FsbGJhY2sgKCkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YTtcclxuICAgICAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gMyAmJiB0aGlzLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhID0gcGFyc2VyLnBhcnNlKHRoaXMucmVzcG9uc2VUZXh0KS5vYmplY3Q7XHJcbiAgICAgICAgICAgICAgICBpZihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb25RdWV1ZU1hbmFnZXIuYWRkKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV4ZWN1dGVBbGxJbnN0cnVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25uZWN0aW9uLnNlbmQoKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBleGVjdXRlQWxsSW5zdHJ1Y3Rpb24gKGl0SXNUaGlzU3RyZWFtKSB7XHJcbiAgICAgICAgdmFyIGluc3RydWN0aW9uO1xyXG4gICAgICAgIGlmKGluc3RydWN0aW9uUXVldWVNYW5hZ2VyLmxlbmd0aCA+IDAgJiYgKGl0SXNUaGlzU3RyZWFtIHx8ICFpc1BlcmZvcm1lZCkpIHtcclxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24gPSBpbnN0cnVjdGlvblF1ZXVlTWFuYWdlci5uZXh0KCk7XHJcbiAgICAgICAgICAgIGlzUGVyZm9ybWVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgZXhlY3V0ZUNvbW1hbmQoXHJcbiAgICAgICAgICAgICAgICBpbnN0cnVjdGlvbi5pbnN0dWN0aW9uTmFtZSxcclxuICAgICAgICAgICAgICAgIGluc3RydWN0aW9uLnBhcmFtZXRlcnMsXHJcbiAgICAgICAgICAgICAgICBleGVjdXRlQWxsSW5zdHJ1Y3Rpb24uYmluZChudWxsLCB0cnVlKSxcclxuICAgICAgICAgICAgICAgIG51bGwsIHRydWUsIHRydWVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2UgaWYoaXRJc1RoaXNTdHJlYW0pIHtcclxuICAgICAgICAgICAgaXNQZXJmb3JtZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBleGVjdXRlQ29tbWFuZCAoaW5zdHJ1Y3Rpb25OYW1lLCBkYXRhLCBjYWxsYmFjaywgY29udGV4dCwgaXNOZWVkTm90aWZ5LCBpc1NhdmVEYXRhKSB7XHJcbiAgICAgICAgaWYoaW5zdHJ1Y3Rpb25zW2luc3RydWN0aW9uTmFtZV0pIHtcclxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb25zW2luc3RydWN0aW9uTmFtZV0uY2FsbChudWxsLCBpbnN0cnVjdGlvbk5hbWUsIGNhbGxiYWNrLCBkYXRhLCBjb250ZXh0LCBpc05lZWROb3RpZnksIGlzU2F2ZURhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInJlcXVpcmVkIGNvbW1hbmQgaXMgbm90IGZvdW5kXCIpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBzdGFydEFwcGxpY2F0aW9uICh0eXBlT2ZDb25uZWN0aW9uKSB7XHJcbiAgICAgICAgaWYodHlwZU9mQ29ubmVjdGlvbiA9PT0gXCJsb25nUG9sbFwiKSB7XHJcbiAgICAgICAgICAgIHNldHVwTG9uZ1BvbGxDb25uZWN0aW9uKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaXNTdGFydFhIUkNvbm5lY3Rpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICBzZXR1cFhIUkNvbm5lY3Rpb24oKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgZnVuY3Rpb24gY2xvc2VBcHBsaWNhdGlvbigpIHtcclxuICAgICAgICBpZihjb25uZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbm5lY3Rpb24uYWJvcnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoaXNTdGFydFhIUkNvbm5lY3Rpb24pIHtcclxuICAgICAgICAgICAgaXNTdGFydFhIUkNvbm5lY3Rpb24gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBleGVjdXRlOiBleGVjdXRlQ29tbWFuZCxcclxuICAgICAgICBzdGFydEFwcDogc3RhcnRBcHBsaWNhdGlvbixcclxuICAgICAgICBjbG9zZUFwcDogY2xvc2VBcHBsaWNhdGlvblxyXG4gICAgfTtcclxuXHJcbn0pKG1haW5Db25maWcsIGRhdGFDb25uZWN0b3IsIGxvbmdQb2xsUmVzcG9uc2VQYXJzZXIpO1xyXG5cclxuLy8gbWVzc2FnZU1hbmFnZXJcclxuXHJcbi8qIGdsb2JhbCBnZXRFbGVtZW50ICovXHJcbi8qIGdsb2JhbCBtYWluQ29uZmlnICovXHJcbi8qIGV4cG9ydGVkIG1lc3NhZ2VMaXN0TWFuYWdlciAqL1xyXG4vLyDQnNC+0LTRg9C70Ywg0LTQu9GPINGA0LDQsdC+0YLRiyDRgdC+INGB0L/QuNGB0LrQvtC8INGB0L7QvtCx0YnQtdC90LjQuSDQntCU0J3QntCT0J4g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXHJcbnZhciBtZXNzYWdlTGlzdE1hbmFnZXIgPSAoZnVuY3Rpb24gc2V0dXBNZXNzYWdlTGlzdE1hbmFnZXIgKGNvbmZpZykge1xyXG4gICAgLy8gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICAgIC8vINCk0L7RgNC80LDRgiAgbWVzc2FnZUxpc3QgPSBbXHJcbiAgICAvLyAgICB7XHJcbiAgICAvLyAgICAgICBzZW5kZXI6IHNlbmRlclxyXG4gICAgLy8gICAgICAgbWVzc2FnZTogbWVzc2FnZSxcclxuICAgIC8vICAgICAgIHJlYWQ6IHRydWUvZmFsc2VcclxuICAgIC8vICAgICAgIGRhdGU6IGRhdGVcclxuICAgIC8vICAgIH0sXHJcbiAgICAvLyBdXHJcbiAgICAvLyByZWFkIC0g0LHRi9C70L4g0LvQuCDQv9GA0L7Rh9C40YLQsNC90L4g0YHQvtC+0LHRidC10L3QuNC1XHJcbiAgICAvLyAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICAgIGZ1bmN0aW9uIE1lc3NhZ2VMaXN0TWFuYWdlcigpIHt9XHJcblxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS5zZXR1cCA9IGZ1bmN0aW9uIHNldHVwICgpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VMaXN0ID0gW107XHJcbiAgICAgICAgdGhpcy5jRE9NID0ge1xyXG4gICAgICAgICAgICBtZXNzYWdlc0Jsb2NrOiBnZXRFbGVtZW50KFxyXG4gICAgICAgICAgICAgICAgY29uZmlnLm1lc3NhZ2VzLkNTU19DSEFUX01FU1NBR0VTX0NPTlRBSU5FUlxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFdPUksgV0lUSCBNRVNTQUdFIEVMRU1FTlQgLy9cclxuXHJcbiAgICAvLyDQodC+0LfQtNCw0LXRgiBET00g0Y3Qu9C10LzQtdC90YIg0YHQvtC+0LHRidC10L3QuNGPINC00LvRjyDQvtGC0L7QsdGA0LDQttC10L3QuNGPINC90LAg0Y3QutGA0LDQvdC1XHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLmNyZWF0ZU1lc3NhZ2VFbGVtZW50ID0gZnVuY3Rpb24gY3JlYXRlTWVzc2FnZUVsZW1lbnQoXHJcbiAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICBtZXNzYWdlRGF0ZSxcclxuICAgICAgICBzZW5kZXIsXHJcbiAgICAgICAgaXNSZWFkXHJcbiAgICApIHtcclxuICAgICAgICB2YXIgbWVzc2FnZUNvbnRhaW5lckRpdiA9IHRoaXMuY3JlYXRlTWVzc2FnZUNvbnRhaW5lckRpdihpc1JlYWQsIHNlbmRlcik7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2VEYXRlRGl2ID0gdGhpcy5jcmVhdGVEaXZGb3JNZXNzYWdlQmxvY2soXHJcbiAgICAgICAgICAgIG1lc3NhZ2VEYXRlLFxyXG4gICAgICAgICAgICBjb25maWcuRElTUExBWV9NRVNTQUdFX0RBVEUsXHJcbiAgICAgICAgICAgIFtjb25maWcubWVzc2FnZXMuQ1NTX0NIQVRfTUVTU0FHRV9EQVRFXVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHZhciBtZXNzYWdlU2VuZGVyRGl2ID0gdGhpcy5jcmVhdGVEaXZGb3JNZXNzYWdlQmxvY2soXHJcbiAgICAgICAgICAgIHNlbmRlcixcclxuICAgICAgICAgICAgY29uZmlnLkRJU1BMQVlfU0VOREVSX05BTUUsXHJcbiAgICAgICAgICAgIFtjb25maWcubWVzc2FnZXMuQ1NTX0NIQVRfTUVTU0FHRV9TRU5ERVJfTkFNRV1cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICB2YXIgbWVzc2FnZURpdiA9IHRoaXMuY3JlYXRlRGl2Rm9yTWVzc2FnZUJsb2NrKFxyXG4gICAgICAgICAgICBtZXNzYWdlLFxyXG4gICAgICAgICAgICBjb25maWcuRElTUExBWV9NRVNTQUdFLFxyXG4gICAgICAgICAgICBbY29uZmlnLm1lc3NhZ2VzLkNTU19DSEFUX01FU1NBR0VdXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZChtZXNzYWdlRGF0ZURpdik7XHJcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZChtZXNzYWdlU2VuZGVyRGl2KTtcclxuICAgICAgICBtZXNzYWdlQ29udGFpbmVyRGl2LmFwcGVuZENoaWxkKG1lc3NhZ2VEaXYpO1xyXG5cclxuICAgICAgICByZXR1cm4gbWVzc2FnZUNvbnRhaW5lckRpdjtcclxuICAgIH07XHJcblxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS5nZXRNZXNzYWdlT2JqZWN0c0Zvck1hcmtBc1JlYWQgPSBmdW5jdGlvbiAgZ2V0TWVzc2FnZU9iamVjdHNGb3JNYXJrQXNSZWFkICgpIHtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICB2YXIgbWVzc2FnZXNJc1JlYWQgPSBbXTtcclxuICAgICAgICB2YXIgdXNlck5hbWUgPSBjb25maWcuQURNSU5fTkFNRSB8fCBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZTtcclxuICAgICAgICB2YXIgdXNlcklkID0gY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkO1xyXG4gICAgICAgIGZvcihpID0gdGhpcy5tZXNzYWdlTGlzdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICBpZih0aGlzLm1lc3NhZ2VMaXN0W2ldLnNlbmRlciAhPT0gdXNlck5hbWUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCF0aGlzLm1lc3NhZ2VMaXN0W2ldLnJlYWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlc0lzUmVhZC5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTmFtZTogdGhpcy5tZXNzYWdlTGlzdFtpXS5pZCArIFwiL3JlYWRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkVmFsdWU6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlTGlzdFtpXS5yZWFkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2VzSXNSZWFkO1xyXG4gICAgfTtcclxuXHJcblxyXG5cclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUuY3JlYXRlTWVzc2FnZUNvbnRhaW5lckRpdiA9IGZ1bmN0aW9uIGNyZWF0ZU1lc3NhZ2VDb250YWluZXJEaXYgKGlzUmVhZCwgc2VuZGVyKSB7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2VDb250YWluZXJEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIG1lc3NhZ2VDb250YWluZXJEaXYuY2xhc3NMaXN0LmFkZChjb25maWcubWVzc2FnZXMuQ1NTX01FU1NBR0VfQ09OVEFJTkVSKTtcclxuICAgICAgICBpZiAoIWlzUmVhZCAmJiBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZSAhPT0gc2VuZGVyKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VDb250YWluZXJEaXYuY2xhc3NMaXN0LmFkZChjb25maWcubWVzc2FnZXMuQ1NTX1VTRVJfTk9UX1JFQURfTUVTU0FHRVMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWVzc2FnZUNvbnRhaW5lckRpdjtcclxuICAgIH07XHJcblxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS5jcmVhdGVEaXZGb3JNZXNzYWdlQmxvY2sgPSBmdW5jdGlvbiBjcmVhdGVEaXZGb3JNZXNzYWdlQmxvY2sgKHRleHQsIGlzRGlzcGxheSwgc3R5bGVDbGFzc2VzKSB7XHJcbiAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgc3R5bGVDbGFzc2VzLmZvckVhY2goZnVuY3Rpb24gY2xhc3NBZGQgKHN0eWxlKSB7XHJcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKHN0eWxlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBkaXYuaW5uZXJIVE1MID0gdGV4dDtcclxuICAgICAgICByZXR1cm4gZGl2O1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBXT1JLIFdJVEggTUVTU0FHRSBFTEVNRU5UIC8vXHJcblxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS5jcmVhdGVNZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIGNyZWF0ZU1lc3NhZ2VMaXN0IChtZXNzYWdlT2JqZWN0cykgIHtcclxuICAgICAgICB2YXIgbmV3TWVzc2FnZUxpc3QgPSBbXTtcclxuICAgICAgICBpZihtZXNzYWdlT2JqZWN0cykge1xyXG4gICAgICAgICAgICBtZXNzYWdlT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uIGFkZEVsZW1lbnRUb01lc3NhZ2VMaXN0IChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBuZXdNZXNzYWdlTGlzdC5wdXNoKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ld01lc3NhZ2VMaXN0O1xyXG4gICAgfTtcclxuXHJcbiAgICBNZXNzYWdlTGlzdE1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZU1lc3NhZ2VMaXN0ID0gZnVuY3Rpb24gdXBkYXRlTWVzc2FnZUxpc3QgKG5ld01lc3NhZ2VMaXN0KSB7XHJcbiAgICAgICAgaWYodGhpcy5nZXRNZXNzYWdlT2JqZWN0c0Zvck1hcmtBc1JlYWQoKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnJlYWRMYXN0TWVzc2FnZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm1lc3NhZ2VMaXN0ID0gbmV3TWVzc2FnZUxpc3Q7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5TWVzc2FnZXMoKTtcclxuICAgIH07XHJcblxyXG4gICAgTWVzc2FnZUxpc3RNYW5hZ2VyLnByb3RvdHlwZS5hZGRNZXNzYWdlVG9NZXNzYWdlTGlzdCA9IGZ1bmN0aW9uIGFkZE1lc3NhZ2VUb01lc3NhZ2VMaXN0IChcclxuICAgICAgICBtZXNzYWdlT2JqXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VMaXN0LnB1c2gobWVzc2FnZU9iaik7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vINCf0LXRgNC10LHQuNGA0LDQtdGCINGB0L/QuNGB0L7QuiDRgdC+0L7QsdGJ0LXQvdC40LksINGB0L7Qt9C00LDQtdGCINGB0L7QvtGC0LLQtdGC0YHQstGD0Y7RidC40LUg0LjQvCBET00g0Y3Qu9C10LzQtdC90YLRiyDQuCDQstGB0YLQsNCy0LvRj9C10YIg0LjRhSDQsiDRh9Cw0YJcclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUuZGlzcGxheU1lc3NhZ2VzID0gZnVuY3Rpb24gZGlzcGxheU1lc3NhZ2VzKCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICB2YXIgZWxlbWVudDtcclxuICAgICAgICB0aGlzLmNsZWFyQ2hhdCgpO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZUxpc3QuZm9yRWFjaChmdW5jdGlvbiBjcmVhdGVNZXNzYWdlIChtZXNzYWdlT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQgPSB0aGF0LmNyZWF0ZU1lc3NhZ2VFbGVtZW50KFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU9iamVjdC5tZXNzYWdlLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU9iamVjdC5kYXRlLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZU9iamVjdC5zZW5kZXIsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlT2JqZWN0LnJlYWRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdGhhdC5jRE9NLm1lc3NhZ2VzQmxvY2suYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vINCe0YfQuNGB0YLQuNGC0YwgRE9NINGN0LvQtdC80LXQvdGCINCyINC60L7RgtC+0YDQvtC8INC+0YLQvtCx0YDQsNC20LDRjtGC0YHRjyDRgdC+0L7QsdGJ0LXQvdC40Y8gKNC90LDQv9GA0LjQvNC10YAg0YfRgtC+0LHRiyDQstGB0YLQsNCy0LjRgtGMINC90LLQvtGL0Lkg0YHQv9C40YHQvtC6INGB0L7QvtCx0YnQtdC90LjQuSlcclxuICAgIE1lc3NhZ2VMaXN0TWFuYWdlci5wcm90b3R5cGUuY2xlYXJDaGF0ID0gZnVuY3Rpb24gY2xlYXJDaGF0KCkge1xyXG4gICAgICAgIHdoaWxlICh0aGlzLmNET00ubWVzc2FnZXNCbG9jay5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY0RPTS5tZXNzYWdlc0Jsb2NrLnJlbW92ZUNoaWxkKHRoaXMuY0RPTS5tZXNzYWdlc0Jsb2NrLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBNZXNzYWdlTGlzdE1hbmFnZXIoKTtcclxuXHJcbn0pKG1haW5Db25maWcpO1xyXG4vKiBleHBvcnRlZCB1c2VyRGF0YU1hbmFnZXIgKi9cclxuLyogZ2xvYmFsIGRhdGFTb3VyY2UgKi9cclxuLyogZ2xvYmFsIG1lc3NhZ2VMaXN0TWFuYWdlciAqL1xyXG4vKiBnbG9iYWwgY3JlYXRlTWVzc2FnZU9iamVjdCAqL1xyXG4vKiBnbG9iYWwgZ2V0Q3VycmVudERhdGUgKi9cclxuLyogZ2xvYmFsIGdldEVsZW1lbnQgKi9cclxuLyogZ2xvYmFsIGV2ZW50RW1pdHRlciAqL1xyXG4vKiBnbG9iYWwgbWFpbkNvbmZpZyAqL1xyXG4vKiBnbG9iYWwgbG9uZ1BvbGxSZXNwb25zZVBhcnNlciAqL1xyXG52YXIgdXNlckRhdGFNYW5hZ2VyID0gIChmdW5jdGlvbiBjcmVhdGVVc2VyRGF0YU1hbmFnZXIgKGNvbmZpZywgZXZlbnRFbWl0dGVyLCBsb25nUG9sbFJlc3BvbnNlUGFyc2VyKSB7XHJcblxyXG4gICAgLy8gSU5DTFVERVxyXG5cclxuICAgIC8qIGV4cG9ydGVkIGdldEN1cnJlbnREYXRlICovXHJcbiAgICBmdW5jdGlvbiBnZXRDdXJyZW50RGF0ZSgpIHtcclxuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgdmFyIG1pbnV0ZXMgPSAoZGF0ZS5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5sZW5ndGggPT09IDEpID8gXCIwXCIgKyBkYXRlLmdldE1pbnV0ZXMoKSA6IGRhdGUuZ2V0TWludXRlcygpO1xyXG4gICAgICAgIHJldHVybiBkYXRlXHJcbiAgICAgICAgICAgIC5nZXRIb3VycygpXHJcbiAgICAgICAgICAgIC50b1N0cmluZygpXHJcbiAgICAgICAgICAgIC5jb25jYXQoXCI6XCIsIG1pbnV0ZXMpO1xyXG4gICAgfVxyXG4gICAgLyogZXhwb3J0ZWQgY3JlYXRlTWVzc2FnZU9iamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gY3JlYXRlTWVzc2FnZU9iamVjdCAoXHJcbiAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICBkYXRlLFxyXG4gICAgICAgIHNlbmRlcixcclxuICAgICAgICBpc1JlYWQsXHJcbiAgICAgICAgaWRcclxuICAgICkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNlbmRlcjogc2VuZGVyLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxyXG4gICAgICAgICAgICByZWFkOiBpc1JlYWQsXHJcbiAgICAgICAgICAgIGRhdGU6IGRhdGUsXHJcbiAgICAgICAgICAgIGlkOiBpZFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSU5DTFVERVxyXG5cclxuICAgIC8vIGJhc2ljXHJcbiAgICBmdW5jdGlvbiBnZXRVc2VyRGF0YUJhc2ljICh1c2VySWQpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIGdldENvcnJlc3BvbmRlbmNlIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGF0LmdldFVzZXJDb3JyZXNwb25kZW5jZSh1c2VySWQpLnRoZW4oIGZ1bmN0aW9uIGdldFJlc29sdmUgKCkge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdXBkYXRlTWVzc2FnZUxpc3RCYXNpYyAoZGF0YSkge1xyXG4gICAgICAgIHZhciBuZXdNZXNzYWdlTGlzdDtcclxuICAgICAgICB2YXIgbWVzc2FnZXNPYmplY3QgPSBbXTtcclxuICAgICAgICBpZihkYXRhKSB7XHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGRhdGEpLm1hcChmdW5jdGlvbiBwdXNoRGF0YSAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhW2tleV0uaWQgPSBrZXk7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlc09iamVjdC5wdXNoKGRhdGFba2V5XSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5kaXNwbGF5TWVzc2FnZXMoKTtcclxuICAgICAgICBuZXdNZXNzYWdlTGlzdCA9IG1lc3NhZ2VMaXN0TWFuYWdlci5jcmVhdGVNZXNzYWdlTGlzdChtZXNzYWdlc09iamVjdCk7XHJcbiAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLnVwZGF0ZU1lc3NhZ2VMaXN0KG5ld01lc3NhZ2VMaXN0KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRVc2VyQ29ycmVzcG9uZGVuY2VCYXNpYyAodXNlcklkKSB7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBkYXRhU291cmNlLnVzZXJzQVBJLmdldFVzZXJNZXNzYWdlcyh1c2VySWQpKCkudGhlbihmdW5jdGlvbiB1cGRhdGVNZXNzYWdlc0xpc3QgKGRhdGEpIHtcclxuICAgICAgICAgICAgdGhhdC51cGRhdGVNZXNzYWdlTGlzdChkYXRhKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFVzZXJEYXRhRnJvbUxvbmdQb2xsQ29ubmVjdGlvbih1c2VySWQpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIGdldExvbmdQb2xsQ29ycmVzcG9uZGVuY2UocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICB0aGF0LmdldFVzZXJDb3JyZXNwb25kZW5jZSh1c2VySWQpO1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0VXNlckNvcnJlc3BvbmRlbmNlRnJvbUxvbmdQb2xsQ29ubmVjdGlvbih1c2VySWQpIHtcclxuICAgICAgICB2YXIgZGF0YTtcclxuICAgICAgICBpZihjb25maWcuY3VycmVudE1lc3NhZ2VDb25uZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50TWVzc2FnZUNvbm5lY3Rpb24uYWJvcnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uZmlnLmN1cnJlbnRNZXNzYWdlQ29ubmVjdGlvbiA9IGRhdGFTb3VyY2UudXNlcnNBUEkuZ2V0VXNlck1lc3NhZ2VzKHVzZXJJZCk7XHJcbiAgICAgICAgY29uZmlnLmN1cnJlbnRNZXNzYWdlQ29ubmVjdGlvbi5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiBzZXR1cENvbm5lY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSAzICYmIHRoaXMuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgIGRhdGEgPSBsb25nUG9sbFJlc3BvbnNlUGFyc2VyLnBhcnNlKHRoaXMucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRFbWl0dGVyLmVtaXQoZGF0YS50eXBlLCBkYXRhLm9iamVjdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbmZpZy5jdXJyZW50TWVzc2FnZUNvbm5lY3Rpb24uc2VuZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZU1lc3NhZ2VMaXN0QWZ0ZXJMb25nUG9sbCAoZGF0YSkge1xyXG4gICAgICAgIGlmKGRhdGEpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMoZGF0YSkubWFwKGZ1bmN0aW9uIGFkZFRvTWVzc2FnZUxpc3RMb25nUG9sbCAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhW2tleV0uaWQgPSBrZXk7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIuYWRkTWVzc2FnZVRvTWVzc2FnZUxpc3QoZGF0YVtrZXldKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLmRpc3BsYXlNZXNzYWdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIFVzZXJEYXRhTWFuYWdlciAoKSB7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIGlmKGNvbmZpZy5jaGF0U2V0dGluZ3MudHlwZU9mUmVxdWVzdCA9PT0gXCJsb25nUG9sbFwiKSB7XHJcbiAgICAgICAgICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuZ2V0VXNlckRhdGEgPSBnZXRVc2VyRGF0YUZyb21Mb25nUG9sbENvbm5lY3Rpb24uYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5nZXRVc2VyQ29ycmVzcG9uZGVuY2UgPSBnZXRVc2VyQ29ycmVzcG9uZGVuY2VGcm9tTG9uZ1BvbGxDb25uZWN0aW9uLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUudXBkYXRlTWVzc2FnZUxpc3QgPSB1cGRhdGVNZXNzYWdlTGlzdEFmdGVyTG9uZ1BvbGwuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgZXZlbnRFbWl0dGVyLmFkZFN1YnNjcmliZShcIm1lc3NhZ2VcIiwgZnVuY3Rpb24gc3Vic2NyaWJlTWVzc2FnZSAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdGhhdC51cGRhdGVNZXNzYWdlTGlzdChkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGV2ZW50RW1pdHRlci5hZGRTdWJzY3JpYmUoXCJyZWFkXCIsIGZ1bmN0aW9uIHN1YnNjcmliZVJlYWQgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIubWVzc2FnZUxpc3QuZm9yRWFjaChmdW5jdGlvbiBkaXNwbGF5TWVzc2FnZXMgKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYobWVzc2FnZS5pZCA9PT0gZGF0YS5pZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLnJlYWQgPSBkYXRhLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLmRpc3BsYXlNZXNzYWdlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5nZXRVc2VyRGF0YSA9IGdldFVzZXJEYXRhQmFzaWMuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5nZXRVc2VyQ29ycmVzcG9uZGVuY2UgPSBnZXRVc2VyQ29ycmVzcG9uZGVuY2VCYXNpYy5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZU1lc3NhZ2VMaXN0ID0gdXBkYXRlTWVzc2FnZUxpc3RCYXNpYy5iaW5kKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLnNldHVwID0gZnVuY3Rpb24gc2V0dXAgKCkge1xyXG4gICAgICAgIG1lc3NhZ2VMaXN0TWFuYWdlci5zZXR1cCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLmNsZWFyTWVzc2FnZUxpc3QgPSBmdW5jdGlvbiBjbGVhck1lc3NhZ2VMaXN0ICgpIHtcclxuICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIubWVzc2FnZUxpc3QgPSBbXTtcclxuICAgIH07XHJcblxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5jcmVhdGVOZXdVc2VyUHJvZmlsZVRvRGF0YUJhc2UgPSBmdW5jdGlvbiBjcmVhdGVOZXdVc2VyUHJvZmlsZVRvRGF0YUJhc2UgKHVzZXJJZCwgdXNlck5hbWUpIHtcclxuICAgICAgICBkYXRhU291cmNlLnVzZXJzQVBJLmFkZE5ld1VzZXJUb0RhdGFTb3VyY2UodXNlcklkLCB1c2VyTmFtZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuc2F2ZVNldHRpbmdGaWVsZCA9IGZ1bmN0aW9uIHNldEZpZWxkIChmaWVsZE5hbWUpIHtcclxuICAgICAgICBkYXRhU291cmNlLnVzZXJzQVBJLnNldFNldHRpbmdGaWVsZChcclxuICAgICAgICAgICAgZmllbGROYW1lLFxyXG4gICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQsXHJcbiAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzW2ZpZWxkTmFtZV1cclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZVVzZXJPbmxpbmUgPSBmdW5jdGlvbiB1cGRhdGVVc2VyT25saW5lICh1c2VySWQpIHtcclxuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlO1xyXG4gICAgICAgIGRhdGFTb3VyY2UudXNlcnNBUEkudXBkYXRlTGFzdE9ubGluZSh1c2VySWQsIGRhdGUuZ2V0VGltZSgpKVxyXG4gICAgfTtcclxuXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLnNlbmRNZXNzYWdlID0gZnVuY3Rpb24gc2VuZE1lc3NhZ2UgKCkge1xyXG4gICAgICAgIHZhciBtZXNzYWdlID0gdGhpcy5nZXRNZXNzYWdlRnJvbUlucHV0RWxlbWVudCgpO1xyXG4gICAgICAgIHZhciBkYXRlID0gZ2V0Q3VycmVudERhdGUoKTtcclxuICAgICAgICB2YXIgdXNlck5hbWUgPSBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZSB8fCBjb25maWcuQURNSU5fTkFNRTtcclxuICAgICAgICB2YXIgbWVzc2FnZU9iamVjdCA9IGNyZWF0ZU1lc3NhZ2VPYmplY3QoXHJcbiAgICAgICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgIHVzZXJOYW1lLFxyXG4gICAgICAgICAgICBmYWxzZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgaWYoY29uZmlnLmNoYXRTZXR0aW5ncy50eXBlT2ZSZXF1ZXN0ICE9PSBcImxvbmdQb2xsXCIpIHtcclxuICAgICAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLmFkZE1lc3NhZ2VUb01lc3NhZ2VMaXN0KG1lc3NhZ2VPYmplY3QpO1xyXG4gICAgICAgICAgICBtZXNzYWdlTGlzdE1hbmFnZXIuZGlzcGxheU1lc3NhZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2F2ZU1lc3NhZ2VUb0RhdGFTb3VyY2UobWVzc2FnZU9iamVjdCk7XHJcbiAgICB9O1xyXG5cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuZ2V0TWVzc2FnZUZyb21JbnB1dEVsZW1lbnQgPSBmdW5jdGlvbiBnZXRNZXNzYWdlRnJvbUlucHV0RWxlbWVudCAoKSB7XHJcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBnZXRFbGVtZW50KGNvbmZpZy5DU1NfQ1VSUkVOVF9JTlBVVF9DTEFTUyk7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gZWxlbWVudC52YWx1ZTtcclxuICAgICAgICBlbGVtZW50LnZhbHVlID0gXCJcIjtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9O1xyXG5cclxuICAgIFVzZXJEYXRhTWFuYWdlci5wcm90b3R5cGUuc2V0TWVzc2FnZUFzUmVhZCA9IGZ1bmN0aW9uIHNldE1lc3NhZ2VBc1JlYWQgKCkge1xyXG4gICAgICAgIHZhciBtZXNzYWdlT2JqZWN0cyA9IG1lc3NhZ2VMaXN0TWFuYWdlci5nZXRNZXNzYWdlT2JqZWN0c0Zvck1hcmtBc1JlYWQoKTtcclxuICAgICAgICBpZihtZXNzYWdlT2JqZWN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VPYmplY3RzLmZvckVhY2goZnVuY3Rpb24gc2V0UmVhZCAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgZGF0YVNvdXJjZS51c2Vyc0FQSS51cGRhdGVNZXNzYWdlSXNSZWFkRmllbGQoXHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5maWVsZE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5maWVsZFZhbHVlXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MucmVhZExhc3RNZXNzYWdlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbWVzc2FnZUxpc3RNYW5hZ2VyLmRpc3BsYXlNZXNzYWdlcygpO1xyXG4gICAgfTtcclxuXHJcbiAgICBVc2VyRGF0YU1hbmFnZXIucHJvdG90eXBlLnNhdmVNZXNzYWdlVG9EYXRhU291cmNlID0gZnVuY3Rpb24gc2F2ZU1lc3NhZ2VUb0RhdGFTb3VyY2UgKG1lc3NhZ2VPYmplY3QpIHtcclxuICAgICAgICBpZihtZXNzYWdlT2JqZWN0LnNlbmRlciA9PT0gY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWUpIHtcclxuICAgICAgICAgICAgZGF0YVNvdXJjZS51c2Vyc0FQSS51cGRhdGVTZW5kTmV3TWVzc2FnZUZsYWcoY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkLHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkYXRhU291cmNlLnVzZXJzQVBJLnNlbmRNZXNzYWdlKFxyXG4gICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQsXHJcbiAgICAgICAgICAgIG1lc3NhZ2VPYmplY3RcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBTZXR0aW5ncyA9IFt7dXNlcklkLCBmaWVsZE5hbWUsIGZpZWxkVmFsdWV9LHt9Li4uXVxyXG4gICAgVXNlckRhdGFNYW5hZ2VyLnByb3RvdHlwZS5zYXZlVXNlclNldHRpbmdzVG9EYXRhU291cmNlID0gZnVuY3Rpb24gc2F2ZVVzZXJTZXR0aW5nc1RvRGF0YVNvdXJjZSAoc2V0dGluZ3MpIHtcclxuICAgICAgICBzZXR0aW5ncy5mb3JFYWNoKGZ1bmN0aW9uIHNhdmVTZXR0aW5nIChuZXdGaWVsZFNldHRpbmcpIHtcclxuICAgICAgICAgICAgZGF0YVNvdXJjZS51c2Vyc0FQSS5zZXRTZXR0aW5nRmllbGQoXHJcbiAgICAgICAgICAgICAgICBuZXdGaWVsZFNldHRpbmcuZmllbGROYW1lLFxyXG4gICAgICAgICAgICAgICAgbmV3RmllbGRTZXR0aW5nLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIG5ld0ZpZWxkU2V0dGluZy5maWVsZFZhbHVlXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICByZXR1cm4gbmV3IFVzZXJEYXRhTWFuYWdlcigpO1xyXG5cclxufSkobWFpbkNvbmZpZywgZXZlbnRFbWl0dGVyLCBsb25nUG9sbFJlc3BvbnNlUGFyc2VyKTtcclxuXHJcbi8vIHZpZXdcclxuXHJcbi8qIGV4cG9ydGVkIHZpZXdGYWN0b3J5ICovXHJcbi8qIGdsb2JhbCBnZXRFbGVtZW50ICovXHJcbi8qIGdsb2JhbCBkYXRhU291cmNlICovXHJcbnZhciB2aWV3RmFjdG9yeSA9IChmdW5jdGlvbiBjcmVhdGVWaWV3RmFjdG9yeSAoZGF0YVNvdXJjZSkge1xyXG5cclxuICAgIGZ1bmN0aW9uIFZpZXdGYWN0b3J5ICgpIHt9XHJcblxyXG4gICAgVmlld0ZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZVZpZXcgPSBmdW5jdGlvbiBjcmVhdGVDaGF0VmlldyAoaHRtbFBhdGgsIGNzc1BhdGgsIGNvbnRhaW5lckNsYXNzKSB7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiBjcmVhdGVWaWV3UHJvbWlzZSAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIGlmKGh0bWxQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICBpZihjc3NQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5pbmNsdWRlVmlld0Nzc1RvUGFnZSh0aGF0LmNyZWF0ZUNTU0xpbmsoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzc1BhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3R5bGVzaGVldFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRleHQvY3NzXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidG91Y2gtc29mdC1jaGF0LWNzc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoYXQuaW5jbHVkZVZpZXdIVE1MVG9QYWdlKGh0bWxQYXRoLCBjb250YWluZXJDbGFzcykpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihcImh0bWxQYXRoIGlzIG51bGwuIFBsZWFzZSBhZGQgaHRtbFBhdGhcIikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIFZpZXdGYWN0b3J5LnByb3RvdHlwZS5pbmNsdWRlVmlld0hUTUxUb1BhZ2UgPSBmdW5jdGlvbiBpbmNsdWRlQ2hhdEhUTUxUb1BhZ2UgKGh0bWxQYXRoLCBjb250YWluZXJDbGFzcykge1xyXG4gICAgICAgIHZhciBjb250YWluZXJEaXYgPSAoY29udGFpbmVyQ2xhc3MpID8gZ2V0RWxlbWVudChjb250YWluZXJDbGFzcykgOiBkb2N1bWVudC5ib2R5O1xyXG4gICAgICAgIHJldHVybiBkYXRhU291cmNlLmNvbW1vbkFQSS5nZXRIVE1MKGh0bWxQYXRoKS50aGVuKGZ1bmN0aW9uIHNldEh0bWwgKGh0bWwpIHtcclxuICAgICAgICAgICAgY29udGFpbmVyRGl2LmlubmVySFRNTCA9IGh0bWw7XHJcbiAgICAgICAgfSlcclxuICAgIH07XHJcblxyXG4gICAgVmlld0ZhY3RvcnkucHJvdG90eXBlLmluY2x1ZGVWaWV3Q3NzVG9QYWdlID0gZnVuY3Rpb24gaW5jbHVkZUNoYXRDc3NUb1BhZ2UgKGxpbmspIHtcclxuICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGxpbmspO1xyXG4gICAgfTtcclxuXHJcbiAgICBWaWV3RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlQ1NTTGluayA9IGZ1bmN0aW9uIGNyZWF0ZUNTU0xpbmsoXHJcbiAgICAgICAgZmlsZVBhdGgsXHJcbiAgICAgICAgcmVsLFxyXG4gICAgICAgIHR5cGUsXHJcbiAgICAgICAgaWRcclxuICAgICkge1xyXG4gICAgICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XHJcbiAgICAgICAgaWYgKGlkKSB7XHJcbiAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKFwiaWRcIiwgaWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocmVsKSB7XHJcbiAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKFwicmVsXCIsIHJlbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKFwidHlwZVwiLCB0eXBlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsIGZpbGVQYXRoKTtcclxuICAgICAgICByZXR1cm4gbGluaztcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBWaWV3RmFjdG9yeSgpXHJcblxyXG59KShkYXRhU291cmNlKTtcclxuXHJcbi8vIGNoYXRNYWluXHJcblxyXG4vKiBleHBvcnRlZCBjaGF0Q3VzdG9taXplciAqL1xyXG4vKiBnbG9iYWwgY2hhdEN1c3RvbWl6ZXIgKi9cclxuLyogZ2xvYmFsIGdldEVsZW1lbnQgKi9cclxuLyogZ2xvYmFsIG1haW5Db25maWcgKi9cclxudmFyIGNoYXRDdXN0b21pemVyID0gKGZ1bmN0aW9uIGNyZWF0ZUNoYXRDdXN0b21pemVyIChjb25maWcpIHtcclxuXHJcbiAgICBmdW5jdGlvbiBDaGF0Q3VzdG9taXplcigpIHt9XHJcblxyXG4gICAgQ2hhdEN1c3RvbWl6ZXIucHJvdG90eXBlLnNldHVwT3V0ZXJDaGF0U2V0dGluZ3MgPSBmdW5jdGlvbiBzZXR1cE91dGVyQ2hhdFNldHRpbmdzKCkge1xyXG4gICAgICAgIHRoaXMuYWxsb3dNaW5pbWl6ZSgpO1xyXG4gICAgICAgIHRoaXMuc2V0UG9zaXRpb25PZk1haW5CbG9jaygpO1xyXG4gICAgICAgIHRoaXMuc2V0VGl0bGUoKTtcclxuICAgICAgICB0aGlzLnNldE1haW5Dc3NDbGFzcygpO1xyXG4gICAgICAgIHRoaXMuYWxsb3dEcmFnTkRyb3AoKTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdEN1c3RvbWl6ZXIucHJvdG90eXBlLmFsbG93RHJhZ05Ecm9wID0gZnVuY3Rpb24gYWxsb3dEcmFnTkRyb3AoKSB7XHJcbiAgICAgICAgdmFyIGNsaWNrQmxvY2sgPSBnZXRFbGVtZW50KGNvbmZpZy5ET00uVElUTEVfQkxPQ0tfQ0xBU1MpO1xyXG4gICAgICAgIHZhciBkcmFnQmxvY2sgPSBnZXRFbGVtZW50KGNvbmZpZy5ET00uTUFJTl9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTKTtcclxuICAgICAgICBpZiAoY29uZmlnLmNoYXRTZXR0aW5ncy5hbGxvd0RyYWcgPT09IFwiZmFsc2VcIikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNsaWNrQmxvY2suYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiBkcmFnQW5kRHJvcChlKSB7XHJcbiAgICAgICAgICAgIHZhciBjb3JkcztcclxuICAgICAgICAgICAgdmFyIHNoaWZ0WDtcclxuICAgICAgICAgICAgdmFyIHNoaWZ0WTtcclxuICAgICAgICAgICAgdmFyIG1vdmVPYmo7XHJcbiAgICAgICAgICAgIHZhciBzZXROdWxsO1xyXG4gICAgICAgICAgICB2YXIgZW5kRHJhZztcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldENvb3JkcyhlbGVtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wOiBib3gudG9wICsgd2luZG93LnBhZ2VZT2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IGJveC5sZWZ0ICsgd2luZG93LnBhZ2VYT2Zmc2V0XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb3JkcyA9IGdldENvb3JkcyhkcmFnQmxvY2spO1xyXG4gICAgICAgICAgICBzaGlmdFggPSBlLnBhZ2VYIC0gY29yZHMubGVmdDtcclxuICAgICAgICAgICAgc2hpZnRZID0gZS5wYWdlWSAtIGNvcmRzLnRvcDtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIG1vdmVBdChlbGVtKSB7XHJcbiAgICAgICAgICAgICAgICBkcmFnQmxvY2suc3R5bGUubGVmdCA9IGVsZW0ucGFnZVggLSBzaGlmdFggKyBcInB4XCI7XHJcbiAgICAgICAgICAgICAgICBkcmFnQmxvY2suc3R5bGUudG9wID0gZWxlbS5wYWdlWSAtIHNoaWZ0WSArIFwicHhcIjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbW92ZU9iaiA9IGZ1bmN0aW9uIG1vdmVPYmpEcmFnQW5kRHJvcChlbGVtKSB7XHJcbiAgICAgICAgICAgICAgICBtb3ZlQXQoZWxlbSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBzZXROdWxsID0gZnVuY3Rpb24gc2V0TnVsbERyYWdBbmREcm9wICgpIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIixtb3ZlT2JqICk7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLHNldE51bGwgKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGVuZERyYWcgPSBmdW5jdGlvbiBlbmREcmFnQW5kRHJvcCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIG1vdmVBdChlKTtcclxuICAgICAgICAgICAgZHJhZ0Jsb2NrLnN0eWxlLnpJbmRleCA9IDEwMDA7XHJcblxyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIG1vdmVPYmopO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBzZXROdWxsKTtcclxuICAgICAgICAgICAgZHJhZ0Jsb2NrLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgZW5kRHJhZyk7XHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBDaGF0Q3VzdG9taXplci5wcm90b3R5cGUuc2V0UG9zaXRpb25PZk1haW5CbG9jayA9IGZ1bmN0aW9uIHNldFBvc2l0aW9uT2ZNYWluQmxvY2soKSB7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5jaGF0U2V0dGluZ3MucG9zaXRpb24gPT09IFwicmlnaHRcIikge1xyXG4gICAgICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uTUFJTl9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTKS5jbGFzc0xpc3QuYWRkKFxyXG4gICAgICAgICAgICAgICAgY29uZmlnLkNIQVRfUE9TSVRJT05fUklHSFRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uTUFJTl9TVFlMRV9DSEFUX0JMT0NLX0NMQVNTKS5jbGFzc0xpc3QuYWRkKFxyXG4gICAgICAgICAgICAgICAgY29uZmlnLkNIQVRfUE9TSVRJT05fTEVGVFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgQ2hhdEN1c3RvbWl6ZXIucHJvdG90eXBlLnNldFRpdGxlID0gZnVuY3Rpb24gc2V0VGl0bGUoKSB7XHJcbiAgICAgICAgaWYoY29uZmlnLmNoYXRTZXR0aW5ncy5jaGF0VGl0bGUubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgICAgICBjb25maWcuY2hhdFNldHRpbmdzLmNoYXRUaXRsZSA9IGNvbmZpZy5ERUZBVUxUX0NIQVRfVElUTEU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5USVRMRV9CTE9DS19DTEFTUykuaW5uZXJIVE1MID0gY29uZmlnLmNoYXRTZXR0aW5ncy5jaGF0VGl0bGU7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDdXN0b21pemVyLnByb3RvdHlwZS5hbGxvd01pbmltaXplID0gZnVuY3Rpb24gYWxsb3dNaW5pbWl6ZSgpIHtcclxuICAgICAgICBpZiAoY29uZmlnLmNoYXRTZXR0aW5ncy5hbGxvd01pbmltaXplID09PSBcImZhbHNlXCIpIHtcclxuICAgICAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLkNIQU5HRV9TVFlMRV9CVVRUT05fTUFYX1NJWkUpLmNsYXNzTGlzdC5hZGQoXHJcbiAgICAgICAgICAgICAgICBjb25maWcuSU5WSVNJQkxFX0NMQVNTXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBDaGF0Q3VzdG9taXplci5wcm90b3R5cGUuc2V0TWFpbkNzc0NsYXNzID0gZnVuY3Rpb24gc2V0TWFpbkNzc0NsYXNzKCkge1xyXG4gICAgICAgIGlmKGNvbmZpZy5jaGF0U2V0dGluZ3Mub3V0ZXJDc3NDbGFzcy5sZW5ndGggPCAxKSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jaGF0U2V0dGluZ3Mub3V0ZXJDc3NDbGFzcyA9IGNvbmZpZy5ERUZBVUxUX0NTU19DTEFTU19GT1JfQ0hBVDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLk1BSU5fU1RZTEVfQ0hBVF9CTE9DS19DTEFTUykucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKFxyXG4gICAgICAgICAgICBjb25maWcuY2hhdFNldHRpbmdzLm91dGVyQ3NzQ2xhc3NcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IENoYXRDdXN0b21pemVyKCk7XHJcbn0pKG1haW5Db25maWcpO1xyXG4vKiBnbG9iYWwgdXNlckRhdGFNYW5hZ2VyICovXHJcbi8qIGdsb2JhbCBjaGF0Q3VzdG9taXplciAqL1xyXG4vKiBnbG9iYWwgZ2V0SGFzaCAqL1xyXG4vKiBnbG9iYWwgZ2V0RWxlbWVudCAqL1xyXG4vKiBnbG9iYWwgbWFpbkNvbmZpZyAqL1xyXG4vKiBnbG9iYWwgdmlld0ZhY3RvcnkgKi9cclxuLyogZ2xvYmFsIGV2ZW50RW1pdHRlciAqL1xyXG52YXIgY2hhdENvbnRyb2xsZXIgPSAoZnVuY3Rpb24gY3JlYXRlQ2hhdENvbnRyb2xsZXIgKGNvbmZpZywgaW5zdHJ1Y3Rpb25QZXJmb3JtZXIsIHVzZXJEYXRhTWFuYWdlcikge1xyXG5cclxuICAgIHZhciBkYXRhRm9yR2V0VXNlck5hbWVDYWxsYmFjayA9IFtcclxuICAgICAgICBcImF1dGhvcml6YXRpb25cIixcclxuICAgICAgICBcImVudGVyIHlvdXIgbmFtZSwgcGxlYXNlXCIsXHJcbiAgICAgICAgXCJcIlxyXG4gICAgXTtcclxuXHJcbiAgICB2YXIgY29uZGl0aW9uTWFuYWdlciA9IChmdW5jdGlvbiAoY29uZmlnKSB7XHJcblxyXG4gICAgICAgIHZhciBsb2NhbFN0b3JhZ2VNYW5hZ2VyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBcclxuICAgICAgICAgICAgZnVuY3Rpb24gc2F2ZURhdGEgKGRhdGEsIHN0b3JhZ2VOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VyaWFsRGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc3RvcmFnZU5hbWUsIHNlcmlhbERhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldERhdGEgKHN0b3JhZ2VOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VyaWFsRGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHN0b3JhZ2VOYW1lKTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChzZXJpYWxEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2Uoc2VyaWFsRGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgd3JpdGU6IHNhdmVEYXRhLFxyXG4gICAgICAgICAgICAgICAgZ2V0OiBnZXREYXRhXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB9KSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDdXJyZW50Q29uZGl0aW9uVG9Mb2NhbFN0b3JhZ2UoKSB7XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZU1hbmFnZXIud3JpdGUoXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNNaW5pbWl6ZTogY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MuaXNNaW5pbWl6ZSxcclxuICAgICAgICAgICAgICAgICAgICB1c2VyTmFtZTogY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlck5hbWVcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBjb25maWcuTE9DQUxfU1RPUkFHRV9OQU1FXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRDb25kaXRpb25Gcm9tTG9jYWxTdG9yYWdlKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHZhciBjb25kaXRpb24gPSBsb2NhbFN0b3JhZ2VNYW5hZ2VyLmdldChjb25maWcuTE9DQUxfU1RPUkFHRV9OQU1FKTtcclxuICAgICAgICAgICAgaWYgKGNvbmRpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkID0gY29uZGl0aW9uLnVzZXJJZDtcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lID0gY29uZGl0aW9uLnVzZXJOYW1lO1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MuaXNNaW5pbWl6ZSA9IGNvbmRpdGlvbi5pc01pbmltaXplO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjYWxsYmFjayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhjb25kaXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjb25kaXRpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEFQSSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHNhdmVDb25kaXRpb246IHNhdmVDdXJyZW50Q29uZGl0aW9uVG9Mb2NhbFN0b3JhZ2UsXHJcbiAgICAgICAgICAgICAgICBzZXR1cENvbmRpdGlvbjogZ2V0Q3VycmVudENvbmRpdGlvbkZyb21Mb2NhbFN0b3JhZ2VcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBnZXRBUEkoKTtcclxuXHJcbiAgICB9KShtYWluQ29uZmlnKTtcclxuXHJcbiAgICAvKiBleHBvcnRlZCBnZXRIYXNoICovXHJcbiAgICBmdW5jdGlvbiBnZXRIYXNoKHN0cikge1xyXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICByZXR1cm4gc3RyICsgZGF0ZS5nZXRUaW1lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gQ2hhdENvbnRyb2xsZXIoKSB7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVOZXdVc2VyID0gdXNlckRhdGFNYW5hZ2VyLmNyZWF0ZU5ld1VzZXJQcm9maWxlVG9EYXRhQmFzZVxyXG4gICAgfVxyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5zdGFydEFwcCA9IGZ1bmN0aW9uIHN0YXJ0QXBwQmFzaWMgKCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICAvLyBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShjb25maWcuTE9DQUxfU1RPUkFHRV9OQU1FKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXR1cENoYXRWaWV3KCkudGhlbihcclxuICAgICAgICAgICAgZnVuY3Rpb24gc3RhcnRBdXRob3JpemF0aW9uQW5kQmFzaWNMaXN0ZW5lcnMgKCkge1xyXG4gICAgICAgICAgICAgICAgdGhhdC5hdXRob3JpemF0aW9uKGNvbmZpZy5jaGF0U2V0dGluZ3MucmVxdWlyZU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgdGhhdC5zZXR1cENoYXRCYXNpY0xpc3RlbmVycygpO1xyXG4gICAgICAgICAgICB9KS50aGVuKFxyXG4gICAgICAgICAgICBmdW5jdGlvbiBhZnRlclNldHVwVmlld0NvbmZpZ3VyYXRpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdXNlckRhdGFNYW5hZ2VyLmdldFVzZXJEYXRhKFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJJZFxyXG4gICAgICAgICAgICAgICAgKS50aGVuKFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFmdGVyVXNlckRhdGFTZXR1cCAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0dXBDaGF0U3R5bGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXR1cENoYXRTZW5kTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXRDdXN0b21pemVyLnNldHVwT3V0ZXJDaGF0U2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb25QZXJmb3JtZXIuc3RhcnRBcHAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWcuY2hhdFNldHRpbmdzLnR5cGVPZlJlcXVlc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBhdXRob3JpemF0aW9uIGJsb2NrIC8vXHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb24gPSBmdW5jdGlvbiBhdXRob3JpemF0aW9uICh1c2VyTmFtZUlzUmVxdWlyZSkge1xyXG4gICAgICAgIHVzZXJEYXRhTWFuYWdlci5zZXR1cCgpO1xyXG4gICAgICAgIGlmKCFjb25kaXRpb25NYW5hZ2VyLnNldHVwQ29uZGl0aW9uKCkpIHtcclxuICAgICAgICAgICAgY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkID0gZ2V0SGFzaChcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5ERUZBVUxUX1VTRVJfTkFNRVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZih1c2VyTmFtZUlzUmVxdWlyZSA9PT0gXCJmYWxzZVwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZSA9IGNvbmZpZy5ERUZBVUxUX1VTRVJfTkFNRTtcclxuICAgICAgICAgICAgICAgIGNvbmRpdGlvbk1hbmFnZXIuc2F2ZUNvbmRpdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdXNlckRhdGFNYW5hZ2VyLmNyZWF0ZU5ld1VzZXJQcm9maWxlVG9EYXRhQmFzZShjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQsIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dXBJbnRlcnZhbEZ1bmN0aW9ucygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb25QZXJmb3JtZXIuZXhlY3V0ZShcclxuICAgICAgICAgICAgICAgICAgICBcImFza1F1ZXN0aW9uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YUZvckdldFVzZXJOYW1lQ2FsbGJhY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRVc2VyTmFtZUZyb21JbnB1dCxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25kaXRpb25NYW5hZ2VyLnNldHVwQ29uZGl0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dXBJbnRlcnZhbEZ1bmN0aW9ucygpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnRvZ2dsZUF1dGhvcml6YXRpb25NZW51VmlzaWJsZSA9IGZ1bmN0aW9uIHRvZ2dsZUF1dGhvcml6YXRpb25NZW51VmlzaWJsZSAoKSB7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLkFVVEhPUklaQVRJT05fTUVOVV9DTEFTUykuY2xhc3NMaXN0LnRvZ2dsZShcclxuICAgICAgICAgICAgY29uZmlnLklOVklTSUJMRV9DTEFTU1xyXG4gICAgICAgIClcclxuICAgIH07XHJcblxyXG5cclxuICAgIC8vINCV0YHQu9C4INGC0YDQtdCx0YPQtdGC0YHRjyDQstCy0LXRgdGC0Lgg0LjQvNGPLCDQv9C+0LvRg9GH0LDQtdC8INC10LPQviDQuCDQt9Cw0L3QvtGB0LjQvCDRjtC30LXRgNCwINCyINCx0LRcclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5nZXRVc2VyTmFtZUZyb21JbnB1dCA9IGZ1bmN0aW9uIGdldFVzZXJOYW1lRnJvbUlucHV0ICgpIHtcclxuICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZSA9IGdldEVsZW1lbnQoXHJcbiAgICAgICAgICAgIGNvbmZpZy5ET00uVVNFUl9OQU1FX0lOUFVUX0NMQVNTXHJcbiAgICAgICAgKS52YWx1ZTtcclxuICAgICAgICBjb25maWcuY2hhdFNldHRpbmdzLmlzTWluaW1pemUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNyZWF0ZU5ld1VzZXIoY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MudXNlcklkLCBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZSk7XHJcbiAgICAgICAgdGhpcy5zZXR1cEludGVydmFsRnVuY3Rpb25zKCk7XHJcbiAgICAgICAgY29uZGl0aW9uTWFuYWdlci5zYXZlQ29uZGl0aW9uKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFNldHVwIENoYXQgLy9cclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuc2V0dXBDaGF0U2VuZExpc3RlbmVycyA9IGZ1bmN0aW9uIHNldHVwQ2hhdFNlbmRMaXN0ZW5lcnMgKCkge1xyXG4gICAgICAgIC8vIHNldHVwIGNoYXQgbGlzdGVuZXJzXHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFTkRfTUVTU0FHRV9GVUxMX1NJWkVfQlVUVE9OKS5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAnY2xpY2snLFxyXG4gICAgICAgICAgICB1c2VyRGF0YU1hbmFnZXIuc2VuZE1lc3NhZ2UuYmluZCh1c2VyRGF0YU1hbmFnZXIsXHJcbiAgICAgICAgICAgICAgICBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VyTmFtZVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFTkRfTUVTU0FHRV9NSU5fU0laRV9CVVRUT04pLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICdjbGljaycsXHJcbiAgICAgICAgICAgIHVzZXJEYXRhTWFuYWdlci5zZW5kTWVzc2FnZS5iaW5kKHVzZXJEYXRhTWFuYWdlcixcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLnVzZXJOYW1lXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdXNlckRhdGFNYW5hZ2VyLnNldE1lc3NhZ2VBc1JlYWQuYmluZCh1c2VyRGF0YU1hbmFnZXIpKTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwQ2hhdEJhc2ljTGlzdGVuZXJzID0gZnVuY3Rpb24gc2V0dXBDaGF0QmFzaWNMaXN0ZW5lcnMgKCkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICBnZXRFbGVtZW50KGNvbmZpZy5ET00uU0VUX01BWF9TVFlMRV9CVVRUT04pLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgICAgICAgICdjbGljaycsXHJcbiAgICAgICAgICAgIHRoYXQubWluTWF4U3R5bGVUb2dnbGUuYmluZCh0aGF0KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLlNFVF9NSU5fU1RZTEVfQlVUVE9OKS5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgICAgICAnY2xpY2snLFxyXG4gICAgICAgICAgICB0aGF0Lm1pbk1heFN0eWxlVG9nZ2xlLmJpbmQodGhhdClcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwQ2hhdFZpZXcgPSBmdW5jdGlvbiBzZXR1cENoYXRWaWV3ICgpIHtcclxuICAgICAgICByZXR1cm4gdmlld0ZhY3RvcnkuY3JlYXRlVmlldyhjb25maWcuSFRNTF9GSUxFX1BBVEgsIGNvbmZpZy5DU1NfRklMRV9QQVRILCBudWxsKTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwQ2hhdFN0eWxlID0gZnVuY3Rpb24gc2V0dXBDaGF0U3R5bGUoKSB7XHJcbiAgICAgICAgaWYgKCFjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5pc01pbmltaXplKSB7XHJcbiAgICAgICAgICAgIGdldEVsZW1lbnQoY29uZmlnLkRPTS5NQUlOX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgICAgICBjb25maWcuSU5WSVNJQkxFX0NMQVNTXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLk1JTklNSVpFX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgICAgICBjb25maWcuSU5WSVNJQkxFX0NMQVNTXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hhbmdlSW5wdXRBbmRTZW5kQnV0dG9uQ2xhc3MoKTtcclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLm1pbk1heFN0eWxlVG9nZ2xlID0gZnVuY3Rpb24gbWluTWF4U3R5bGVUb2dnbGUoKSB7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLk1BSU5fU1RZTEVfQ0hBVF9CTE9DS19DTEFTUykuY2xhc3NMaXN0LnRvZ2dsZShcclxuICAgICAgICAgICAgY29uZmlnLklOVklTSUJMRV9DTEFTU1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgZ2V0RWxlbWVudChjb25maWcuRE9NLk1JTklNSVpFX1NUWUxFX0NIQVRfQkxPQ0tfQ0xBU1MpLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgICAgIGNvbmZpZy5JTlZJU0lCTEVfQ0xBU1NcclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbmZpZy5jdXJyZW50VXNlclNldHRpbmdzLmlzTWluaW1pemUgPSBjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy5pc01pbmltaXplID09PSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNoYW5nZUlucHV0QW5kU2VuZEJ1dHRvbkNsYXNzKCk7XHJcbiAgICAgICAgY29uZGl0aW9uTWFuYWdlci5zYXZlQ29uZGl0aW9uKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIENoYXRDb250cm9sbGVyLnByb3RvdHlwZS5hY3Rpdml0eU5vdGlmeSA9IGZ1bmN0aW9uIGFjdGl2aXR5Tm90aWZ5ICgpIHtcclxuICAgICAgICB1c2VyRGF0YU1hbmFnZXIudXBkYXRlVXNlck9ubGluZShjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQpO1xyXG4gICAgfTtcclxuXHJcbiAgICBDaGF0Q29udHJvbGxlci5wcm90b3R5cGUuY2hhbmdlSW5wdXRBbmRTZW5kQnV0dG9uQ2xhc3MgPSBmdW5jdGlvbiBjaGFuZ2VJbnB1dEFuZFNlbmRCdXR0b25DbGFzcyAoKSB7XHJcbiAgICAgICAgaWYoY29uZmlnLmN1cnJlbnRVc2VyU2V0dGluZ3MuaXNNaW5pbWl6ZSkge1xyXG4gICAgICAgICAgICBjb25maWcuQ1NTX0NVUlJFTlRfSU5QVVRfQ0xBU1MgPSBjb25maWcuRE9NLkNTU19NSU5fU0laRV9JTlBVVF9NRVNTQUdFX0JMT0NLX0NMQVNTXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uZmlnLkNTU19DVVJSRU5UX0lOUFVUX0NMQVNTID0gY29uZmlnLkRPTS5DU1NfTUFYX1NJWkVfSU5QVVRfTUVTU0FHRV9CTE9DS19DTEFTU1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgQ2hhdENvbnRyb2xsZXIucHJvdG90eXBlLnNldHVwSW50ZXJ2YWxGdW5jdGlvbnMgPSBmdW5jdGlvbiBzZXR1cEludGVydmFsRnVuY3Rpb25zICgpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgc2V0SW50ZXJ2YWwoIGZ1bmN0aW9uIGludGVydmFsRnVuY3Rpb25zICgpIHtcclxuICAgICAgICAgICAgaWYoY29uZmlnLmNoYXRTZXR0aW5ncy50eXBlT2ZSZXF1ZXN0ICE9PSBcImxvbmdQb2xsXCIpIHtcclxuICAgICAgICAgICAgICAgIHVzZXJEYXRhTWFuYWdlci5nZXRVc2VyRGF0YShjb25maWcuY3VycmVudFVzZXJTZXR0aW5ncy51c2VySWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoYXQuYWN0aXZpdHlOb3RpZnkoKTtcclxuICAgICAgICB9LCBjb25maWcuVVBEQVRFX1VTRVJfREFUQV9USU1FKVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IENoYXRDb250cm9sbGVyKCk7XHJcblxyXG59KShtYWluQ29uZmlnLCBpbnN0cnVjdGlvblBlcmZvcm1lciwgdXNlckRhdGFNYW5hZ2VyKTtcclxuXHJcblxyXG5jaGF0Q29udHJvbGxlci5zdGFydEFwcCgpOyJdfQ==
